<!DOCTYPE html>
<html>
  <head>
    <title>ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編） – きままにNLP – A Technical Blog</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="はじめに

「ゼロから作るディープラーニング」は深層学習を学ぶ入門書として非常に人気があり，様々な場所で用いられています．

" />
    <meta property="og:description" content="はじめに

「ゼロから作るディープラーニング」は深層学習を学ぶ入門書として非常に人気があり，様々な場所で用いられています．

" />
    
    <meta name="author" content="きままにNLP" />

    
    <meta property="og:title" content="ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）" />
    <meta property="twitter:title" content="ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="きままにNLP - A Technical Blog" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->

    <!-- Favicon head tag -->
    <link rel="icon" href="https://pbs.twimg.com/profile_images/1112635060480442368/Ou7bjYFs_400x400.png" type="image/x-icon">

    <!-- Begin Jekyll SEO tag v2.6.0 -->
<title>ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編） | きままにNLP</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="「ゼロから作るDeep Learning」とともに深層学習フレームワークを学ぶプロジェクト第一弾として，Kerasの環境整備とパーセプトロンの実装を行います．" />
<meta property="og:description" content="「ゼロから作るDeep Learning」とともに深層学習フレームワークを学ぶプロジェクト第一弾として，Kerasの環境整備とパーセプトロンの実装を行います．" />
<link rel="canonical" href="http://localhost:4000/DL-Intro-1/" />
<meta property="og:url" content="http://localhost:4000/DL-Intro-1/" />
<meta property="og:site_name" content="きままにNLP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-13T00:00:00+09:00" />
<script type="application/ld+json">
{"description":"「ゼロから作るDeep Learning」とともに深層学習フレームワークを学ぶプロジェクト第一弾として，Kerasの環境整備とパーセプトロンの実装を行います．","@type":"BlogPosting","url":"http://localhost:4000/DL-Intro-1/","headline":"ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）","dateModified":"2019-04-13T00:00:00+09:00","datePublished":"2019-04-13T00:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/DL-Intro-1/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Google Adsense-->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-1838422896597988",
        enable_page_level_ads: true
      });
    </script>
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://pbs.twimg.com/profile_images/1112635060480442368/Ou7bjYFs_400x400.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">きままにNLP</a></h1>
            <p class="site-description">A Technical Blog</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <style type="text/css">
  #toc ul, ol{
  color: #1e366a;
  padding: 0.1em 0 0.1em 1.0em;
  font-size: 90%
  }
  
  #toc ul li, ol li{
    line-height: 1.5;
    padding: 0.1em 0;
  }

  #box div{
   border-top: solid #1e366a 1px;/*上のボーダー*/
   border-bottom: solid #1e366a 1px; /* 下側の1本線 */
   padding: 0.1em 0;
  }
</style>

<article class="post">
  <h1>ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）</h1>
  <div id="box">
    <div id="toc">
      <ul class="date">
  <li><a href="#はじめに">はじめに</a></li>
  <li><a href="#1-kerasのインストール">1. Kerasのインストール</a></li>
  <li><a href="#2-プロジェクトの作成">2. プロジェクトの作成</a></li>
  <li><a href="#3-モデルの作成--テスト">3. モデルの作成 &amp; テスト</a>
    <ul>
      <li><a href="#31-sequential-モデル">3.1 Sequential モデル</a>
        <ul>
          <li><a href="#1-レイヤー--numpyを読み込む">1. レイヤー + NumPyを読み込む</a></li>
          <li><a href="#2-modelにsepuentialモデルを定義する">2. modelにSepuentialモデルを定義する</a></li>
          <li><a href="#3-modelにdense層全結合層を追加する">3. modelにDense層（全結合層）を追加する</a></li>
          <li><a href="#4-modelに重みを与える">4. modelに重みを与える</a></li>
          <li><a href="#5-テストする">5. テストする</a></li>
        </ul>
      </li>
      <li><a href="#32-fucntional-api">3.2 Fucntional API</a>
        <ul>
          <li><a href="#1-レイヤー--numpyを読み込む-1">1. レイヤー + NumPyを読み込む</a></li>
          <li><a href="#2-各種レイヤーを定義する">2. 各種レイヤーを定義する</a></li>
          <li><a href="#3-モデルを定義する">3. モデルを定義する</a></li>
          <li><a href="#4-重みを与える--テストする">4. 重みを与える &amp; テストする</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#まとめ">まとめ</a></li>
  <li><a href="#発展課題">発展課題</a></li>
  <li><a href="#ソースコード">ソースコード</a></li>
</ul>
    </div>
  </div> 
  <div class="entry">
    <h1 id="はじめに">はじめに</h1>
<hr />
<p>「ゼロから作るディープラーニング」は深層学習を学ぶ入門書として非常に人気があり，様々な場所で用いられています．</p>

<p>しかしながら，「フレームワークを用いないで深層学習の基礎を学ぶ」という本の目的により，深層学習フレームワークに関する内容は触れられていません．</p>

<p>したがって，読者の中には実際のフレームワークを用いた機械学習の勉強へと繋げる機会や気力を失ってしまった人も少なからずいると思います．</p>

<p>このプロジェクトでは，「ゼロから作るDeep Learning」（以下，ゼロから〜）を学習しつつ，深層学習フレームワークの一つである，Kerasについて学んでいきます．<br />
これにより，深層学習の基礎を理解しつつ，フレームワークを活用した実装方法について学ぶことができます！</p>

<p>それでは，まずはKerasのインストールから始めていきましょう．</p>

<h1 id="1-kerasのインストール">1. Kerasのインストール</h1>
<hr />
<p>(<strong>注意</strong>) 本プロジェクトでは，すでにPythonやNumPy等のインストールは終えているものとしてスタートします．<br />
環境整備がお済みでない方は，先にゼロから〜の一章を参考に済ませてください．</p>

<p>・コマンドライン上で，以下のコマンドを入力してKerasをインストールします．</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install keras
</code></pre></div></div>
<p><em>参考: <a href="https://keras.io/ja/">https://keras.io/ja/</a></em></p>

<h1 id="2-プロジェクトの作成">2. プロジェクトの作成</h1>
<hr />
<p>お好きな環境でゼロから〜二章用のプロジェクトを作成してください．</p>

<p>ただし，ここでは，<code class="highlighter-rouge">sequential.py</code>と<code class="highlighter-rouge">functional.py</code>の二つのファイルを作成することとします．</p>

<h1 id="3-モデルの作成--テスト">3. モデルの作成 &amp; テスト</h1>
<hr />
<ul>
  <li>KerasにはSepuentialモデルとFunctional APIの2種類のモデルの定義方法があります．
    <ul>
      <li>Sepuentialモデル：様々な層を積み木のように積み重ねていくイメージ．線形スタック．</li>
      <li>Functionalモデル：層をインスタンスとして扱う．複雑なモデルを定義するときに便利．</li>
    </ul>
  </li>
</ul>

<p>それぞれのモデルの定義方法の違いを以下で見ていきましょう．</p>

<h2 id="31-sequential-モデル">3.1 Sequential モデル</h2>
<hr />
<ul>
  <li>SequentialモデルでANDゲートのパーセプトロンを実装します．<br />
<code class="highlighter-rouge">sequential.py</code>に以下のソースを順に書いていきましょう．</li>
</ul>

<h3 id="1-レイヤー--numpyを読み込む">1. レイヤー + NumPyを読み込む</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras.models import Sequential
from keras.layers import Dense

import numpy as np
</code></pre></div></div>

<h3 id="2-modelにsepuentialモデルを定義する">2. <code class="highlighter-rouge">model</code>にSepuentialモデルを定義する</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">model</span> <span class="p">=</span> <span class="n">Sequential</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="3-modelにdense層全結合層を追加する">3. <code class="highlighter-rouge">model</code>にDense層（全結合層）を追加する</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.add(Dense(input_dim=2, units=1))
</code></pre></div></div>

<ul>
  <li>全結合層という用語はゼロから〜の二章には登場していませんが，ここでは単純パーセプトロンと同じと思ってください．<br />
参考程度に，<code class="highlighter-rouge">input_dim=2, units=1</code>のときのDense層の様子を概念図にしたものを以下に示します．</li>
</ul>

<p><img src="../resources/2019-04-13/example_dense.png" alt="Dense層の様子の概念図" /></p>

<h3 id="4-modelに重みを与える">4. <code class="highlighter-rouge">model</code>に重みを与える</h3>
<ul>
  <li>
    <p>ゼロから〜の二章では予め重みとバイアスが与えられているので，この実装でも与えます．</p>
  </li>
  <li>
    <p>重みとバイアスの初期設定には，<code class="highlighter-rouge">model.set_weights()</code>を使用します．<br />
引数は重みの入ったリストです．</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.set_weights([np.array([[0.5], [0.5]]), np.array([-0.7])])
</code></pre></div>    </div>
    <p><em>参照: ゼロから〜のP27</em></p>
  </li>
</ul>

<h3 id="5-テストする">5. テストする</h3>
<ul>
  <li>モデルのテストは<code class="highlighter-rouge">predict</code>メソッドで行えます．<br />
<code class="highlighter-rouge">predict</code>の返り値は，入力データの予測結果のリストになっています．</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>X = np.array([[0,0], [0,1], [1,0], [1,1]])
Y = np.array([[0], [0], [0], [1]])

Y_ = model.predict(X)

print(Y_)
</code></pre></div></div>

<ul>
  <li>この結果は以下のようになるはずです．<br />
Output:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[-0.7       ]
 [-0.19999999]
 [-0.19999999]
 [ 0.3       ]]
</code></pre></div>    </div>
  </li>
  <li>これではわかりにくいので，マイナスのものは<code class="highlighter-rouge">False</code>で，プラスのものは<code class="highlighter-rouge">True</code>に置き換えます．
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Y_[Y_ &lt;= 0] = False
Y_[Y_ &gt; 0] = True
print(Y_)
print(f'Results: {Y == Y_}')
</code></pre></div>    </div>
  </li>
  <li>以下のような結果が得られたと思います．<br />
見事ANDゲートが実装できていることが確認できますね．<br />
Output:
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[0.]
 [0.]
 [0.]
 [1.]]
Results: [[ True]
 [ True]
 [ True]
 [ True]]
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="32-fucntional-api">3.2 Fucntional API</h2>
<hr />
<ul>
  <li>Functional APIでANDゲートのパーセプトロンを実装します．<br />
<code class="highlighter-rouge">functional.py</code>に以下のソースを順に書いていきましょう．</li>
</ul>

<h3 id="1-レイヤー--numpyを読み込む-1">1. レイヤー + NumPyを読み込む</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from keras import Model
from keras.layers import Input, Dense

import numpy as np
</code></pre></div></div>

<h3 id="2-各種レイヤーを定義する">2. 各種レイヤーを定義する</h3>
<p>Functional APIでは，入力層を追加で定義する必要があります．</p>

<p>Dense部分のイメージとしては，Denseレイヤーのインスタンスを生成し，その入力として，テンソル：_inputを与えるという感じです．出力のテンソルは_outputとなります．</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_input = Input(shape=(2, ))
_output = Dense(units=1)(_input)
</code></pre></div></div>

<h3 id="3-モデルを定義する">3. モデルを定義する</h3>
<p>以下のように，Functional APIでは，モデルを定義する際に入力と出力のテンソルを別々に保持しておく必要があります！</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">model</span> <span class="p">=</span> <span class="k">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">=</span><span class="n">_input</span><span class="p">,</span> <span class="n">outputs</span><span class="p">=</span><span class="n">_output</span><span class="p">)</span>
</code></pre></div></div>
<p><em>参考: <a href="https://keras.io/ja/getting-started/functional-api-guide/">https://keras.io/ja/getting-started/functional-api-guide/</a></em></p>

<h3 id="4-重みを与える--テストする">4. 重みを与える &amp; テストする</h3>
<p>Sequentialモデルと同じなので割愛します．<br />
結果が同一になることを確認するとよいです．</p>

<h1 id="まとめ">まとめ</h1>
<hr />
<p>今回は，パーセプトロンによるANDゲートの実装をKerasにより行いました．</p>

<p>Kerasを用いることで，より「簡単に&amp;抽象的に」パーセプトロンを実装することが確認できたと思います．</p>

<p>次回は，3層ニューラルネットワークの実装を行います．</p>

<h1 id="発展課題">発展課題</h1>
<hr />
<p>NAND, ORゲートも実装してみると良いでしょう．<br />
重みとバイアスは，ゼロから〜のP27,28を参照してください．</p>

<h1 id="ソースコード">ソースコード</h1>
<hr />
<p>ソースコードは，<strong>GitHub</strong>で5月中に入手できるようにする予定です．</p>

  </div>

  <div class="date">
    Written on April 13, 2019
  </div>

  
  
</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:gucci.research@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/gucci-j"><i class="svg-icon github"></i></a>



<a href="/feed.xml"><i class="svg-icon rss"></i></a>
<a href="https://www.twitter.com/_gucciiiii"><i class="svg-icon twitter"></i></a>


<br />
          <a href="/privacy">Privacy Policy</a>
        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-137498199-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/DL-Intro-1/',
		  'title': 'ゼロから作るDeep Learningとともに学ぶフレームワーク（パーセプトロン編）'
		});
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
