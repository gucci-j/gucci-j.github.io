<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-07-26T17:49:30+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">ãã¾ã¾ã«NLP</title><subtitle>A Technical Blog about NLP and ML</subtitle><entry xml:lang="ja_JP"><title type="html">è«–æ–‡ãƒ¡ãƒ¢ï¼šDecoupling Strategy and Generation in Negotiation Dialogues</title><link href="http://localhost:4000/Note-Decoupling/" rel="alternate" type="text/html" title="è«–æ–‡ãƒ¡ãƒ¢ï¼šDecoupling Strategy and Generation in Negotiation Dialogues" /><published>2019-07-01T00:00:00+09:00</published><updated>2019-07-14T11:20:00+09:00</updated><id>http://localhost:4000/Note-Decoupling</id><content type="html" xml:base="http://localhost:4000/Note-Decoupling/">&lt;p&gt;æœ¬ç¨¿ã§ã¯ï¼ŒEMNLP 2018ã«æ¡æŠã•ã‚ŒãŸï¼Œè‡ªç„¶è¨€èªã§å£²ã‚Šç‰©ã®ä¾¡æ ¼äº¤æ¸‰ã‚’ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ææ¡ˆã—ãŸè«–æ–‡ï¼šã€ŒDecoupling Strategy and Generation in Negotiation Dialoguesã€ã®è«–æ–‡ã®ãƒ¡ãƒ¢æ›¸ãã‚’å…±æœ‰ãƒ»ç´¹ä»‹ã—ã¾ã™ï¼&lt;/p&gt;

&lt;h2 id=&quot;æ–‡çŒ®æƒ…å ±&quot;&gt;æ–‡çŒ®æƒ…å ±&lt;/h2&gt;
&lt;p&gt;è‘—è€…: H. He et al.&lt;br /&gt;
æ‰€å±: Computer Science Department, Stanford University&lt;br /&gt;
å‡ºå…¸: &lt;a href=&quot;https://www.aclweb.org/anthology/D18-1256&quot;&gt;EMNLP 2018&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ã©ã‚“ãªã‚‚ã®&quot;&gt;ã©ã‚“ãªã‚‚ã®ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;è‡ªç„¶è¨€èªã§äº¤æ¸‰å¯èƒ½ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã«ï¼Œäº¤æ¸‰æˆ¦ç•¥ã¨ãã®å®Ÿè¡Œéƒ¨ï¼ˆç™ºè©±æ©Ÿæ§‹ï¼‰ã‚’åˆ‡ã‚Šåˆ†ã‘ã¦è€ƒãˆã‚‹ã“ã¨ã§ï¼Œå¾“æ¥æ‰‹æ³•ã‚ˆã‚Šã‚‚ã‚¿ã‚¹ã‚¯ã®åˆæ„æˆåŠŸç‡ã‚’å‘ä¸Šã•ã›ï¼Œç™ºè©±ã«è¦‹ã‚‰ã‚Œã‚‹äººé–“ã‚‰ã—ã•ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ã«æˆåŠŸã—ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒã™ã”ã„&quot;&gt;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒã™ã”ã„ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;å˜ã«end-to-endã§ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ã®ã§ã¯ãªãï¼Œã€ŒParserãƒ»Managerãƒ»Generatorã€ã®ä¸‰ã¤ã«ãƒ¢ãƒ‡ãƒ«ã‚’åˆ†å‰²ã—ã¦æ‰ãˆãŸç‚¹ï¼ï¼ˆå¾“æ¥æ‰‹æ³•ã¯ï¼Œseq2seqã«åŸºã¥ã„ã¦å˜ã«å­¦ç¿’ã•ã›ã‚‹ã ã‘ã ã£ãŸï¼ï¼‰&lt;/p&gt;

&lt;p&gt;æˆ¦ç•¥ã‚’åˆ¶å¾¡ã™ã‚‹éƒ¨åˆ†ã¯ï¼Œå¾“æ¥ã®å˜èªãƒ™ãƒ¼ã‚¹ã§ã¯ãªãï¼Œcoarse-dialogue actsï¼šç²—ã„ï¼ˆè¦ç´„ï¼‰å¯¾è©±æƒ…å ±ã«ä¾å­˜ã—ã¦ã„ã‚‹ãŸã‚ï¼Œæˆ¦ç•¥ã®åˆ¶å¾¡ãŒã—ã‚„ã™ã„ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/model_diagram.png&quot; alt=&quot;3ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ã®ãƒ¢ãƒ‡ãƒ«å›³&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“&quot;&gt;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’ææ¡ˆï¼æˆ¦ç•¥ã¨ç”Ÿæˆã‚’åˆ‡ã‚Šé›¢ã—ã¦å­¦ç¿’ã•ã›ã‚‹ã“ã¨ã§ï¼Œæˆ¦ç•¥ã®åˆ¶å¾¡ã—ã‚„ã™ã•ã‚’ç¶­æŒã—ãªãŒã‚‰ã‚‚ï¼Œç™ºè©±ã®äººé–“ã‚‰ã—ã•ãŒä½ä¸‹ã—ãªã„ã‚ˆã†ã«ã§ãã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;h2 id=&quot;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸ&quot;&gt;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&quot;ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&quot;&gt;ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&lt;/h3&gt;
&lt;p&gt;ã‚¯ãƒ©ã‚¦ãƒ‰ã‚½ãƒ¼ã‚·ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã‚‹ï¼ŒAmazon Mechanical Turk (AMT)ã‚’æ´»ç”¨ï¼ã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆã‹ã‚‰äº¤æ¸‰ã‚·ãƒŠãƒªã‚ªã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ï¼ŒAMTã§ãã®ã‚·ãƒŠãƒªã‚ªã«åŸºã¥ã„ãŸäºŒè€…é–“ã®ä¾¡æ ¼äº¤æ¸‰ã‚’è¡Œã‚ã›ã‚‹ã“ã¨ã§ï¼Œå“ç‰©å£²è²·ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ§‹ç¯‰ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table1.png&quot; alt=&quot;äº¤æ¸‰ãƒ­ã‚°ã®ä¾‹&quot; style=&quot;width: 550px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;å®Ÿé¨“&quot;&gt;å®Ÿé¨“&lt;/h3&gt;
&lt;p&gt;Deal or no deal ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ï¼Œè‘—è€…ã‚‰ãŒä½œæˆã—ãŸï¼ŒCraigslist Bargain ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã‚ˆã‚Šå®Ÿé¨“ã‚’è¡Œãªã£ã¦ã„ã‚‹ï¼äººé–“ã‚‰ã—ã•ã‚’5ç‚¹æº€ç‚¹ã§AMTä¸Šã§è©•ä¾¡ï¼ã¾ãŸï¼Œtask-specificãªå€¤ï¼ˆåŠ¹ç”¨ï¼Œåˆæ„ç‡ï¼Œå…¬å¹³ã•ï¼Œå¯¾è©±ã®é•·ã•ï¼‰ã‚‚è¨ˆç®—ï¼&lt;/p&gt;

&lt;h2 id=&quot;è­°è«–ã¯ã‚ã‚‹&quot;&gt;è­°è«–ã¯ã‚ã‚‹ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;æ•™å¸«ã‚ã‚Šå­¦ç¿’æ™‚ã¯ï¼Œè‘—è€…ã®ææ¡ˆã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†ã¨ã‚ˆã„ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã‚‹ï¼ã¾ãŸï¼Œå¼·åŒ–å­¦ç¿’æ™‚ã‚‚ï¼Œwordãƒ™ãƒ¼ã‚¹ã§ã¯ãªãdialogue actãƒ™ãƒ¼ã‚¹ã«ã™ã‚‹ã¨ï¼Œå ±é…¬ã‚’æœ€é©åŒ–ã—ã¤ã¤ï¼Œç™ºè©±ã®è‡ªç„¶ã•ã‚‚ç¶­æŒã§ãã‚‹ã“ã¨ãŒç¤ºã•ã‚Œã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;h2 id=&quot;1-ã¯ã˜ã‚ã«&quot;&gt;1. ã¯ã˜ã‚ã«&lt;/h2&gt;
&lt;p&gt;äº¤æ¸‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®äºŒã¤ã®ç‚¹ã‚’ã†ã¾ãå®Ÿè¡Œã§ãã‚‹å¿…è¦ãŒã‚ã‚‹ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;äº¤æ¸‰æˆ¦ç•¥ã®ç«‹æ¡ˆ&lt;/li&gt;
  &lt;li&gt;äº¤æ¸‰æˆ¦ç•¥ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®è‡ªç„¶è¨€èªã®ç”Ÿæˆ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…ˆè¡Œç ”ç©¶ã¯ã€Œæˆ¦ç•¥ã€ã«ç€ç›®ã—ãŸã‚‚ã®ãŒå¤šã‹ã£ãŸï¼ã¾ãŸï¼Œè¿‘å¹´ã§ã¯ï¼Œend-to-endã«äº¤æ¸‰æˆ¦ç•¥ã¨è¨€èªç”Ÿæˆã®ä¸¡æ–¹ã‚’åŒæ™‚ã«ï¼Œäººé–“åŒå£«ã®äº¤æ¸‰ã‚’æ‰±ã£ãŸã‚³ãƒ¼ãƒ‘ã‚¹ã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚Šå­¦ç¿’ã‚’è¡Œã†ç ”ç©¶ãŒã§ã¦ãã¦ã„ã‚‹ (&lt;a href=&quot;https://aclweb.org/anthology/papers/D/D17/D17-1259/&quot;&gt;Lewis 2017&lt;/a&gt;, &lt;a href=&quot;https://aclweb.org/anthology/papers/P/P17/P17-1162/&quot;&gt;He 2017&lt;/a&gt;)ï¼&lt;/p&gt;

&lt;p&gt;end-to-endã«å­¦ç¿’ã‚’è¡Œã†ãƒ¢ãƒ‡ãƒ«ã®å•é¡Œç‚¹ã¨ã—ã¦ï¼Œä»¥ä¸‹ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;äº¤æ¸‰æˆ¦ç•¥ã®è§£é‡ˆ ï¼† åˆ¶å¾¡ã®é›£ã—ã•&lt;/li&gt;
  &lt;li&gt;å¼·åŒ–å­¦ç¿’ã§äº¤æ¸‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å­¦ç¿’ã•ã›ã‚‹ã¨ï¼Œç™ºè©±ãŒä¸è‡ªç„¶ã«ãªã‚‹ï¼ˆä¾‹ï¼šæ–‡æ³•ã«å‰‡ã£ã¦ã„ãªã„ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ãã“ã§ï¼Œè‘—è€…ã‚‰ã¯æˆ¦ç•¥ã¨ç”Ÿæˆã‚’åˆ†é›¢ã™ã‚‹æ‰‹æ³•ã®ææ¡ˆã‚’è¡Œãªã£ã¦ã„ã‚‹ï¼ã“ã‚Œã«ã‚ˆã‚Šï¼ŒåŒã˜ç”Ÿæˆå™¨ã‚’ç”¨ã„ã¦ã„ã¦ã‚‚ï¼Œæˆ¦ç•¥ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ï¼ˆä¾‹ï¼šåŠ¹ç”¨ã‚’æœ€å¤§åŒ–ã™ã‚‹ãƒ»å…¬å¹³ãªåˆæ„æ¡ˆã‚’å°ãï¼ï¼‰&lt;/p&gt;

&lt;h3 id=&quot;11-ææ¡ˆæ‰‹æ³•ã®æ¦‚è¦&quot;&gt;1.1 ææ¡ˆæ‰‹æ³•ã®æ¦‚è¦&lt;/h3&gt;
&lt;p&gt;ææ¡ˆæ‰‹æ³•ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯ä¸‰ã¤ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ãªã‚‹ï¼&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Parser&lt;/strong&gt;&lt;br /&gt;
äº¤æ¸‰ç›¸æ‰‹ã®ç™ºè¨€ã®æ„å›³ã‚„ãã®å¤‰æ•°ï¼šï¼ˆä¾¡æ ¼ï¼‰ã‚’è§£æ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Manager&lt;/strong&gt;&lt;br /&gt;
äº¤æ¸‰ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ¬¡ã®æˆ¦ç•¥ï¼ˆè¡Œå‹•ï¼‰ã‚’ç”Ÿæˆ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Generator&lt;/strong&gt;&lt;br /&gt;
æˆ¦ç•¥ã¨ç™ºè©±å±¥æ­´ã‚’åŸºã«è¿”ç­”æ–‡ã‚’ç”Ÿæˆ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/model_diagram.png&quot; alt=&quot;3ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ã®ãƒ¢ãƒ‡ãƒ«å›³&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;12-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦&quot;&gt;1.2 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¤ã„ã¦&lt;/h3&gt;
&lt;p&gt;å…ˆè¡Œç ”ç©¶ã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ï¼Œã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ãªãƒ‰ãƒ¡ã‚¤ãƒ³ï¼šç‰©ã®å±±åˆ†ã‘äº¤æ¸‰ã®ã¿ã‚’æ‰±ã£ã¦ã„ã‚‹ï¼ã“ã†ã—ãŸè¨­å®šã¯ï¼Œå®Ÿç¤¾ä¼šï¼ˆreal worldï¼‰ã¨ã¯ç¨‹é ã„ï¼ãã®ãŸã‚ï¼Œcraigslistã¨å‘¼ã°ã‚Œã‚‹ï¼Œã‚¯ãƒ©ã‚·ãƒ•ã‚¡ã‚¤ãƒ‰ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚µã‚¤ãƒˆã‹ã‚‰ï¼Œç‰©ã®å£²ã‚Šè²·ã„ã«é–¢ã™ã‚‹ãƒã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚’æŠ½å‡ºã—ã¦ï¼Œäº¤æ¸‰ã‚·ãƒŠãƒªã‚ªã‚’ä½œæˆã—ãŸï¼ã“ã®äº¤æ¸‰ã‚·ãƒŠãƒªã‚ªã‚’åŸºã«ï¼ŒAmazon Mechanical Turkï¼ˆAMTï¼‰ã‚’æ´»ç”¨ã—ã¦ï¼ŒäºŒè€…é–“ã§ã®ç‰©ã®ä¾¡æ ¼äº¤æ¸‰ã‚’å®Ÿæ–½ã—ãŸï¼ã“ã®äº¤æ¸‰ãƒ­ã‚°ãŒæœ¬è«–æ–‡ã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ï¼ŒCraigslist Bargain ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;13-è©•ä¾¡æŒ‡æ¨™ã«ã¤ã„ã¦&quot;&gt;1.3 è©•ä¾¡æŒ‡æ¨™ã«ã¤ã„ã¦&lt;/h3&gt;
&lt;p&gt;ç²å¾—åŠ¹ç”¨ ï¼† äººé–“ã‚‰ã—ã•ã§è©•ä¾¡ï¼&lt;br /&gt;
â†’ AMTã‚’æ´»ç”¨ã—ã¦ï¼ŒA/Bãƒ†ã‚¹ãƒˆã‚’è¡Œãªã£ã¦è©•ä¾¡ï¼&lt;/p&gt;

&lt;h2 id=&quot;2-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&quot;&gt;2. ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&lt;/h2&gt;
&lt;p&gt;Settlers of catan ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚„ï¼ŒDeal or no deal ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ï¼Œã‚²ãƒ¼ãƒ å½¢å¼ã®äº¤æ¸‰å¯¾è©±ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ãªã£ã¦ã„ã‚‹ï¼ã“ã®ãŸã‚ï¼Œå¯¾è©±ãŒç›´æ¥çš„ï¼ˆã‚ªãƒ•ã‚¡ãƒ¼å†…å®¹ã‚’ãã®ã¾ã¾ä¼ãˆã¦ã—ã¾ã†ï¼‰ã§ã‚ã£ãŸï¼æœ¬æ¥ã®å®Ÿç¤¾ä¼šã®äº¤æ¸‰ã§ã¯ï¼Œã€Œèª¬å¾—ã€ã‚„ã€Œæƒ…å ±åé›†ã€ãŒå…¥ã‚‹ã®ã§ï¼Œå…ˆè¡Œç ”ç©¶ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã‚ã¾ã‚Šç¾å®Ÿçš„ã§ãªã„ï¼&lt;/p&gt;

&lt;p&gt;ã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯ï¼Œå£²ã‚Šæ‰‹ã¨è²·ã„æ‰‹ã«ãªã‚Šãã£ã¦ï¼Œå•†å“ã®å£²è²·ã‚’è¡Œã†ï¼ã‚ˆã‚Šè‡ªç„¶ãªçŠ¶æ³è¨­å®šãªã®ã§ï¼Œã‚ˆã‚Šç¾å®Ÿçš„ã«ãªã‚‹ã¨ã„ã†ä¸»å¼µï¼&lt;/p&gt;

&lt;p&gt;äº¤æ¸‰ã‚·ãƒŠãƒªã‚ªã®ç”Ÿæˆã¯ï¼Œã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆã®6ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ãŸï¼ï¼ˆhousingï¼Œfurnitureï¼Œcarsï¼Œbikesï¼Œphonesï¼Œelectronicsï¼‰ï¼è²·ã„æ‰‹ã®ç›®æ¨™ä¾¡æ ¼ã¯ï¼Œãƒªã‚¹ãƒ†ã‚£ãƒ³ã‚°ä¾¡æ ¼ã®0.5ï¼Œ0.7ï¼Œ0.9å€ã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;äº¤æ¸‰ãƒ­ã‚°ã®ä¾‹ã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®çµ±è¨ˆã¯ä»¥ä¸‹ã®è¡¨ã®é€šã‚Šï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table1.png&quot; alt=&quot;äº¤æ¸‰ãƒ­ã‚°ã®ä¾‹&quot; style=&quot;width: 550px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table2.png&quot; alt=&quot;ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®çµ±è¨ˆ&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å…ˆè¡Œç ”ç©¶ã¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ¯”è¼ƒçµæœã¯æ¬¡ã®é€šã‚Šï¼å¤šã‚¸ãƒ£ãƒ³ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãªã®ã§ï¼Œèªå½™æ•°ãŒå¤šããªã£ã¦ã„ã‚‹ï¼ã•ã‚‰ã«ï¼Œç™ºè©±ã‚ãŸã‚Šã®å˜èªæ•°ã‚‚å¤šã„ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table3.png&quot; alt=&quot;ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ¯”è¼ƒ&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;3-approach&quot;&gt;3. Approach&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;seq2seqãƒ™ãƒ¼ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã¯ï¼Œæˆ¦ç•¥ã¨ç”Ÿæˆã®ä¸¡æ–¹ã‚’åŒæ™‚ã«å­¦ç¿’ã™ã‚‹ã“ã¨ã¯å›°é›£ï¼ï¼ˆç™ºè©±ãŒã‹ãªã‚Šä¸è‡ªç„¶ã«ãªã‚‹ï¼ï¼‰&lt;br /&gt;
â†’ æˆ¦ç•¥ã¨ç”Ÿæˆã‚’åˆ‡ã‚Šåˆ†ã‘ã¦è€ƒãˆã‚‹&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;31-overview&quot;&gt;3.1 Overview&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;dialogue agentã®å½¹å‰²&lt;/strong&gt;ï¼š&lt;br /&gt;
å…¥åŠ›ï¼šç™ºè©±å±¥æ­´ $x_1, x_2, \dots, x_{t-1}$ ã¨äº¤æ¸‰ã‚·ãƒŠãƒªã‚ª $c$&lt;br /&gt;
å‡ºåŠ›ï¼šè¿”ç­” $x_t$ ã®ç¢ºç‡åˆ†å¸ƒ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;coarse dialogue act&lt;/strong&gt;ï¼š&lt;br /&gt;
$x_t$ã«å¯¾ã—ã¦ï¼Œcoarse dialogue act $z_t$ ãŒè¨­ã‘ã‚‰ã‚Œã¦ã„ã‚‹ï¼&lt;br /&gt;
ä¾‹ï¼š$x_t$â†’ â€œI am willing to pay ï¼„15.â€ $z_t$â†’ â€œpropose(price=15)â€&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ãƒ¢ãƒ‡ãƒ«ã®å„å®šç¾©&quot;&gt;ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ãƒ¢ãƒ‡ãƒ«ã®å„å®šç¾©&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;parser&lt;/strong&gt;&lt;br /&gt;
å…¥åŠ›: $x_{t-1}$, å¯¾è©±å±¥æ­´ $x_{&amp;lt;t}$, $z_{&amp;lt;t}$, äº¤æ¸‰ã‚·ãƒŠãƒªã‚ª $c$&lt;br /&gt;
å‡ºåŠ›: $z_{t-1}$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;manager&lt;/strong&gt;&lt;br /&gt;
å…¥åŠ›: $z_{&amp;lt;t}$ï¼Œ$c$&lt;br /&gt;
å‡ºåŠ›: $z_t$
    &lt;blockquote&gt;
      &lt;p&gt;$x_{&amp;lt;t}$ ã¯coarse dialogue actã®æ±ºå®šã«ã¯å½±éŸ¿ã—ãªã„&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;generator&lt;/strong&gt;&lt;br /&gt;
å…¥åŠ›: $z_t$, $x_{&amp;lt;t}$&lt;br /&gt;
å‡ºåŠ›: $x_t$&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;32-parser&quot;&gt;3.2 Parser&lt;/h3&gt;
&lt;p&gt;ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒãƒƒãƒãƒ³ã‚°ã§ï¼Œä¾¡æ ¼ã‚„ç‰©å“ã«é–¢ã™ã‚‹æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ï¼å…·ä½“çš„ã«ã¯ï¼Œæ­£è¦è¡¨ç¾ã¨ifæ–‡ã§ãƒãƒƒãƒãƒ³ã‚°ã‚’ã—ã¦ã„ã‚‹ã‚‰ã—ã„ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table5.png&quot; alt=&quot;ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®æŠ½å‡ºæ³•ã®ä¸€è¦§&quot; style=&quot;width: 350px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;33-manager&quot;&gt;3.3 Manager&lt;/h3&gt;
&lt;p&gt;dialogue managerã¯ï¼Œå„ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ— $t$ ã«ãŠã„ã¦ï¼Œéå»ã®coarse dialogue acts å±¥æ­´ $z_{&amp;lt;t}$ ã¨ï¼Œäº¤æ¸‰ã‚·ãƒŠãƒªã‚ª $c$ ã‹ã‚‰ï¼Œæ¬¡ã«å–ã‚‹è¡Œå‹• $z_t$ ã‚’ç­–å®šã™ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;Managerã®å­¦ç¿’æ‰‹æ³•ã¯ï¼Œæ•™å¸«ã‚ã‚Šå­¦ç¿’ï¼Œå¼·åŒ–å­¦ç¿’ï¼Œãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ–¹å¼ã®ä¸‰ã¤ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;331-æ•™å¸«ã‚ã‚Šå­¦ç¿’&quot;&gt;3.3.1 æ•™å¸«ã‚ã‚Šå­¦ç¿’&lt;/h4&gt;
&lt;p&gt;äººé–“ã®æŒ¯ã‚‹èˆã„ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã®ã«æœ€é©ãªå­¦ç¿’æ‰‹æ³•ï¼&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å…¥åŠ›&lt;/strong&gt;: å„å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œå„å¯¾è©±ã®coarse dialogue acts $z_1, \dots. z_T$ ã‹ã‚‰ãªã‚‹ï¼&lt;br /&gt;
&lt;strong&gt;å‡ºåŠ›&lt;/strong&gt;: $p_\theta (z_t | z_{&amp;lt;t}, c)$&lt;/p&gt;

&lt;p&gt;å­¦ç¿’ã¯å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã§è¡Œã†ï¼
ãƒ¢ãƒ‡ãƒ«ã¯ï¼Œé€šå¸¸ã®seq2seqãƒ¢ãƒ‡ãƒ«ã«æ³¨æ„æ©Ÿæ§‹ã‚’ä»˜åŠ ã—ãŸã‚‚ã®ã§ã‚ã‚‹ï¼å„dialogue actã¯ï¼Œé€šå¸¸ã®ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦å…¥åŠ›ã•ã‚Œã‚‹ï¼ä¾‹ï¼šoffer 150ï¼ã“ã®å ´åˆï¼Œèªå½™æ•°ã¯ã‹ãªã‚Šå°‘ãªããªã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;332-å¼·åŒ–å­¦ç¿’&quot;&gt;3.3.2 å¼·åŒ–å­¦ç¿’&lt;/h4&gt;
&lt;p&gt;å ±é…¬ $R(z_{1:T})$ ã‚’coarse dialogue actsã®ã²ã¨ã¾ã¨ã¾ã‚Šã«å¯¾ã—ã¦é©ç”¨ï¼3ã¤ã®å ±é…¬é–¢æ•°ã«ã‚ˆã‚Šå®Ÿé¨“ã‚’è¡Œã†ï¼&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Utility&lt;/strong&gt;&lt;br /&gt;
ã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯ï¼Œã‚¼ãƒ­ã‚µãƒ ã‚²ãƒ¼ãƒ ã¨ã—ã¦ä¸ãˆã‚‹ï¼ãã‚Œä»¥å¤–ã®FBã®ã‚ˆã†ãªäºŒè€…é–“å±±åˆ†ã‘äº¤æ¸‰ã®å ´åˆã¯ï¼Œç·å’Œã¨ãªã‚‹ï¼&lt;/p&gt;

    &lt;p&gt;ã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆã§ã¯ï¼Œç›®æ¨™ä¾¡æ ¼ã§è³¼å…¥ or è²©å£²ã§ããŸã¨ãã«ã®ã¿ï¼ŒåŠ¹ç”¨ã¨ã—ã¦ï¼Œ1ã‚’ç²å¾—ã§ãï¼Œãã‚Œä»¥å¤–ã®å ´åˆã«ã¯ï¼Œ0ã‚’ç²å¾—ã™ã‚‹&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Fairness&lt;/strong&gt; &lt;br /&gt;
äºŒè€…é–“ã®åŠ¹ç”¨ã«ãªã‚‹ã¹ãå·®ãŒãªããªã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼å¹³ç­‰é‡è¦–ï¼è¨ˆç®—æ–¹æ³•ã¨ã—ã¦ã¯ï¼ŒäºŒè€…é–“ã®åŠ¹ç”¨ã®å·®ã§è¡¨ã•ã‚Œã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Length&lt;/strong&gt;&lt;br /&gt;
é•·ãä¼šè©±ã•ã›ã‚‹ãŸã‚ã®æŒ‡æ¨™ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åˆæ„ãŒå½¢æˆã•ã‚Œãªã‹ã£ãŸå ´åˆï¼Œå ±é…¬ã¯ä¸€å¾‹ã«$-1$  ã§ã‚ã‚‹ï¼
æœ€é©åŒ–ã«ã¯ï¼Œpolicy gradientï¼ˆæ–¹ç­–å‹¾é…æ³•ï¼‰ã‚’ç”¨ã„ã‚‹ï¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®å¼(1)ã«åŸºã¥ã„ã¦æ›´æ–°ã•ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\theta \leftarrow \theta - \eta \sum_{i} \nabla_\theta \log p_\theta (a_i | a_{&amp;lt; i}, c)(r - b) \tag{1}
$$
&lt;/div&gt;

&lt;p&gt;ãŸã ã—ï¼Œ$\eta$ ã¯å­¦ç¿’ç‡ï¼Œ$b$ ã¯å‡ºåŠ›ã®å¹³å‡ã‹ã‚‰æ¨å®šã•ã‚Œã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼$a_i$ ã¯ç”Ÿæˆã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆpolicyãŒå–ã‚‹è¡Œå‹•ï¼‰ã‚’æ„å‘³ã—ã¦ãŠã‚Šï¼Œ$z_{1:T}$ã«å¯¾å¿œã—ã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;ul&gt;
    &lt;li&gt;æ–¹ç­–å‹¾é…æ³•ã«ã¤ã„ã¦&lt;br /&gt;
æ–¹ç­–å‹¾é…æ³•ã¯ä¾¡å€¤é–¢æ•° $Q^{\pi_\theta}(s, a)$ ã‚’å®Ÿéš›ã«å¾—ã‚‰ã‚ŒãŸå ±é…¬ã®åˆè¨ˆã§è¿‘ä¼¼ã™ã‚‹ã‚‚ã®ï¼&lt;br /&gt;
ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’è¨­ã‘ã‚‹ã®ã¯ï¼ŒæœŸå¾…å€¤ã®åˆ†æ•£ã‚’æ¸›ã‚‰ã™ãŸã‚ï¼ˆvariance reduction)ï¼ ã“ã‚Œã«ã‚ˆã£ã¦ï¼Œãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã‚’æˆåŠŸã•ã›ã‚„ã™ããªã‚‹ã‚‰ã—ã„ï¼&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;333-hybrid-policy&quot;&gt;3.3.3 Hybrid Policy&lt;/h4&gt;
&lt;p&gt;coarse dialogue actsãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãï¼Œãƒ‰ãƒ¡ã‚¤ãƒ³ã«é–¢ã™ã‚‹çŸ¥è­˜ãŒã‚ã‚Œã°ï¼Œãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®managerã‚’ä½œæˆã§ãã‚‹ï¼&lt;/p&gt;

&lt;p&gt;ä¾‹ï¼š$z_{t-1} = {\rm greet}$ ã®ã¨ãï¼Œ$z_{t}$ ã‚‚ $\rm greet$ ã¨ã™ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;å®Ÿç”¨çš„ã«ã¯ï¼Œå­¦ç¿’æ¸ˆã¿ã®managerã‚’ç”¨ã„ã¦ï¼Œæ„å›³ï¼ˆè¡Œå‹•ï¼‰ã‚’æ±ºå®šã•ã›ã¦ï¼Œãã‚Œã«é–¢ã™ã‚‹å¤‰æ•°ã¯ï¼Œãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§æ±ºå®šã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;34-generator&quot;&gt;3.4 Generator&lt;/h3&gt;
&lt;p&gt;generatorã¯ï¼Œcoarse dialogue actã¨å¯¾è©±å±¥æ­´ã®ä¸¡æ–¹ã«åŸºã¥ã„ã¦ï¼Œæ¤œç´¢ãƒ™ãƒ¼ã‚¹ã«ã‚ˆã‚Šç™ºè©±å†…å®¹ã‚’æ±ºå®šã™ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;æ¤œç´¢å¯¾è±¡ã®å€™è£œã¯ã‚¿ãƒ—ãƒ«ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ï¼š$(d(x_{t-1}), z_{t-1}, d(x_t), z_t)$&lt;br /&gt;
$d$ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŠ½å‡ºå™¨ï¼šâ€How about ï¼„150?â€ã¨ã„ã†æ–‡ãŒã‚ã£ãŸã‚‰ï¼Œâ€How about [price]?â€ã¨ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ï¼[price] éƒ¨åˆ†ã¯ç”Ÿæˆæ™‚ã«ç©´åŸ‹ã‚ã•ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;p&gt;ãƒ†ã‚¹ãƒˆæ™‚ã«ã¯ï¼Œ$z_t$ ãŒä¸ãˆã‚‰ã‚ŒãŸã‚‰ï¼Œã¾ãšï¼Œ$z_t$ ã¨ $z_{t-1}$ ã¨åŒã˜æ„å›³ã‚’æŒã¤å€™è£œã‚’æ¤œç´¢ã™ã‚‹ï¼å€™è£œã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ç¾åœ¨ã®å¯¾è©±ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®é¡ä¼¼åº¦ã§è©•ä¾¡ã•ã‚Œã‚‹ï¼å…·ä½“çš„ã«ã¯ï¼Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ $d(x_{t-1})$ ã¯TF-IDFã§é‡ã¿ä»˜ã‘ã•ã‚ŒãŸï¼ŒBoWãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚Šï¼Œé¡ä¼¼åº¦ã¯äºŒã¤ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ™ã‚¯ãƒˆãƒ«é–“ã®å†…ç©ã§å¾—ã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;h2 id=&quot;4-experiments&quot;&gt;4. Experiments&lt;/h2&gt;
&lt;h3 id=&quot;41-models&quot;&gt;4.1 Models&lt;/h3&gt;
&lt;p&gt;ã¾ãšï¼Œæ•™å¸«ã‚ã‚Šå­¦ç¿’ã«ã‚ˆã£ã¦ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ï¼ã“ã®ã¨ãï¼Œ2ç¨®é¡ã®ãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã™ã‚‹ï¼&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;SL(word)&lt;/strong&gt;:  seq2seq + attention&lt;br /&gt;
ãƒ™ã‚¯ãƒˆãƒ«ã¯CBoWã§åŸ‹ã‚è¾¼ã¿ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;SL(act)&lt;/strong&gt;: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹ã®ãƒ¢ãƒ‡ãƒ«&lt;br /&gt;
ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ãƒ¼ã‚µãƒ¼ï¼Œå­¦ç¿’æ¸ˆã¿ã®managerï¼Œæ¤œç´¢ãƒ™ãƒ¼ã‚¹ã®generatorã‹ã‚‰ãªã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ã‚¯ãƒ¬ã‚¤ã‚°ã‚¹ãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯æ§˜ã€…ãªä¾¡æ ¼å¸¯ãŒã‚ã‚‹ã®ã§ï¼Œå€¤æ®µã‚’æ­£è¦åŒ–ã—ã¦æ‰±ã†ï¼ï¼ˆtarget priceãŒ1ï¼Œbottomline priceãŒ0ï¼ï¼‰å£²ã‚Šæ‰‹ã®bottomlineã¯ï¼Œlisting priceã®0.7å€ï¼è²·ã„æ‰‹ã®bottomlineã¯listing priceï¼&lt;/p&gt;

&lt;p&gt;æ•™å¸«ã‚ã‚Šå­¦ç¿’ã§å­¦ç¿’ã•ã›ãŸãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦ï¼Œå¼·åŒ–å­¦ç¿’ã§fine-tuneã™ã‚‹ï¼ãƒ¢ãƒ‡ãƒ«ã®è©³ç´°ã¯ä»¥ä¸‹ã®è¡¨6ã®é€šã‚Šï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table6.png&quot; alt=&quot;å®Ÿé¨“ãƒ¢ãƒ‡ãƒ«ã®ä¸€è¦§&quot; style=&quot;width: 350px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;42-å®Ÿé¨“è¨­å®š&quot;&gt;4.2 å®Ÿé¨“è¨­å®š&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;SL(word)&lt;/strong&gt;&lt;br /&gt;
3å€‹å‰ã¾ã§ã®ç™ºè¨€ã‚’attentionã®å¯¾è±¡ã«ã™ã‚‹ï¼äº¤æ¸‰ã‚·ãƒŠãƒªã‚ªã¯ï¼ŒCBoWã§åŸ‹ã‚è¾¼ã¿ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;SL(word) / SL(act)ã®ä¸¡æ–¹&lt;/strong&gt;&lt;br /&gt;
GloVeåŸ‹ã‚è¾¼ã¿ï¼š300æ¬¡å…ƒ&lt;br /&gt;
2å±¤ã®LSTMï¼š300æ¬¡å…ƒ&lt;br /&gt;
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯-0.1ã‹ã‚‰0.1ã®ä¸€æ§˜åˆ†å¸ƒã§åˆæœŸåŒ–&lt;br /&gt;
AdaGradï¼šï¼ˆå­¦ç¿’ç‡ï¼š0.01ï¼Œãƒãƒƒãƒã‚µã‚¤ã‚ºï¼š128ï¼‰&lt;br /&gt;
20ã‚¨ãƒãƒƒã‚¯å­¦ç¿’&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;RL&lt;/strong&gt;&lt;br /&gt;
å­¦ç¿’ç‡ï¼š0.001&lt;br /&gt;
5000ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰å­¦ç¿’&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;43-äººé–“ã«ã‚ˆã‚‹è©•ä¾¡&quot;&gt;4.3 äººé–“ã«ã‚ˆã‚‹è©•ä¾¡&lt;/h3&gt;
&lt;p&gt;äºŒã¤ã®æŒ‡æ¨™ã«ã‚ˆã‚Šè©•ä¾¡ï¼&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;task specificãªã‚¹ã‚³ã‚¢&lt;/strong&gt;&lt;br /&gt;
åŠ¹ç”¨ãƒ»åˆæ„æ¡ˆã®å…¬å¹³æ€§ãƒ»ç™ºè©±ã®é•·ã•ãƒ»åˆæ„ç‡&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;human-likeness&lt;/strong&gt;&lt;br /&gt;
1ã€œ5ã®5æ®µéšè©•ä¾¡ï¼é«˜ã‘ã‚Œã°é«˜ã„ã»ã©è‰¯ã„ï¼ã‚¹ã‚³ã‚¢ã¯AMTã®workerã«ã‚ˆã‚Šã¤ã‘ã‚‰ã‚ŒãŸï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;è¡¨7ã®æ„å‘³ã™ã‚‹ã¨ã“ã‚&quot;&gt;è¡¨7ã®æ„å‘³ã™ã‚‹ã¨ã“ã‚&lt;/h4&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;æ•™å¸«ã‚ã‚Šå­¦ç¿’ã‚’ã¤ã‘ã‚‹ã¨äººé–“ã‚‰ã—ã•ãŒå‘ä¸Šï¼ãŸã ã—ï¼Œactãƒ™ãƒ¼ã‚¹ã®æ–¹ãŒã‚¹ã‚³ã‚¢ãŒè‰¯ã„ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å¼·åŒ–å­¦ç¿’ã‚’ã¤ã‘ã‚‹ã¨ï¼Œwordãƒ™ãƒ¼ã‚¹ã®ã¨ãã¯äººé–“ã‚‰ã—ã•ãŒä½ä¸‹ã™ã‚‹ï¼ä¸€æ–¹ã§ï¼Œactãƒ™ãƒ¼ã‚¹ã®ã¨ãã¯å ±é…¬ã‚’æœ€é©åŒ–ã—ãªãŒã‚‰ã‚‚ï¼Œäººé–“ã‚‰ã—ã•ã‚’ç¶­æŒã—ã¦ã„ã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table7.png&quot; alt=&quot;ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®æŠ½å‡ºæ³•ã®ä¸€è¦§&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-07-01/table8.png&quot; alt=&quot;å¯¾è©±å±¥æ­´ã®æ¯”è¼ƒ&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://aclweb.org/anthology/papers/D/D18/D18-1256/&quot;&gt;Decoupling Strategy and Generation in Negotiation Dialogues&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã‚¹ãƒ©ã‚¤ãƒ‰&quot;&gt;ã‚¹ãƒ©ã‚¤ãƒ‰&lt;/h2&gt;
&lt;p&gt;(&lt;strong&gt;è¿½åŠ &lt;/strong&gt;: 2019/07/14)&lt;/p&gt;
&lt;div style=&quot;text-align: center&quot;&gt;&lt;iframe src=&quot;//www.slideshare.net/slideshow/embed_code/key/3L3ugPvxSRAt6o&quot; width=&quot;510&quot; height=&quot;420&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;</content><author><name></name></author><category term="è«–æ–‡ãƒ¡ãƒ¢" /><summary type="html">æœ¬ç¨¿ã§ã¯ï¼ŒEMNLP 2018ã«æ¡æŠã•ã‚ŒãŸï¼Œè‡ªç„¶è¨€èªã§å£²ã‚Šç‰©ã®ä¾¡æ ¼äº¤æ¸‰ã‚’ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ææ¡ˆã—ãŸè«–æ–‡ï¼šã€ŒDecoupling Strategy and Generation in Negotiation Dialoguesã€ã®è«–æ–‡ã®ãƒ¡ãƒ¢æ›¸ãã‚’å…±æœ‰ãƒ»ç´¹ä»‹ã—ã¾ã™ï¼</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/resources/2019-07-01/model_diagram.png" /></entry><entry xml:lang="ja_JP"><title type="html">ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ã®ãŠè©±</title><link href="http://localhost:4000/memo-svm/" rel="alternate" type="text/html" title="ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ã®ãŠè©±" /><published>2019-06-23T00:00:00+09:00</published><updated>2019-06-23T00:00:00+09:00</updated><id>http://localhost:4000/memo-svm</id><content type="html" xml:base="http://localhost:4000/memo-svm/">&lt;p&gt;ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ï¼ˆSVMï¼‰ã¯ï¼Œæ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‰ãªã„æ©Ÿæ¢°å­¦ç¿’ã®æ‰‹æ³•ã®ä¸€ã¤ã¨ã—ã¦åºƒãçŸ¥ã‚‰ã‚Œã¦ãŠã‚Šï¼Œã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹äº‹å‰çŸ¥è­˜ãŒå…¨ãç„¡ã„ã‚ˆã†ãªå ´åˆã«æœ‰åŠ¹ãªæ‰‹æ³•ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ï¼Œå€‹äººçš„ãªå‚™å¿˜éŒ²ã¨ã—ã¦ï¼ŒSVMã®è€ƒãˆæ–¹ã‚’å°‘ã—ãšã¤å³é¸ã—ã¦æ‰±ã„ã¾ã™ï¼&lt;/p&gt;

&lt;h2 id=&quot;ãŠè†³ç«‹ã¦&quot;&gt;ãŠè†³ç«‹ã¦&lt;/h2&gt;

&lt;p&gt;ä»Šï¼Œå›³ã®ã‚ˆã†ãªåˆ†å¸ƒã®ã€Œâ—ã¨ğŸ˜€ã®äºŒå€¤åˆ†é¡ã€ã‚’ã—ãŸã„ã¨ãã«ï¼Œãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç³»ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ãŸå ´åˆï¼Œãã®è­˜åˆ¥é¢ï¼ˆå¢ƒç•Œç·šï¼‰ã¯æ¬¡ã®å›³ã®ç‚¹ç·šã«ãªã‚‹ã‹ã‚‚ã—ã‚Œãªã„ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-06-23/empirical_example.png&quot; alt=&quot;ã„ã‚ã‚“ãªå¢ƒç•Œç·šã®æ¯”è¼ƒ&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;p&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã®ã‚ˆã†ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯ï¼ŒçµŒé¨“æå¤±ï¼ˆempirical lossï¼‰ã®æœ€å°åŒ–ã«ã‚ˆã£ã¦å­¦ç¿’ãŒè¡Œã‚ã‚Œã‚‹ï¼ãªã®ã§ï¼Œå¢ƒç•Œç·šãŒã‚¹ãƒ¬ã‚¹ãƒ¬ã§ã‚ã£ã¦ã‚‚ï¼Œè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦æå¤±ã‚’æœ€å°åŒ–ã™ã‚‹ã‚ˆã†ã«å­¦ç¿’ã—ã¦å¼•ã‹ã‚ŒãŸæ­£ã—ã„ç·šã§ã‚ã‚‹å ´åˆãŒã‚ã‚‹ï¼ã—ã‹ã—ãªãŒã‚‰ï¼Œå¢ƒç•Œç·šãŒã‚¹ãƒ¬ã‚¹ãƒ¬ã ã¨ï¼Œãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§åˆ†é¡ã—ãŸæ™‚ã«ï¼Œã€Œâ—ã¨ğŸ˜€ã€ãŒé–“é•ãˆã¦åˆ†é¡ã•ã‚Œã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šï¼Œã‚ã¾ã‚Šå¬‰ã—ããªã„ï¼&lt;/p&gt;

&lt;p&gt;SVMã¯ï¼Œã“ã®å•é¡Œã«å¯¾å‡¦ã™ã‚‹ã“ã¨ã§æ±åŒ–æ€§èƒ½ã‚’ã‚ã’ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ï¼SVMã®å­¦ç¿’ã¯ï¼Œæ±åŒ–æå¤±ï¼ˆgeneralization lossï¼‰ã®æœ€å°åŒ–ã«ã‚ˆã‚Šè¡Œã‚ã‚Œã‚‹ï¼ç€æƒ³ã¨ã—ã¦ã¯ï¼Œãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨åŒã˜ç¢ºç‡åˆ†å¸ƒã«å¾“ã£ã¦ã„ã‚‹ã‚‚ã®ã¨ä»®å®šã—ã¦ï¼Œå¢ƒç•Œé¢ï¼ˆseparatorï¼›è­˜åˆ¥é¢ï¼‰ã¨è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã®è·é›¢ãŒãªã‚‹ã¹ãå¤§ãããªã‚‹ã‚ˆã†ãªå¢ƒç•Œé¢ã‚’é¸ã¶ã“ã¨ã§ï¼Œæ±åŒ–æå¤±ã®æœ€å°åŒ–ã‚’ç›®æŒ‡ã™ã‚‚ã®ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-06-23/svm_example.png&quot; alt=&quot;SVMã®å¢ƒç•Œé¢ã®ä¾‹ã¨ç”¨èªå®šç¾©&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;ç”¨èªã®å®šç¾©&quot;&gt;ç”¨èªã®å®šç¾©&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ï¼ˆsupport vectorï¼‰&lt;/strong&gt;&lt;br /&gt;
å¢ƒç•Œé¢ï¼ˆseparatorï¼›è­˜åˆ¥é¢ï¼‰ã«ã‚‚ã£ã¨ã‚‚è¿‘ã„ç‚¹ã®ã“ã¨ã‚’ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ã¨å‘¼ã¶ï¼ã‚µãƒãƒ¼ãƒˆã¨å‘¼ã°ã‚Œã‚‹æ‰€ä»¥ã¯ï¼Œã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ãŒå¢ƒç•Œé¢ã‚’ã€Œæ”¯ãˆã¦ã„ã‚‹ã€ã“ã¨ã‹ã‚‰æ¥ã¦ã„ã‚‹ã‚‰ã—ã„ï¼&lt;/p&gt;

    &lt;p&gt;é€šå¸¸ï¼Œã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ã®æ•°ã¯æœ¬æ¥ã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚ˆã‚Šã‚‚å°ã•ããªã‚‹ã®ã§ï¼ŒSVMã¯ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚æ›´æ–°ã®è¨ˆç®—é‡ãŒå°‘ãªãæ¸ˆã‚€ï¼ï¼ˆã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤‰åŒ–ã—ã¦ã‚‚ï¼Œå¢ƒç•Œã¯å¤‰åŒ–ã—ãªã„ãŸã‚ï¼ï¼‰ã¾ãŸï¼Œé‡è¦ãªãƒ™ã‚¯ãƒˆãƒ«ã ã‘ã‚’è¦‹ã‚Œã°ã‚ˆã„ã®ã§ï¼Œæ±åŒ–æ€§èƒ½ã‚‚å‘ä¸Šã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;ãƒãƒ¼ã‚¸ãƒ³ï¼ˆmarginï¼‰&lt;/strong&gt;&lt;br /&gt;
å›³ä¸­ã§ç‚¹ç·šã«ã‚ˆã£ã¦å›²ã‚ã‚ŒãŸç¯„å›²ã‚’ãƒãƒ¼ã‚¸ãƒ³ã¨å‘¼ã¶ï¼ãƒãƒ¼ã‚¸ãƒ³ã¯å¢ƒç•Œé¢ã¨å¢ƒç•Œé¢ã‹ã‚‰ã‚‚ã£ã¨ã‚‚è¿‘ã„ç‚¹ï¼ˆè¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ï¼‰ã¨ã®è·é›¢ã®2å€ã¨ãªã‚‹ï¼&lt;/p&gt;

    &lt;p&gt;SVMã«ãŠã„ã¦ï¼Œã€Œå¢ƒç•Œé¢ã¨è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã®è·é›¢ãŒãªã‚‹ã¹ãå¤§ãããªã‚‹ã‚ˆã†ã«å­¦ç¿’ã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã¯ï¼Œã€Œãƒãƒ¼ã‚¸ãƒ³ã‚’ãªã‚‹ã¹ãå¤§ããã™ã‚‹ã‚ˆã†ã«å­¦ç¿’ã™ã‚‹ã€ã¨ã„ã†ã“ã¨ã‚’æ„å‘³ã—ã¦ã„ã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ç”¨èªã®æ•°å¼çš„å®šç¾©&quot;&gt;ç”¨èªã®æ•°å¼çš„å®šç¾©&lt;/h3&gt;

&lt;p&gt;ä»¥é™ï¼Œç°¡å˜ã«ã§ã¯ã‚ã‚‹ãŒæ•°å¼ã§èª¬æ˜ã‚’è¡Œã†ãŸã‚ï¼Œã‚ã¾ã‚Šæ›¸ã‹ã‚Œã¦ã„ãªã„åŸºæœ¬çš„ãªéƒ¨åˆ†ã®è¨ˆç®—æ‰‹æ³•ã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;è­˜åˆ¥é¢ã®æ•°å¼çš„è¡¨è¨˜&quot;&gt;è­˜åˆ¥é¢ã®æ•°å¼çš„è¡¨è¨˜&lt;/h4&gt;

&lt;p&gt;è­˜åˆ¥é¢ã¯ï¼Œå…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãŒ $\boldsymbol{x}$ ã¨è¡¨ã•ã‚Œã‚‹ã¨ãï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\boldsymbol{w^Tx} + b = 0
$$
&lt;/div&gt;
&lt;p&gt;ã“ã“ã§ï¼Œ$\boldsymbol{w}$ ã¯é‡ã¿ãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚Šï¼Œ$b$ ã¯ãƒã‚¤ã‚¢ã‚¹ãƒ™ã‚¯ãƒˆãƒ«ã§ã‚ã‚‹ï¼ã¾ãŸï¼Œå„ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ãŒä½œã‚‹ç›´ç·šï¼ˆä¸Šå›³ã®ç‚¹ç·šã«ç›¸å½“ã™ã‚‹ï¼‰ã¯ï¼Œ$\boldsymbol{w^Tx} + b = 1$ ã‹ $\boldsymbol{w^Tx} + b = -1$ ã§å®šç¾©ã•ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;ãƒãƒ¼ã‚¸ãƒ³ã®æ•°å¼çš„è¡¨è¨˜&quot;&gt;ãƒãƒ¼ã‚¸ãƒ³ã®æ•°å¼çš„è¡¨è¨˜&lt;/h4&gt;

&lt;p&gt;ã•ã¦ï¼Œ$\boldsymbol{w^Tx} + b = 1$ ã¨ãªã‚‹ã‚ˆã†ãªï¼Œ$\boldsymbol{x}$ ã®ã†ã¡ã®ä¸€ã¤ã‚’ï¼Œ$\boldsymbol{x}_1$ ã¨ã™ã‚‹ï¼ã¾ãŸï¼Œ$\boldsymbol{w^Tx} + b = -1$ ã¨ãªã‚‹ã‚ˆã†ãªï¼Œ$\boldsymbol{x}$ ã®ã†ã¡ã®ä¸€ã¤ã‚’ï¼Œ$\boldsymbol{x}_2$ ã¨ã™ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;ã“ã®ã¨ãï¼Œå¢ƒç•Œé¢ã¨ï¼Œã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ« $\boldsymbol{x}_1$ ã®è·é›¢ $r_1$ã¯ï¼Œå‚ç·šã®å…¬å¼ã®æ‹¡å¼µç‰ˆã‚’ç”¨ã„ã¦ï¼Œæ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
r_1 = \frac{\boldsymbol{w^Tx}_1 + b }{||\boldsymbol{w}||}
$$
&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;ã“ã“ã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ´ã‚€ã®ãŒç›®çš„ãªã®ã§ï¼Œå‚ç·šã®å…¬å¼ã«ã¤ã„ã¦ã¯è§¦ã‚Œã¾ã›ã‚“ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ã—ãŸãŒã£ã¦ï¼Œãƒãƒ¼ã‚¸ãƒ³: $m$ã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\begin{equation}
\begin{split}
m &amp;amp;= \frac{\boldsymbol{w^Tx}_1 + b }{||\boldsymbol{w}||} - \frac{\boldsymbol{w^Tx}_2 + b }{||\boldsymbol{w}||}\\
&amp;amp;= \frac{\boldsymbol{w^T}(\boldsymbol{x}_1 - \boldsymbol{x}_2)}{||\boldsymbol{w}||}\\
&amp;amp;= \frac{2}{||\boldsymbol{w}||}
\end{split}
\end{equation}
$$
&lt;/div&gt;
&lt;p&gt;ãŸã ã—ï¼Œ$\boldsymbol{w^Tx}_1 + b = 1$ ã¨ $\boldsymbol{w^Tx}_2 + b = -1$ ã‹ã‚‰ï¼Œ$\boldsymbol{w^T}(\boldsymbol{x}_1 - \boldsymbol{x}_2) = 2$ ã¨ãªã‚‹ã“ã¨ã‚’ç”¨ã„ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;svmã®å­¦ç¿’æ–¹æ³•&quot;&gt;SVMã®å­¦ç¿’æ–¹æ³•&lt;/h2&gt;

&lt;p&gt;SVMã®å­¦ç¿’æ–¹æ³•ã¯2ç¨®é¡ã‚ã‚Šï¼Œç›´æ„Ÿçš„ãªè§£ãæ–¹ã¨ã—ã¦ã¯ï¼Œãƒãƒ¼ã‚¸ãƒ³ã‚’æœ€å¤§åŒ–ã™ã‚‹å•é¡Œã‚’è§£ãã“ã¨ã§ã‚ã‚Šï¼Œãã“ã‹ã‚‰æ´¾ç”Ÿã—ãŸè§£æ³•ã‚‚å­˜åœ¨ã™ã‚‹ï¼ãã®ãŸã‚ï¼Œä»¥ä¸‹ã§ç´¹ä»‹ã™ã‚‹2æ‰‹æ³•ã¯åŒå¯¾å•é¡Œã¨è¨€ã‚ã‚Œã‚‹ï¼åŒå¯¾å•é¡Œã¨ã¯ï¼Œã‚ã‚‹æœ€é©åŒ–å•é¡Œã®åˆ¶ç´„æ¡ä»¶ã‚’ç”¨ã„ã¦ï¼Œã‚ˆã‚Šæœ€é©åŒ–ã—ã‚„ã™ã„å•é¡Œã«ç½®ãæ›ãˆã¦è§£ãã‚ˆã†ãªå•é¡Œã®ã“ã¨ã‚’ã„ã„ï¼Œã©ã¡ã‚‰ã‹ã®è§£ãŒä¸¡æ–¹ã®è§£ã«ãªã‚‹æ€§è³ªã‚’æŒã¤ï¼&lt;/p&gt;

&lt;h3 id=&quot;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ä¸»å•é¡Œ&quot;&gt;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ï¼ˆä¸»å•é¡Œï¼‰&lt;/h3&gt;
&lt;h4 id=&quot;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®å®šå¼åŒ–&quot;&gt;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®å®šå¼åŒ–&lt;/h4&gt;
&lt;p&gt;ã•ã¦ï¼Œãƒãƒ¼ã‚¸ãƒ³ã¯ï¼Œ$\frac{2}{||\bm{w}||}$ ã§å®šç¾©ã•ã‚Œã‚‹ã“ã¨ã‚’å…ˆã»ã©ç¤ºã—ãŸï¼ãƒãƒ¼ã‚¸ãƒ³ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã¯ï¼Œé‡ã¿ãƒ™ã‚¯ãƒˆãƒ«ã®ãƒãƒ«ãƒ ã‚’æœ€å°åŒ–ã™ã‚‹ã“ã¨ã«ä»–ãªã‚‰ãªã„ï¼ã—ãŸãŒã£ã¦ï¼Œå¼ã§ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã‚’è¡¨ã™ã¨ï¼Œ$\argmax_{\bm{w}} \frac{2}{||\bm{w}||}$ ã¨ãªã‚‹ï¼ã“ã‚Œã§ã¯ï¼Œæœ€é©åŒ–ã‚’ã™ã‚‹éš›ã«è¨ˆç®—ã®éƒ½åˆä¸Šæ‰±ã„ã«ãã„ã®ã§ï¼Œå¤§åŠã®èª¬æ˜ã§ã¯ä»¥ä¸‹ãŒç­‰ä¾¡ã§ã‚ã‚‹ã¨ã¿ãªã—ã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\argmin_{\bm{w}} \frac{1}{2} ||w||^2
$$
&lt;/div&gt;

&lt;h4 id=&quot;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®åˆ¶ç´„æ¡ä»¶&quot;&gt;ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®åˆ¶ç´„æ¡ä»¶&lt;/h4&gt;
&lt;p&gt;æœ€é©åŒ–ã®ãŸã‚ã®åˆ¶ç´„æ¡ä»¶ã«ã¤ã„ã¦è€ƒãˆã‚‹ï¼å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ $\{ \bm{x}_1, \bm{x}_2, \bm{x}_3, \dots, \bm{x}_n \}$ ãŒã‚ã£ãŸã¨ãã«ï¼Œãã‚Œã«å¯¾å¿œã™ã‚‹ï¼ˆæ­£è§£ï¼‰ãƒ©ãƒ™ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒï¼Œ$\{ y_1, y_2, y_3, \dots, y_n \}$ ã§ã‚ã‚‹ã¨ã™ã‚‹ï¼ãŸã ã—ï¼Œ$y_i$ ã¯ï¼Œ$1$ã‹$-1$ã‚’ã¨ã‚‹ï¼ã“ã®ã¨ãï¼Œä»¥ä¸‹ã®åˆ¶ç´„æ¡ä»¶ãŒæˆã‚Šç«‹ã¤ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
y_i (\bm{w}^T\bm{x}_i + b) \ge 1 \qquad{\rm for} \; i=1,\dots, n
$$
&lt;/div&gt;

&lt;p&gt;ã—ãŸãŒã£ã¦ï¼Œãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã¯ä¸Šè¨˜ã®åˆ¶ç´„æ¡ä»¶ã‚’ã‚‚ã¨ã«ï¼Œæ¡ä»¶ã‚’æº€ãŸã™é‡ã¿ãƒ™ã‚¯ãƒˆãƒ«ã‚’æ¢ã™å•é¡Œã«å¸°ç€ã•ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã«ã‚ˆã‚‹æ–¹æ³•è£œå•é¡Œ&quot;&gt;ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã«ã‚ˆã‚‹æ–¹æ³•ï¼ˆè£œå•é¡Œï¼‰&lt;/h3&gt;
&lt;p&gt;ä¸€æ–¹ã§ï¼Œåˆ¥ã®è§£ãæ–¹ã‚‚å­˜åœ¨ã—ã¦ï¼Œãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã‚’ä½¿ã†è§£ãæ–¹ãŒã‚ã‚‹ï¼ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã‚¢ãƒ³ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ï¼Œä¸Šè¨˜ã®ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–å•é¡Œã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\mathcal{L}(\bm{w}, b, \alpha) = \frac{1}{2}||\bm{w}||^2 + \sum_{i=1}^{n} \alpha_i (1 - y_i(\bm{w}^T\bm{x_i} + b))
$$
&lt;/div&gt;

&lt;p&gt;ã“ã®ã¨ãï¼Œæœ€é©åŒ–æ¡ä»¶ã‚’è€ƒæ…®ã™ã‚‹ã¨ï¼Œä»¥ä¸‹ãŒå¾—ã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\begin{equation}
\begin{split}
\frac{\partial}{\partial \bm{w}} \mathcal{L} &amp;amp;= \bm{w} - \sum_{i=1}^{n} \alpha_i y_i \bm{x}_i = 0\\
\frac{\partial}{\partial b} \mathcal{L} &amp;amp;= - \sum_{i=1}^{n} \alpha_i y_i = 0
\end{split}
\end{equation}
$$
&lt;/div&gt;

&lt;p&gt;ä¸Šè¨˜ã®æœ€é©åŒ–æ¡ä»¶ã‚’ï¼Œå…ƒã®ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã‚¢ãƒ³ $\mathcal{L}$ ã«ä»£å…¥ã—ã¦è¨ˆç®—ã™ã‚‹ã¨ï¼Œä»¥ä¸‹ãŒå¾—ã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\mathcal{L}(\bm{w}, b, \alpha) = \sum_{i=1}^{n} \alpha_i - \frac{1}{2}\sum_{i=1}^{n} \sum_{j=1}^{n} \alpha_i \alpha_j y_i y_j (\bm{x}_i^T \bm{x}_j) \tag{1}
$$
&lt;/div&gt;

&lt;p&gt;ã¾ãŸï¼ŒåŒå¯¾å•é¡Œæ™‚ã®KKTæ¡ä»¶ã‚’è€ƒæ…®ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œè¿½åŠ ã®åˆ¶ç´„æ¡ä»¶: $\alpha_i \ge 0$ ã‚’å¾—ã‚‰ã‚Œã‚‹ï¼ä»¥ä¸Šã‹ã‚‰ï¼Œãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®å•é¡Œã¯ï¼Œãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥é–¢æ•°ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ï¼Œ$\alpha$ ã‚’æœ€å¤§åŒ–ã™ã‚‹å•é¡Œã«è½ã¨ã—ã“ã‚€ã“ã¨ãŒã§ãã‚‹ï¼å¼ã§è¡¨ã™ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\argmax_\alpha \sum_{i=1}^{n} \alpha_i - \frac{1}{2}\sum_{i=1}^{n} \sum_{j=1}^{n} \alpha_i \alpha_j y_i y_j (\bm{x}_i^T \bm{x}_j)
$$
&lt;/div&gt;

&lt;p&gt;ã“ã‚Œã¯ï¼ŒäºŒæ¬¡è¨ˆç”»å•é¡Œã§ã‚ã‚‹ãŸã‚ï¼Œã‚½ãƒ«ãƒãƒ¼ã‚’ä½¿ãˆã°æœ€é©è§£ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼æœ€é©ãªãƒ™ã‚¯ãƒˆãƒ« $\alpha$ ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚Œã°ï¼Œæœ€é©åŒ–æ¡ä»¶ã§ã‚ã‚‹ï¼Œ$\bm{w} = \sum_{i=1}^{n} \alpha_i y_i \bm{x}_i$ ã‚’ç”¨ã„ã¦ï¼Œé‡ã¿ãƒ™ã‚¯ãƒˆãƒ« $\bm{w}$ ã‚‚èŠ‹ã¥ã‚‹å¼ã«æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ã¾ãŸï¼Œãƒã‚¤ã‚¢ã‚¹ $b$ ã«ã¤ã„ã¦ã‚‚ï¼Œä¸Šè¿°ã®ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–ã®åˆ¶ç´„æ¡ä»¶ã‹ã‚‰ç®—å‡ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ã“ã‚Œã«ã‚ˆã£ã¦ï¼Œè­˜åˆ¥é–¢æ•°ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ï¼Œãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã«ã‚ˆã‚‹æ–¹æ³•ã§ï¼ŒSVMã®å­¦ç¿’ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒï¼š&lt;a href=&quot;https://qiita.com/AnchorBlues/items/8fe2483a3a72676eb96d&quot;&gt;ãƒ™ã‚¯ãƒˆãƒ«ã®å¾®åˆ†&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒï¼š&lt;a href=&quot;https://ja.wikipedia.org/wiki/%E3%82%AB%E3%83%AB%E3%83%BC%E3%82%B7%E3%83%A5%E3%83%BB%E3%82%AF%E3%83%BC%E3%83%B3%E3%83%BB%E3%82%BF%E3%83%83%E3%82%AB%E3%83%BC%E6%9D%A1%E4%BB%B6&quot;&gt;KKTæ¡ä»¶&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;2æ‰‹æ³•ã®æ¯”è¼ƒ&quot;&gt;2æ‰‹æ³•ã®æ¯”è¼ƒ&lt;/h3&gt;

&lt;p&gt;ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã‚’ç”¨ã„ã‚‹æ‰‹æ³•ã®æ–¹ãŒç¨®ã€…ã®åˆ©ç‚¹ãŒã‚ã‚‹ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;$\mathcal{L}$ ã¯å‡¸é–¢æ•°ã§ã‚ã‚‹ãŸã‚ï¼Œå”¯ä¸€ã®å¤§åŸŸæœ€é©è§£ã‚’è¦‹ã¤ã‘ã‚„ã™ã„ï¼&lt;/li&gt;
  &lt;li&gt;ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ä»¥å¤–ã®$\alpha_i$ ã¯0ã¨ãªã‚‹ãŸã‚ï¼Œè¨ˆç®—ãŒå°‘ãªãæ¸ˆã‚€ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ç·šå½¢åˆ†é›¢ä¸å¯èƒ½ãªã¨ãã¯&quot;&gt;ç·šå½¢åˆ†é›¢ä¸å¯èƒ½ãªã¨ãã¯ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãŒç·šå½¢åˆ†é›¢ã§ããªã„å ´åˆï¼Œéç·šå½¢å¤‰æ›ã‚’æ–½ã—ã¦é«˜æ¬¡å…ƒç©ºé–“ã«å†™åƒã—ã¦ã—ã¾ãˆã°ï¼Œåˆ†é¡å¯èƒ½ã¨ãªã‚‹ã¨ããŒã‚ã‚‹ï¼ä¾‹ã¨ã—ã¦ï¼Œã‚ã‚‹ç‰¹å¾´ç©ºé–“ $F(\bm{x})$ ãŒï¼Œæ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ã¨ã™ã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
F([x_1, x_2]) = (x_1^2, x_2^2, \sqrt{2} x_1 x_2)
$$
&lt;/div&gt;

&lt;p&gt;ã“ã®ã¨ãï¼Œ$F(\bm{x})$ ã§ã®ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã‚¢ãƒ³: å¼(1)ã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\mathcal{L}(\bm{w}, b, \alpha) = \sum_{i=1}^{n} \alpha_i - \frac{1}{2}\sum_{i=1}^{n} \sum_{j=1}^{n} \alpha_i \alpha_j y_i y_j F(\bm{x}_i) F(\bm{x}_j) \tag{2}
$$
&lt;/div&gt;

&lt;p&gt;å¼(2)ã®å€¤ã‚’æ±‚ã‚ã‚‹ã«ã¯ï¼Œé«˜æ¬¡å…ƒç©ºé–“ $F(\bm{x})$ ã§ã®å†…ç© $F(\bm{x}_i) \cdot F(\bm{x}_j)$ã®å€¤ã‚’è¨ˆç®—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ä»Šå›ã®ä¾‹ã®å ´åˆï¼Œé«˜æ¬¡å…ƒç©ºé–“ã«ãŠã‘ã‚‹å†…ç©ã‚’è¨ˆç®—ã—ã¦ã¿ã‚‹ã¨ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\begin{equation}
\begin{split}
F(\bm{x}_i) \cdot F(\bm{x}_j) &amp;amp;= 
\begin{bmatrix}
x_{i_1}^2\\
x_{i_2}^2\\
\sqrt{2} x_{i_1}x_{i_2} 
\end{bmatrix}
\cdot 
\begin{bmatrix}
x_{j_1}^2\\
x_{j_2}^2\\
\sqrt{2} x_{j_1}x_{j_2} 
\end{bmatrix}\\
&amp;amp;= x_{i_1}^2 x_{j_1}^2 + x_{i_2}^2 x_{j_2}^2 + 2x_{i_1}x_{i_2}x_{j_1}x_{j_2} 
\end{split}
\end{equation}
$$
&lt;/div&gt;

&lt;p&gt;é«˜æ¬¡å…ƒç©ºé–“ã«å¤‰æ›ã—ã¦ã‹ã‚‰å†…ç©ã‚’è¨ˆç®—ã™ã‚‹æ‰‹é–“ãŒãŠåˆ†ã‹ã‚Šã«ãªã£ãŸã¨æ€ã†ï¼&lt;/p&gt;

&lt;p&gt;ãã‚“ãªã¨ã“ã‚ã«æœ—å ±ã§ï¼Œå®Ÿã¯ä¸Šè¨˜ã®å†…ç©ã¯å¤‰æ›å‰ã«ãŠã‘ã‚‹ï¼Œ$(\bm{x_i}\cdot\bm{x_j})^2$ ã®æ¼”ç®—çµæœã«ä¸€è‡´ã™ã‚‹ï¼ã“ã®$(\bm{x_i}\cdot\bm{x_j})^2$ ã‚’ï¼Œ&lt;strong&gt;ã‚«ãƒ¼ãƒãƒ«é–¢æ•°&lt;/strong&gt;ï¼ˆkernel functionï¼‰ã¨å‘¼ã¶ï¼ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã•ãˆã‚ã‹ã‚Œã°ï¼Œå…ƒã®ç©ºé–“ã§ã®ãƒ™ã‚¯ãƒˆãƒ«æ¼”ç®—ã ã‘ã§æ¸ˆã‚€ã®ã§ï¼Œé€ä¸€å„å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«ã®å€¤ã‚’é«˜æ¬¡å…ƒç©ºé–“ã«å†™åƒã™ã‚‹å‡¦ç†ã¯å¿…è¦ãªãï¼Œå°‘ãªã„æ‰‹é–“ã§ç·šå½¢åˆ†é›¢ã§ããªã„ãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ã“ã®ã“ã¨ã‚’&lt;strong&gt;ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯&lt;/strong&gt;ã¨ã‚‚ã„ã†ï¼&lt;/p&gt;

&lt;h3 id=&quot;ç¨®ã€…ã®ã‚«ãƒ¼ãƒãƒ«é–¢æ•°&quot;&gt;ç¨®ã€…ã®ã‚«ãƒ¼ãƒãƒ«é–¢æ•°&lt;/h3&gt;

&lt;p&gt;ã‚«ãƒ¼ãƒãƒ«é–¢æ•°ã¯ã„ãã¤ã‹ç¨®é¡ãŒã‚ã‚Šï¼Œå¤šé …å¼ã‚«ãƒ¼ãƒãƒ«ã¨ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«ãŒæœ‰åã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;å¤šé …å¼ã‚«ãƒ¼ãƒãƒ«&quot;&gt;å¤šé …å¼ã‚«ãƒ¼ãƒãƒ«&lt;/h4&gt;
&lt;p&gt;å¤šé …å¼ã‚«ãƒ¼ãƒãƒ«ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
K(\bm{x}_i, \bm{x}_j) = (\bm{x}_i^T \bm{x}_j + 1)^d
$$
&lt;/div&gt;

&lt;h4 id=&quot;ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«&quot;&gt;ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«&lt;/h4&gt;
&lt;p&gt;ã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«ï¼ˆRBFã‚«ãƒ¼ãƒãƒ«ã¨è¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ï¼‰ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ï¼&lt;/p&gt;
&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
K(\bm{x}_i, \bm{x}_j) = \exp(-\beta||\bm{x}_i - \bm{x}_j||^2)
$$
&lt;/div&gt;
&lt;p&gt;ãŸã ã—ï¼Œ$\beta$ã¯æ­£ã®å®šæ•°ï¼ãªãŠï¼Œå®Ÿéš›ã«SVMã§ãƒ‡ãƒ¼ã‚¿åˆ†é¡ã‚’ã™ã‚‹éš›ã«ã¯ï¼Œã‚¬ã‚¦ã‚¹ã‚«ãƒ¼ãƒãƒ«ã‚’ä½¿ã†å ´åˆãŒå¤šã„ã‚ˆã†ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒï¼š&lt;a href=&quot;https://dev.classmethod.jp/machine-learning/svm-kernel/&quot;&gt;SVMã®ã‚«ãƒ¼ãƒãƒ«ã«ã¤ã„ã¦&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã‚½ãƒ•ãƒˆãƒãƒ¼ã‚¸ãƒ³ã¨ãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³&quot;&gt;ã‚½ãƒ•ãƒˆãƒãƒ¼ã‚¸ãƒ³ã¨ãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³&lt;/h2&gt;

&lt;p&gt;ç†æƒ³çš„ãªç’°å¢ƒã§ã‚ã‚Œã°ãƒ‡ãƒ¼ã‚¿ã«ãƒã‚¤ã‚ºãŒå…¥ã‚‹ã“ã¨ã¯ãªã„ï¼ã—ã‹ã—ï¼Œç¾å®Ÿã«ã¯ãã†ã¯ã„ã‹ãªã„ï¼ä»Šã¾ã§èª¬æ˜ã—ã¦ããŸSVMã®è€ƒãˆæ–¹ã‚’å…ƒã«ï¼Œãƒã‚¤ã‚ºã®å…¥ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã•ã›ã‚‹ã¨ï¼Œãƒã‚¤ã‚ºã«ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ãƒˆãƒ«ãŒå·¦å³ã•ã‚Œã¦ã—ã¾ã†ãŸã‚ï¼Œåˆ†é¡ãŒã†ã¾ãã„ã‹ãªããªã£ã¦ã—ã¾ã†ï¼ãã“ã§ï¼Œã‚½ãƒ•ãƒˆãƒãƒ¼ã‚¸ãƒ³ã¨ã„ã†è€ƒãˆæ–¹ãŒä¸€èˆ¬ã«çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹ï¼åå¯¾ã«ï¼Œã“ã‚Œã¾ã§èª¬æ˜ã—ã¦ããŸSVMã®ãƒãƒ¼ã‚¸ãƒ³ã®æ±ºã‚æ–¹ã¯ï¼Œãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚¸ãƒ³ã¨å‘¼ã°ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;h2 id=&quot;svmã‚’å®Ÿç”¨ã™ã‚‹&quot;&gt;SVMã‚’å®Ÿç”¨ã™ã‚‹&lt;/h2&gt;

&lt;p&gt;ä»Šå›ã¯é‡ãŒå¤šããªã£ã¦ã—ã¾ã£ãŸã®ã§ç†è«–ã ã‘ã«ç•™ã‚ã¦ãŠãã¾ã™ãŒï¼ŒPythonã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ï¼Œscikit-learnã«ã¯SVMãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ï¼ã“ã‚Œã‚’ä½¿ãˆã°ã²ã¨ã¾ãšã¯å®Ÿãƒ‡ãƒ¼ã‚¿ã§åˆ†é¡ãŒã§ãã‚‹ã§ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§ï¼š&lt;a href=&quot;https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html&quot;&gt;scikit-learnã«ãŠã‘ã‚‹SVMã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;</content><author><name></name></author><category term="æ©Ÿæ¢°å­¦ç¿’å…¨èˆ¬" /><summary type="html">ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ï¼ˆSVMï¼‰ã¯ï¼Œæ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‰ãªã„æ©Ÿæ¢°å­¦ç¿’ã®æ‰‹æ³•ã®ä¸€ã¤ã¨ã—ã¦åºƒãçŸ¥ã‚‰ã‚Œã¦ãŠã‚Šï¼Œã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã«é–¢ã™ã‚‹äº‹å‰çŸ¥è­˜ãŒå…¨ãç„¡ã„ã‚ˆã†ãªå ´åˆã«æœ‰åŠ¹ãªæ‰‹æ³•ã¨è¨€ã‚ã‚Œã¦ã„ã¾ã™ï¼</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/resources/2019-06-23/svm_example.png" /></entry><entry xml:lang="ja_JP"><title type="html">torchtextã§k-åˆ†å‰²äº¤å·®æ¤œè¨¼ã‚’ã™ã‚‹è©±</title><link href="http://localhost:4000/cv-with-torchtext/" rel="alternate" type="text/html" title="torchtextã§k-åˆ†å‰²äº¤å·®æ¤œè¨¼ã‚’ã™ã‚‹è©±" /><published>2019-06-09T00:00:00+09:00</published><updated>2019-06-09T00:00:00+09:00</updated><id>http://localhost:4000/cv-with-torchtext</id><content type="html" xml:base="http://localhost:4000/cv-with-torchtext/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/pytorch/text&quot;&gt;torchtext&lt;/a&gt;ã¯ï¼ŒPyTorchã§è‡ªç„¶è¨€èªå‡¦ç†ï¼ˆNLPï¼‰ç³»ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¯”è¼ƒçš„ç°¡å˜ã«èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æœ‰åã§ã™ï¼ã—ã‹ã—ï¼Œã¨ã£ã¤ãã‚„ã™ã„æ€§è³ªã‚’æŒã¤åˆ†ï¼Œç´°ã‹ã„ã¨ã“ã‚ã§è‹¦æˆ¦ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ãã®ä¸€ä¾‹ã¨ã—ã¦ï¼Œäº¤å·®æ¤œè¨¼ã‚’ã‚„ã‚Šã«ãã„ã¨ã„ã†ç‚¹ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;æ­£ç¢ºã«ã¯ï¼Œtorchtextã§å‡¦ç†ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦äº¤å·®æ¤œè¨¼ã‚’ã—ãŸä¾‹ãŒãƒãƒƒãƒˆä¸Šã«å°‘ãªã„ã“ã¨ã«åŠ ãˆï¼Œtorchtextã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ãã‚Œã«é–¢ã™ã‚‹è¨˜è¿°ãŒãªã„ã“ã¨ã‚‚ç½ã„ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;é€šå¸¸ãªã‚‰ï¼Œtorchtextã§äº¤å·®æ¤œè¨¼ã‚’ã™ã‚‹ã®ã¯è«¦ã‚ã¦ï¼Œ&lt;a href=&quot;https://github.com/skorch-dev/skorch&quot;&gt;skorch&lt;/a&gt;ãªã©ã®ä»–ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã¨æ€ã„ã¾ã™ãŒï¼Œã“ã“ã§ã¯ã‚ãˆã¦ã€Œtorchtextã€ã¨ã€Œsklearnã€ã® &lt;code class=&quot;highlighter-rouge&quot;&gt;KFold&lt;/code&gt; ã‚’ä½¿ã†ã“ã¨ã§äº¤å·®æ¤œè¨¼ã‚’é©ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://towardsdatascience.com/use-torchtext-to-load-nlp-datasets-part-ii-f146c8b9a496&quot;&gt;Use torchtext to Load NLP Datasetsâ€Šâ€”â€ŠPart II&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;1-ã‚¿ã‚¹ã‚¯è¨­å®š&quot;&gt;1. ã‚¿ã‚¹ã‚¯è¨­å®š&lt;/h2&gt;
&lt;p&gt;æ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼æ–‡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã‚ã‚‹ï¼ŒIMDBãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ãŸãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ»ãƒã‚¸ãƒ†ã‚£ãƒ–ã®2å€¤åˆ†é¡ã‚¿ã‚¹ã‚¯ã‚’è§£ããƒ¢ãƒ‡ãƒ«ã‚’ï¼Œkåˆ†å‰²äº¤å·®æ¤œè¨¼ã«ã‹ã‘ã¦ã¿ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ãƒ™ãƒ¼ã‚¹ã«ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã¯ï¼ŒGRUã¨Self-Attentionã§æ§‹æˆã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã§ã™ï¼ã“ã®å®Ÿè£…ã¯ï¼Œ&lt;a href=&quot;https://github.com/gucci-j/imdb-classification-gru&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å…¬é–‹ã—ã¦ã‚ã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;h2 id=&quot;2-å®Ÿè£…&quot;&gt;2. å®Ÿè£…&lt;/h2&gt;
&lt;p&gt;ãã‚Œã§ã¯ï¼Œtorchtextã§èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿ã‚’äº¤å·®æ¤œè¨¼ã«ã‹ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;h3 id=&quot;21-ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€å´&quot;&gt;2.1 ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€å´&lt;/h3&gt;
&lt;h4 id=&quot;211-åˆæœŸè¨­å®š--ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿&quot;&gt;2.1.1 åˆæœŸè¨­å®š ï¼† ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿&lt;/h4&gt;

&lt;p&gt;ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å†…ã§ã¯ï¼Œé€šå¸¸ã®torchtextã®ç”¨æ³•ã¨åŒã˜ãï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;datasets.IMDB.splits()&lt;/code&gt; ã§IMDBãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;è¿”ã‚Šå€¤ã¯ï¼Œself.train_data, self.test_data ã¨ã—ã¦ä¿æŒã—ã¦ãŠãã¾ã™ï¼&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torchtext&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KFold&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backends&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cudnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deterministic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Field&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'spacy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LabelField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datasets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IMDB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;212-å­¦ç¿’ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿&quot;&gt;2.1.2 å­¦ç¿’ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿&lt;/h4&gt;

&lt;p&gt;å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€éš›ã¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;get_fold_data()&lt;/code&gt; ã‚’ä½¿ã†ã‚ˆã†ã«ã—ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;scikit-learnã® &lt;code class=&quot;highlighter-rouge&quot;&gt;model_selection.KFold&lt;/code&gt; ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã†ã“ã¨ã§ï¼Œãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’äº¤å·®åˆ†å‰²ç”¨ã«åˆ†å‰²ã—ã¾ã™ï¼scikit-learnã‚’æ™®æ®µã‹ã‚‰ä½¿ã£ã¦ã„ã‚‹äººãªã‚‰ï¼ŒãŠãªã˜ã¿ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;KFold&lt;/code&gt; ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚ã‚‹ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;split&lt;/code&gt; ã¯ï¼Œå¼•æ•°ã«NumPyé…åˆ—ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã®ã§ï¼Œtorchtextã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯å‹ã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ï¼ãã“ã§ï¼Œãƒ‡ãƒ¼ã‚¿ã‚’NumPyé…åˆ—ã«å¤‰æ›ã—ã¦æ¸¡ã—ã¦ã‚ã’ã‚‹ã¨å‹ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãšã«å‹•ä½œã—ã¦ãã‚Œã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ã—ã‹ã—ãªãŒã‚‰ï¼Œç„¡ç†ã‚„ã‚ŠNumPyé…åˆ—ã«å¤‰æ›ã—ãŸã“ã¨ã«ã‚ˆã‚‹å¼Šå®³ã‚‚ç”Ÿã˜ã¾ã™ï¼ã¨ã„ã†ã®ã‚‚ï¼Œãã®ã¾ã¾ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;torchtext.data.Iterator&lt;/code&gt; ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã¨ï¼Œå†ã³å‹ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ï¼å­¦ç¿’ã‚’ãƒ©ã‚¯ã—ã¦å›ã™ãŸã‚ã«ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã¯æ¬²ã—ã„ã¨ã“ã‚ã§ã™ï¼&lt;/p&gt;

&lt;p&gt;ãã“ã§ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;torchtext.data.Dataset&lt;/code&gt; ã«NumPyé…åˆ—ã«å¤‰æ›ã•ã‚Œã¦ã—ã¾ã£ãŸå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¦ï¼Œã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ç”Ÿæˆã§ãã‚‹çŠ¶æ…‹ã«æˆ»ã—ã¦ã‚ã’ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ä»¥ä¸ŠãŒï¼Œå­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿éƒ¨åˆ†ã«ãªã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_fold_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Field&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'spacy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LabelField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'text'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'label'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KFold&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_splits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_folds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SEED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_data_arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;examples&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_index&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data_arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;213-ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿&quot;&gt;2.1.3 ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿&lt;/h4&gt;

&lt;p&gt;ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã¯ï¼ŒNumPyé…åˆ—ã«å¤‰æ›ã™ã‚‹å¿…è¦ã‚‚ãªã„ã®ã§ï¼Œãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã‚‰ï¼Œãã®ã¾ã¾ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã—ã¦ã‚ã’ã‚‹ã ã‘ã§å¤§ä¸ˆå¤«ã§ã™ï¼&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_test_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_data&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;22-å‘¼ã³å‡ºã—å´&quot;&gt;2.2 å‘¼ã³å‡ºã—å´&lt;/h3&gt;

&lt;p&gt;å‘¼ã³å‡ºã—å´ã¯åŸºæœ¬çš„ã«ã¯ï¼Œäº¤å·®æ¤œè¨¼ç„¡ã—ã®&lt;a href=&quot;https://github.com/gucci-j/imdb-classification-gru&quot;&gt;ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«&lt;/a&gt;ã¨åŒã˜ã§ã™ï¼&lt;/p&gt;

&lt;p&gt;è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ç‚¹ã¨ã—ã¦ã¯ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;data.Iterator&lt;/code&gt; ã§ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹ä½œæ¥­ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã™ï¼ã¾ãŸï¼Œå„foldã§ã®çµæœã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã«ï¼Œãƒªã‚¹ãƒˆ: &lt;code class=&quot;highlighter-rouge&quot;&gt;_history&lt;/code&gt; ã‚’ç”¨æ„ã—ã¦ã‚ã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ç´°ã‹ã„ç‚¹ã¯ï¼Œ&lt;a href=&quot;https://github.com/gucci-j/pytorch-imdb-cv&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å®Ÿè£…ã‚’å…¬é–‹ã—ã¦ã„ã‚‹ã®ã§ï¼Œãã¡ã‚‰ã‚’å‚ç…§ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ï¼&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;data_generator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_data&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_generator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_fold_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;25000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;glove.6B.300d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;LABEL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEXT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'embedding_dim'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hidden_dim'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'output_dim'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'num_layers'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'dropout'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BCEWithLogitsLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'gpu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'gpu_number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'gpu_number'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cuda'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'cpu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;train_iterator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'batch_size'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sort_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_iterator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'batch_size'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sort_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'epochs'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'| Epoch: {epoch+1:02} | Train Loss: {train_loss:.3f} | Train Acc: {train_acc*100:.2f}&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eval_run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_iterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Val. Loss: {val_loss:.3f} | Val. Acc: {val_acc*100:.2f}&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;% &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;|'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asarray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'LOSS: {loss}, ACC: {acc}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;

&lt;p&gt;ã‚„ã‚„é§†ã‘è¶³ã®è§£èª¬ã¨ãªã‚Šã¾ã—ãŸãŒï¼Œä¸€å›NumPyé…åˆ—ã«å¤‰æ›ã—ã¦ã‚ã’ã‚‹ã“ã¨ã§äº¤å·®æ¤œè¨¼ãŒå¯èƒ½ã«ãªã‚‹ã®ã§ï¼Œã©ã†ã—ã¦ã‚‚torchtextã§ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ãŸã„äººã«ã¯ä½¿ãˆã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã ã¨æ€ã„ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;å®Ÿéš›ã®ã¨ã“ã‚torchtextã®ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’è¦‹ã‚‹ã¨ï¼Œäº¤å·®æ¤œè¨¼ã«é–¢ã™ã‚‹issueãŒå‡ºã¦ã„ã‚‹ã®ã§ï¼Œã“ã®æ©Ÿèƒ½ã‚’è¨­ã‘ã¦æ¬²ã—ã„äººã¯ãã‚Œãªã‚Šã«ã„ã‚‹ã¿ãŸã„ã§ã™ã­ï¼ï¼ˆã§ã™ãŒï¼Œä»Šã®æ‰€ã¯ã“ã®æŠ•ç¨¿ã®ã‚ˆã†ãªå½¢ã§ç„¡ç†ã‚„ã‚Šå¯¾å‡¦ã™ã‚‹ã—ã‹ãªã„ã§ã—ã‚‡ã†â€¦ï¼‰&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ï¼Œ&lt;a href=&quot;https://github.com/gucci-j/pytorch-imdb-cv&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å…¬é–‹ã—ã¦ã„ã¾ã™ï¼&lt;/p&gt;</content><author><name></name></author><category term="Tips" /><category term="PyTorch" /><summary type="html">ã¯ã˜ã‚ã« torchtextã¯ï¼ŒPyTorchã§è‡ªç„¶è¨€èªå‡¦ç†ï¼ˆNLPï¼‰ç³»ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¯”è¼ƒçš„ç°¡å˜ã«èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æœ‰åã§ã™ï¼ã—ã‹ã—ï¼Œã¨ã£ã¤ãã‚„ã™ã„æ€§è³ªã‚’æŒã¤åˆ†ï¼Œç´°ã‹ã„ã¨ã“ã‚ã§è‹¦æˆ¦ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ãã®ä¸€ä¾‹ã¨ã—ã¦ï¼Œäº¤å·®æ¤œè¨¼ã‚’ã‚„ã‚Šã«ãã„ã¨ã„ã†ç‚¹ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ï¼</summary></entry><entry xml:lang="ja_JP"><title type="html">è«–æ–‡ãƒ¡ãƒ¢ï¼šAttention Is All You Need</title><link href="http://localhost:4000/Note-Transformer/" rel="alternate" type="text/html" title="è«–æ–‡ãƒ¡ãƒ¢ï¼šAttention Is All You Need" /><published>2019-05-23T00:00:00+09:00</published><updated>2019-05-30T15:00:00+09:00</updated><id>http://localhost:4000/Note-Transformer</id><content type="html" xml:base="http://localhost:4000/Note-Transformer/">&lt;p&gt;GoogleãŒæ˜¨å¹´ç™ºè¡¨ã—ãŸï¼ŒBERTï¼šBidirectional Encoder Representation for Transformersã¯ï¼Œæ§˜ã€…ãªNLPã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦å½“æ™‚ã®æœ€é«˜ã‚¹ã‚³ã‚¢ã‚’è¨˜éŒ²ã—ï¼Œä¸–ç•Œä¸­ã§ç¬ãé–“ã«æ³¨ç›®ã‚’æµ´ã³ã‚‹ã“ã¨ã¨ãªã‚Šã¾ã—ãŸï¼çµæœã¨ã—ã¦ï¼ŒBERTã¯NAACL 2019ã®Best Long Paper Awardã«ã‚‚è¼ã„ã¦ã„ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ï¼Œãã‚“ãªBERTã®åŸºæœ¬æ§‹æˆè¦ç´ ã¨ãªã£ã¦ã„ã‚‹ï¼ŒTransformerã«ã¤ã„ã¦ã®è«–æ–‡ãƒ¡ãƒ¢ã‚’å…±æœ‰ã—ã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ãªãŠï¼ŒBERTã‚’ç†è§£ã™ã‚‹ãŸã‚ã«Transformerã‚’é›°å›²æ°—ã§ã¤ã‹ã¿ãŸã„æ–¹ã¯ï¼Œ&lt;a href=&quot;#ã¾ã¨ã‚ã‚¹ãƒ©ã‚¤ãƒ‰&quot;&gt;æœ«å°¾ã®ã‚¹ãƒ©ã‚¤ãƒ‰&lt;/a&gt;ã‚’å‚ç…§ã™ã‚‹ã¨å‚è€ƒã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼&lt;/p&gt;

&lt;h2 id=&quot;æ–‡çŒ®æƒ…å ±&quot;&gt;æ–‡çŒ®æƒ…å ±&lt;/h2&gt;
&lt;p&gt;è‘—è€…: A. Vaswani et al.&lt;br /&gt;
æ‰€å±: Google Brain&lt;br /&gt;
å‡ºå…¸: &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;NeurIPS 2017&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ã©ã‚“ãªã‚‚ã®&quot;&gt;ã©ã‚“ãªã‚‚ã®ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Attentionã‚’ãƒ•ãƒ«ã«æ´»ç”¨ã—ãŸç³»åˆ—å¤‰æ›ãƒ¢ãƒ‡ãƒ«ã‚’ææ¡ˆã—ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒã™ã”ã„&quot;&gt;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒã™ã”ã„ï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;å†å¸°ã‚„ç•³ã¿è¾¼ã¿ã‚’ç”¨ã„ãªã„æ–°ã—ã„ç³»åˆ—å¤‰æ›ï¼ˆsequence transductionï¼‰ãƒ¢ãƒ‡ãƒ«ã‚’ææ¡ˆã—ãŸï¼&lt;br /&gt;
â†’ ä¸¦åˆ—å‡¦ç†ãŒå¯èƒ½ã¨ãªã‚Šï¼Œè¨ˆç®—ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã—ãŸã“ã¨ã§ï¼Œå­¦ç¿’æ™‚é–“ã‚’å¤§å¹…ã«æ¸›ã‚‰ã™ã“ã¨ãŒã§ããŸï¼&lt;br /&gt;
â†’ è‹±ç‹¬ãƒ»è‹±ä»ã®ç¿»è¨³ãƒ†ã‚¹ãƒˆã§å½“æ™‚ã®æœ€é«˜ã‚¹ã‚³ã‚¢: BLEUã‚’è¨˜éŒ²ã—ãŸï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“&quot;&gt;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“ï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã»ã¼Attentionï¼ˆæ³¨æ„æ©Ÿæ§‹ï¼‰ã ã‘ã‚’ç”¨ã„ã¦ç³»åˆ—å¤‰æ›ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹ç‚¹&lt;br /&gt;
â†’ Scaled Dot-Product Attention&lt;br /&gt;
â†’ Multi-Head Attention&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ™‚ç³»åˆ—ã‚’è€ƒæ…®ã™ã‚‹ãŸã‚ã«ï¼Œä½ç½®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆpositional encodingï¼‰ã‚’å°å…¥ã—ã¦ã„ã‚‹ç‚¹&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸ&quot;&gt;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;ä¸»ã«BLEUã‚¹ã‚³ã‚¢ã¨ãƒ‘ãƒ¼ãƒ—ãƒ¬ã‚­ã‚·ãƒ†ã‚£&lt;/li&gt;
  &lt;li&gt;æ§‹æ–‡è§£æã®ã‚¹ã‚³ã‚¢&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;inner_ads&quot;&gt;
    &lt;div class=&quot;left_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022749.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt; 
    &lt;div class=&quot;right_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502952&amp;amp;p_id=1386&amp;amp;pc_id=2364&amp;amp;pl_id=20737&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0598/000000020737.png&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502952&amp;amp;p_id=1386&amp;amp;pc_id=2364&amp;amp;pl_id=20737&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;è«–æ–‡ã®ä¸»å¼µ&quot;&gt;è«–æ–‡ã®ä¸»å¼µ&lt;/h2&gt;
&lt;p&gt;è¿‘å¹´ã®ç³»åˆ—å¤‰æ›ãƒ¢ãƒ‡ãƒ«ã¯ï¼Œå†å¸°ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã‚„ç•³è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã«å¤§ããä¾å­˜ã—ã¦ã„ã‚‹ï¼ã¾ãŸï¼ŒSoTAã‚’é”æˆã™ã‚‹ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã§ã‚ã£ã¦ã‚‚ï¼Œæ³¨æ„æ©Ÿæ§‹ã‚’å–ã‚Šå…¥ã‚ŒãŸå†å¸° or CNNã®ãƒ¢ãƒ‡ãƒ«ã«ä¾å­˜ã—ã¦ãŠã‚Šï¼Œãƒ¢ãƒ‡ãƒ«ãŒè¤‡é›‘ã«ãªã£ã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;ã“ã®è«–æ–‡ã§ã¯ï¼Œ&lt;strong&gt;Transformer&lt;/strong&gt;ã¨å‘¼ã°ã‚Œã‚‹ï¼Œæ³¨æ„æ©Ÿæ§‹ã«ã ã‘åŸºã¥ãã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¢ãƒ‡ãƒ«ã‚’ææ¡ˆã—ã¦ã„ã‚‹ï¼Transformerã¯å†å¸°ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã‚„ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã‚’å¿…è¦ã¨ã—ãªã„ãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;å®Ÿé¨“çµæœã§ã¯ï¼Œç¿»è¨³ã‚¿ã‚¹ã‚¯ã«ã¤ã„ã¦state-of-the-artã‚’é”æˆã—ï¼Œã‹ã¤ãã®ä¸¦åˆ—æ¼”ç®—èƒ½åŠ›ã®é«˜ã•ã‚„ï¼Œå­¦ç¿’æ™‚é–“ã®ä½æ¸›ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒæŒ™ã’ã‚‰ã‚ŒãŸï¼ã¾ãŸï¼Œç¿»è¨³ã‚¿ã‚¹ã‚¯ä»¥å¤–ã®NLPã‚¿ã‚¹ã‚¯ã¸ã®æœ‰ç”¨æ€§ã‚‚ç¤ºå”†ã•ã‚ŒãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;å¾“æ¥æ‰‹æ³•&quot;&gt;å¾“æ¥æ‰‹æ³•&lt;/h2&gt;
&lt;p&gt;æ™‚ç³»åˆ—ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ãŠã‘ã‚‹å†å¸°ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆ &amp;amp; ç•³ã¿è¾¼ã¿ã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ï¼Œã“ã‚Œã¾ã§å¤šãæ´»ç”¨ã•ã‚Œã¦ããŸï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;å†å¸°ã‚’ä¼´ã†ãƒ¢ãƒ‡ãƒ«ã¯å®Ÿè¡Œæ™‚é–“ã«ã‹ãªã‚Šã®å½±éŸ¿ã‚’åŠã¼ã™ï¼&lt;br /&gt;
â†’ å†å¸°ã«ã‚ˆã£ã¦ä¸¦åˆ—è¨ˆç®—ãŒå¦¨ã’ã‚‰ã‚Œã‚‹ãŸã‚ï¼&lt;br /&gt;
â†’ factorization trickã‚„conditional computationã¨ã„ã£ãŸæ‰‹æ³•ãŒè€ƒæ¡ˆã•ã‚Œã¦ããŸï¼
    &lt;ul&gt;
      &lt;li&gt;ã“ã†ã—ãŸæ‰‹æ³•ã¯ç›´æ¥çš„ã«æ™‚ç³»åˆ—ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã‚‚ã®ã§ã¯ãªã„ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ç•³ã¿è¾¼ã¿ã‚’ä¼´ã†ãƒ¢ãƒ‡ãƒ«ã¯å†å¸°ã‚ˆã‚Šã‚‚å®Ÿè¡Œæ™‚é–“ã«å½±éŸ¿ã¯åŠã¼ã•ãªã„ï¼
    &lt;ul&gt;
      &lt;li&gt;ã—ã‹ã—ï¼Œå…¥å‡ºåŠ›ã®ä¾å­˜é–¢ä¿‚ã‚’è¨ˆç®—ã™ã‚‹éš›ã«ï¼Œãã®ç¯„å›²ãŒå¤§ãããªã‚Œã°ãªã‚‹ã»ã©ï¼Œè¨ˆç®—é‡ãŒå¯¾æ•°ã¾ãŸã¯ï¼Œç·šå½¢ã«å¢—åŠ ã—ã¦ã—ã¾ã†ã¨ã„ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;æ³¨æ„æ©Ÿæ§‹ã¯æ™‚ç³»åˆ—ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ãŠã„ã¦åºƒãç”¨ã„ã‚‰ã‚Œã¦ããŸï¼&lt;br /&gt;
â†’ æ³¨æ„æ©Ÿæ§‹ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ï¼Œä¾å­˜é–¢ä¿‚ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ãŒå¯èƒ½ã¨ãªã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ææ¡ˆæ‰‹æ³•ã®å…ˆè¡Œç ”ç©¶ã¨ã®é•ã„&quot;&gt;ææ¡ˆæ‰‹æ³•ã®å…ˆè¡Œç ”ç©¶ã¨ã®é•ã„&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;æ–°ãŸã«æå”±ã™ã‚‹Transformerã¯ï¼ŒAttentionã ã‘ã‚’æ´»ç”¨ã—ï¼Œå†å¸°ã¯ä¸€åˆ‡ä¼´ã‚ãªã„ï¼&lt;br /&gt;
â†’ AttentionãŒå…¥åŠ›ã¨å‡ºåŠ›é–“ã®å¤§åŸŸçš„ãªä¾å­˜é–¢ä¿‚ã‚’æŠ½å‡ºã§ãã‚‹ï¼&lt;br /&gt;
â†’ ä¸¦åˆ—è¨ˆç®—ãŒå¯èƒ½ã¨ãªã‚Šï¼Œè¨ˆç®—ã®é«˜é€ŸåŒ–ãŒå›³ã‚‰ã‚Œã‚‹ï¼&lt;br /&gt;
â†’ ç¿»è¨³ã®è³ªã®è¦³ç‚¹ã«ãŠã„ã¦ã‚‚ï¼ŒSoTAã‚’é”æˆã™ã‚‹ã“ã¨ãŒã§ããŸï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;attentionã«ã¤ã„ã¦&quot;&gt;Attentionã«ã¤ã„ã¦&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Attentionã®ç®—å‡ºæ–¹æ³•ã«ã¯æ¬¡ã®äºŒã¤ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ï¼
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;Additive Attention: åŠ æ³•æ³¨æ„æ©Ÿæ§‹
  éš ã‚Œå±¤ãŒä¸€ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ã¦Attentionã‚’è¨ˆç®—ã™ã‚‹ï¼&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;Dot-product Attention: å†…ç©æ³¨æ„æ©Ÿæ§‹
  è«–æ–‡ä¸­ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹Attentionã§ã‚ã‚‹ï¼è¡Œåˆ—ã‚’ç”¨ã„ã¦AttentionãŒè¨ˆç®—ã§ãã‚‹ãŸã‚ï¼Œé«˜é€Ÿæ€§ãƒ»çœãƒ¡ãƒ¢ãƒªæ€§ã«å„ªã‚Œã¦ã„ã‚‹ï¼&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;self-attention: è‡ªå·±æ³¨æ„æ©Ÿæ§‹&lt;br /&gt;
å˜ä¸€ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«å¯¾ã—ã¦attentionã‚’é©ç”¨ã™ã‚‹æ‰‹æ³•ã®ã“ã¨ï¼Encoder-Decoderãƒ¢ãƒ‡ãƒ«ã§ç”¨ã„ã‚‰ã‚Œã‚‹attentionã¨ã¯ç•°ãªã‚‹ï¼&lt;br /&gt;
â†’ å…¥åŠ›æ–‡ã®ç‰¹å¾´é‡ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã‚‹ï¼&lt;br /&gt;
â†’ Transformerã§ä½¿ã‚ã‚Œã‚‹Attetionã¯Self-attentionï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ææ¡ˆæ‰‹æ³•&quot;&gt;ææ¡ˆæ‰‹æ³•&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;ãƒ¢ãƒ‡ãƒ«ã¯åŸºæœ¬çš„ãªç³»åˆ—å¤‰æ›ãƒ¢ãƒ‡ãƒ«ã®æ çµ„ã¿ã«åŸºã¥ãï¼&lt;br /&gt;
â†’ ã¤ã¾ã‚Šï¼Œå„æ™‚åˆ»ã«ãŠã„ã¦ï¼Œãƒ¢ãƒ‡ãƒ«ã¯è‡ªå·±å›å¸°ã‚’è¡Œã†ï¼
    &lt;ul&gt;
      &lt;li&gt;ã“ã“ã§ã®è‡ªå·±å›å¸°ã¯ï¼Œæ¬¡ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ï¼Œå‰ã«ç”Ÿæˆã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ ã®å…¥åŠ›ã¨ã—ã¦ç”¨ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã‚ã‚‹ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ãƒ¢ãƒ‡ãƒ«ã¯ï¼Œã‚¹ã‚¿ãƒƒã‚¯å‹è‡ªå·±æ³¨æ„ã¨å…¨çµåˆå±¤ï¼ˆpoint-wiseï¼‰ã‹ã‚‰ãªã‚‹ï¼&lt;br /&gt;
â†’ ä»¥ä¸‹ã®å›³ãŒãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦å›³ã«ãªã£ã¦ã„ã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-23/model.png&quot; alt=&quot;Transformerãƒ¢ãƒ‡ãƒ«å›³&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;https://arxiv.org/abs/1706.03762&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;1-ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã‚¹ã‚¿ãƒƒã‚¯&quot;&gt;1. ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã‚¹ã‚¿ãƒƒã‚¯&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã‚¹ã‚¿ãƒƒã‚¯å‹ã¨ãªã£ã¦ãŠã‚Šï¼Œ6å€‹ã®ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ï¼&lt;br /&gt;
â†’ ã“ã®6ã¯ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;ãƒ–ãƒ­ãƒƒã‚¯å†…ã§ã®å‡¦ç†ã®æµã‚Œï¼ˆé †æ–¹å‘ï¼‰
    &lt;ol&gt;
      &lt;li&gt;multi-head self-attentionã‚’é©ç”¨ã™ã‚‹ï¼&lt;/li&gt;
      &lt;li&gt;æ®‹å·®æ¥ç¶šã®ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆã¤ã¾ã‚Šå…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã¨1ã®å‡ºåŠ›ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¶³ã—åˆã‚ã›ã¦ï¼Œå±¤æ­£è¦åŒ–ã‚’è¡Œã†ï¼&lt;/li&gt;
      &lt;li&gt;ä½ç½®ã”ã¨ã®å…¨çµåˆã‚’é©ç”¨ã™ã‚‹ï¼&lt;/li&gt;
      &lt;li&gt;æ®‹å·®æ¥ç¶šã®ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆã¤ã¾ã‚Š2ã®å‡ºåŠ›ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã¨3ã®å‡ºåŠ›ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¶³ã—åˆã‚ã›ã¦ï¼Œå±¤æ­£è¦åŒ–ã‚’è¡Œã†ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;å„å±¤ã®æ¬¡å…ƒã¯512ã§çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹ï¼&lt;/li&gt;
  &lt;li&gt;æ®‹å·®æ¥ç¶šã¯å˜ã«å‹¾é…æ¶ˆå¤±ã‚’é˜²ã„ã§å­¦ç¿’ã‚’ã†ã¾ãé€²ã‚ã‚‹ãŸã‚ã¨æ€ã‚ã‚Œã‚‹ï¼&lt;/li&gt;
  &lt;li&gt;å±¤æ­£è¦åŒ–ã¯å­¦ç¿’æ™‚é–“ã®è»½æ¸›&amp;amp;å­¦ç¿’ã®å®‰å®šåŒ–ã«å¯„ä¸ã™ã‚‹ï¼&lt;/li&gt;
  &lt;li&gt;BERTã¯ã“ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€éƒ¨åˆ†ã‚’æ´»ç”¨ã—ã¦ã„ã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://arxiv.org/abs/1607.06450&quot;&gt;ï¼ˆå±¤æ­£è¦åŒ–ã®è«–æ–‡ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;2-ãƒ‡ã‚³ãƒ¼ãƒ€ã‚¹ã‚¿ãƒƒã‚¯&quot;&gt;2. ãƒ‡ã‚³ãƒ¼ãƒ€ã‚¹ã‚¿ãƒƒã‚¯&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ‡ã‚³ãƒ¼ãƒ€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚‚6å€‹ã®ç‹¬ç«‹ã—ãŸã‚¹ã‚¿ãƒƒã‚¯ãƒ–ãƒ­ãƒƒã‚¯ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã‚ã‚‹2å±¤ã«åŠ ãˆã¦ï¼Œã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã®å‡ºåŠ›ã‚’æ´»ç”¨ã—ãŸmulti-head attentionã‚’è¿½åŠ ã—ã¦ã„ã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Self-attentionã«é–¢ã—ã¦ã¯ï¼Œæœªæ¥ã®å…¥åŠ›ã‚’è€ƒæ…®ã™ã‚‹ã“ã¨ãŒãªã„ã‚ˆã†ã«ï¼Œãƒã‚¹ã‚¯ä»˜ãã«æ”¹è‰¯ã—ã¦ã„ã‚‹ï¼&lt;br /&gt;
â†’ äºˆæ¸¬å¯¾è±¡ã®å˜èªã®æƒ…å ±ãŒäº‹å‰ã«æ¼ã‚Œã‚‹ã®ã‚’é˜²ãç›®çš„&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;3-attention&quot;&gt;3. Attention&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Attentionã¯ã‚¯ã‚¨ãƒªã¨ã‚­ãƒ¼&amp;amp;ãƒãƒªãƒ¥ãƒ¼ã®çµ„ã‚’å‡ºåŠ›ãƒ™ã‚¯ãƒˆãƒ«ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚‚ã®ã¨æ‰ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ &lt;br /&gt;
â†’ å‡ºåŠ›ãƒ™ã‚¯ãƒˆãƒ«ã¯ãƒãƒªãƒ¥ãƒ¼ã®é‡ã¿ã¤ãç·šå½¢å’Œã§è¡¨ã•ã‚Œã‚‹ï¼&lt;br /&gt;
â†’ é‡ã¿ã¯ï¼Œã‚¯ã‚¨ãƒªã¨ã‚­ãƒ¼ã®å¤‰æ›é–¢æ•°ã‹ã‚‰ç®—å‡ºã•ã‚Œã‚‹.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;31-ã‚¹ã‚±ãƒ¼ãƒ«åŒ–å†…ç©æ³¨æ„&quot;&gt;3.1 ã‚¹ã‚±ãƒ¼ãƒ«åŒ–å†…ç©æ³¨æ„&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;è«–æ–‡å†…ã§ä½¿ç”¨ã•ã‚Œã‚‹attentionã¯åŸºæœ¬çš„ã«ï¼Œã‚¹ã‚±ãƒ¼ãƒ«åŒ–å†…ç©æ³¨æ„ï¼ˆScaled Dot-Product Attentionï¼‰ã‚’ç”¨ã„ã¦ã„ã‚‹ï¼&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å…¥åŠ›ã¯æ¬¡å…ƒ: $d_k$ã®ã‚¯ã‚¨ãƒªã¨ã‚­ãƒ¼ï¼Œæ¬¡å…ƒ: $d_v$ã®ãƒãƒªãƒ¥ãƒ¼ã‹ã‚‰ãªã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Attentionã®è¨ˆç®—æ‰‹é †ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹
    &lt;ol&gt;
      &lt;li&gt;ã‚ã‚‹ã‚¯ã‚¨ãƒªã«å¯¾ã—ã¦ï¼Œãã®ã‚¯ã‚¨ãƒªã¨&lt;strong&gt;å…¨ã¦&lt;/strong&gt;ã®ã‚­ãƒ¼ã®å†…ç©ã‚’æ±‚ã‚ã‚‹ï¼&lt;/li&gt;
      &lt;li&gt;$\sqrt{d_k}$ã§é™¤ç®—ã™ã‚‹ï¼ï¼ˆã‚¹ã‚±ãƒ¼ãƒ«åŒ–ï¼‰&lt;/li&gt;
      &lt;li&gt;ã‚½ãƒ•ãƒˆãƒãƒƒã‚¯ã‚¹ã«ã‹ã‘ã‚‹ã“ã¨ã§ï¼Œå„ãƒãƒªãƒ¥ãƒ¼ã®é‡ã¿ã‚’æ±‚ã‚ã‚‹ï¼&lt;/li&gt;
      &lt;li&gt;ãƒãƒªãƒ¥ãƒ¼ã¨é‡ã¿ã‚’æ›ã‘åˆã‚ã›ã‚‹ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;å®Ÿéš›ã«ã¯ï¼Œè¤‡æ•°ã®ã‚¯ã‚¨ãƒªã‚’åŒæ™‚ã«å‡¦ç†ã™ã‚‹ãŸã‚ï¼Œè¡Œåˆ—ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«æ±‚ã‚ã‚‰ã‚Œã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
{\rm Attention}(Q, K, V) = {\rm softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V
$$
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;$d_k$ ãŒå°ã•ã„ã¨ãã¯å†…ç©æ³¨æ„ã‚‚åŠ æ³•æ³¨æ„ã‚‚å®Ÿè¡Œæ™‚é–“ã«å¤‰ã‚ã‚Šã¯ãªã„ãŒï¼Œ$d_k$ ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ï¼ŒåŠ æ³•æ³¨æ„ã®æ–¹ãŒé«˜é€Ÿã«ãªã£ã¦ã—ã¾ã†ï¼&lt;br /&gt;
  â†’ å†…ç©ãŒå¤§ãããªã‚‹ã®ã§ï¼Œå‹¾é…ãŒæ¥µç«¯ã«å°ã•ããªã‚Šï¼Œå­¦ç¿’ãŒé€²ã¾ãªããªã‚‹ï¼&lt;br /&gt;
  â†’ ã“ã‚Œã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ï¼Œã‚¹ã‚±ãƒ¼ãƒ«åŒ–ã‚’è¡Œã†ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;32-multi-head-attention&quot;&gt;3.2 Multi-head attention&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;multi-head attentionã¯ï¼Œattentionã‚’è¤‡æ•°ã«åˆ†å‰²ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã™ã‚‹ï¼&lt;br /&gt;
â†’ ãƒ¢ãƒ‡ãƒ«ãŒç•°ãªã‚‹éƒ¨åˆ†ç©ºé–“ã‹ã‚‰ç•°ãªã‚‹æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã®ã«é•·ã‘ã¦ã„ã‚‹ï¼&lt;br /&gt;
â†’ ã„ã‚ã„ã‚ãªnã‚°ãƒ©ãƒ ã‚’å–ã‚‹ç›®çš„ã¨ä¸€ç·’ï¼&lt;br /&gt;
â†’ ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã¯CNNã§ãƒãƒ£ãƒ³ãƒãƒ«æ•°ã‚’å¢—ã‚„ã—ã¦ãƒ¢ãƒ‡ãƒ«ã®è¡¨ç¾åŠ›ã‚’é«˜ã‚ã‚‹ã“ã¨ã¨åŒã˜ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
{\rm MultiHead}(Q, K, V) = {\rm Concat}({\rm head_1}, \dots, {\rm head_h})W^O \\
{\rm head_i} = {\rm Attention}(QW_i^Q, KW_i^K, VW_i^V)
$$
&lt;/div&gt;

&lt;p&gt;ãŸã ã—ï¼Œ$W_i^Q, W_i^K \in \mathbb{R}^{d_{model} \times d_k}$, $W_i^V \in \mathbb{R}^{d_{model} \times d_v}$, $W^O \in \mathbb{R}^{hd_v \times d_{model}}$ ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;è«–æ–‡ä¸­ã§ã¯ï¼Œ$h = 8$, $d_k = d_v = d_{\rm model} / h = 64$ ãªã®ã§ï¼Œå„ãƒ˜ãƒƒãƒ‰ã®æ¬¡å…ƒãŒå°ã•ããªã‚‹ãŸã‚ï¼Œè¨ˆç®—é‡çš„ã«ã¯single-head attentionã¨ã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªããªã‚‹ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-23/attention_comparison.png&quot; alt=&quot;Attentionã®æ¯”è¼ƒ&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;https://arxiv.org/abs/1706.03762&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;33-transformerã«ãŠã‘ã‚‹attention&quot;&gt;3.3 Transformerã«ãŠã‘ã‚‹Attention&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ‡ã‚³ãƒ¼ãƒ€ã®ã€Œã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ»ãƒ‡ã‚³ãƒ¼ãƒ€ã€Attention&lt;br /&gt;
â†’ ã‚¯ã‚¨ãƒªã¯å‰ã®ãƒ‡ã‚³ãƒ¼ãƒ€ã®å‡ºåŠ›&lt;br /&gt;
â†’ ã‚­ãƒ¼ã¨ãƒãƒªãƒ¥ãƒ¼ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã®å‡ºåŠ›&lt;br /&gt;
ã¤ã¾ã‚Šï¼Œæ™®é€šã®ç³»åˆ—å¤‰æ›ãƒ¢ãƒ‡ãƒ«ã§ã®attentionã¨åŒæ§˜ã§ã‚ã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã®Attention&lt;br /&gt;
â†’ å˜ç´”ãªè‡ªå·±æ³¨æ„&lt;br /&gt;
â†’ ã‚¯ã‚¨ãƒªï¼Œã‚­ãƒ¼ï¼Œãƒãƒªãƒ¥ãƒ¼ã¨ã‚‚ã«å‰ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã®å‡ºåŠ›&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ‡ã‚³ãƒ¼ãƒ€ã®Attention&lt;br /&gt;
â†’ è‡ªåˆ†ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã¾ã§å‚ç…§ã§ãã‚‹è‡ªå·±æ³¨æ„&lt;br /&gt;
â†’ è‡ªå·±å›å¸°ãŒãã¡ã‚“ã¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚&lt;br /&gt;
â†’ å›³2ä¸­ã§ï¼Œã‚¹ã‚±ãƒ¼ãƒ«åŒ–å†…ç©æ³¨æ„ã®softmaxå‰ã«ï¼Œæœªæ¥ã®å…¥åŠ›ã«å¯¾å¿œã™ã‚‹éƒ¨åˆ†ã‚’ï¼Œ$-\infty$ã§ç½®ãæ›ãˆã‚‹ã“ã¨ã«ã‚ˆã‚Šï¼Œå®Ÿè£…ã—ãŸï¼&lt;br /&gt;
â†’ ${\rm softmax}(x_i)=\frac{\exp(x_i)}{\sum_j \exp (x_j)}$ã§ï¼Œ$x_i \to -\infty$ãªã‚‰ï¼Œãã®é …ã¯0ã«ãªã‚‹ã®ã§ï¼Œè€ƒæ…®ã•ã‚Œãªããªã‚‹ã¨ã„ã†ã“ã¨ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;4-ä½ç½®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°&quot;&gt;4. ä½ç½®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Transformerã¯ç•³ã¿è¾¼ã¿ã‚„å†å¸°ã‚’ä¼´ã‚ãªã„ã®ã§ï¼Œãã‚Œã ã‘ã§ã¯æ™‚ç³»åˆ—ã‚’è€ƒæ…®ã™ã‚‹ã“ã¨ãŒã§ããªã„ï¼&lt;br /&gt;
â†’ æ™‚ç³»åˆ—ã‚’è€ƒæ…®ã™ã‚‹ãŸã‚ã«ï¼Œå…¥åŠ›ã®åŸ‹ã‚è¾¼ã¿è¡¨ç¾ã«ã€Œä½ç½®æƒ…å ±ã€ã‚’åŸ‹ã‚è¾¼ã‚€ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
PE_{(pos, 2i + 1)} = \cos\left(\frac{pos}{10000^{\frac{2i}{d_{model}}}}\right)
$$
&lt;/div&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
PE_{(pos, 2i)} = \sin\left(\frac{pos}{10000^{\frac{2i}{d_{model}}}}\right)
$$
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-23/pe.png&quot; alt=&quot;Positional Encodingã‚’å¯è¦–åŒ–ã—ãŸå›³&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³ä½œæˆ: &lt;a href=&quot;https://github.com/gucci-j/pe-visualization&quot;&gt;https://github.com/gucci-j/pe-visualization&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;è©•ä¾¡æŒ‡æ¨™&quot;&gt;è©•ä¾¡æŒ‡æ¨™&lt;/h2&gt;
&lt;h3 id=&quot;bleu&quot;&gt;BLEU&lt;/h3&gt;
&lt;p&gt;Bilingual Evaluation Understudyã®ç•¥ï¼&lt;br /&gt;
ACL2002ã§ç™ºè¡¨ã•ã‚ŒãŸæ©Ÿæ¢°ç¿»è¨³ã®è‡ªå‹•è©•ä¾¡æŒ‡æ¨™ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;BLEUã‚¹ã‚³ã‚¢ã¯é«˜ã‘ã‚Œã°é«˜ã„ã»ã©ã‚ˆã„æŒ‡æ¨™ã¨ãªã£ã¦ã„ã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
{\rm BLEU} = {\rm BP} \exp{\left(\sum_{n=1}^N \frac{1}{N} \log P_n \right)}
$$
&lt;/div&gt;

&lt;h3 id=&quot;bpã¨ã¯&quot;&gt;BPã¨ã¯ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;BPã¨ã¯ï¼Œbrevity penaltyã®ç•¥ï¼brevityã¯è‹±èªã§ã€Œç°¡æ½”ã•ãƒ»çŸ­ã•ã€ã‚’æ„å‘³ã™ã‚‹ï¼&lt;br /&gt;
ã¤ã¾ã‚Šï¼Œç¿»è¨³ã•ã‚ŒãŸçµæœãŒçŸ­æ–‡ã§ã‚ã‚‹ã¨ï¼Œãã®æ–‡ã ã‘ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’å–°ã‚‰ã†ã¨ã„ã†ã“ã¨ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;p&gt;ä¿®æ­£Nã‚°ãƒ©ãƒ ã ã‘ã§ã¯ï¼Œç¿»è¨³æ–‡ãŒçŸ­ã„æ–‡ã®ã¨ãã«$P_n$ãŒé«˜ããªã£ã¦ã—ã¾ã†ãŸã‚ï¼Œã“ã®BPé …ã§ä½æ¸›ã•ã›ã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
{\rm BP} = \begin{cases}
    1 &amp;amp; {\rm if}\  c &amp;gt; r\\
    \exp{(1-r/c)} &amp;amp; {\rm if}\  c \leq r\\
    \end{cases}
$$
&lt;/div&gt;

&lt;p&gt;ãŸã ã—ï¼Œ$c$ã¯ç¿»è¨³ã•ã‚ŒãŸæ–‡ã®é•·ã•ã‚’æ„å‘³ã—ï¼Œ$r$ã¯æ­£è§£ã‚³ãƒ¼ãƒ‘ã‚¹ä¸­ã®å¯¾å¿œã™ã‚‹æ–‡ã®é•·ã•ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;ä¿®æ­£nã‚°ãƒ©ãƒ ç²¾åº¦ã¨ã¯&quot;&gt;ä¿®æ­£Nã‚°ãƒ©ãƒ ç²¾åº¦ã¨ã¯?&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;$\left(\sum_{n=1}^N \frac{1}{N} \log P_n \right)$ã«ãŠã„ã¦ï¼Œ
    &lt;ul&gt;
      &lt;li&gt;$N$ã¯Nã‚°ãƒ©ãƒ ã®æœ€å¤§é•·ï¼ˆè‹±èªã ã¨4ãŒå¤šã„ã‚‰ã—ã„ï¼‰&lt;/li&gt;
      &lt;li&gt;$P_n$ã¯Nã‚°ãƒ©ãƒ ç²¾åº¦ã‚’è¡¨ã—ã¦ã„ã‚‹ï¼&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Nã‚°ãƒ©ãƒ ç²¾åº¦ã¯ï¼Œç¿»è¨³æ–‡ã¨ã‚³ãƒ¼ãƒ‘ã‚¹ã®å‚ç…§æ–‡ãŒã©ã‚Œã ã‘ä¸€è‡´ã™ã‚‹ã‹ã‚’æ•°å€¤åŒ–ã—ãŸã‚‚ã®ã§ã‚ã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;è©³ã—ãã¯é•·ã£ãŸã‚‰ã—ããªã‚‹ã®ã§ï¼Œ&lt;a href=&quot;https://dl.acm.org/citation.cfm?id=1073135&quot;&gt;è«–æ–‡æœ¬ä½“&lt;/a&gt;ã‚’å‚ç…§ï¼&lt;/p&gt;

&lt;h2 id=&quot;å®Ÿé¨“è§£æçµæœ&quot;&gt;å®Ÿé¨“ãƒ»è§£æçµæœ&lt;/h2&gt;
&lt;h3 id=&quot;è¨ˆç®—ã‚³ã‚¹ãƒˆæ¯”è¼ƒ&quot;&gt;è¨ˆç®—ã‚³ã‚¹ãƒˆæ¯”è¼ƒ&lt;/h3&gt;

&lt;p&gt;é€šå¸¸ï¼Œã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®é•·ã• $n$ ã¯ï¼Œãƒ¢ãƒ‡ãƒ«ã®æ¬¡å…ƒ $d$ ã‚ˆã‚Šã‚‚å°ã•ã„ã“ã¨ãŒå¤šã„ã®ã§ï¼Œ $n &amp;lt; d$ ã§ï¼ŒSelf-Attentionã®è¨ˆç®—é‡ã‚³ã‚¹ãƒˆãŒæœ€ã‚‚å°ã•ããªã‚‹ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-23/table1.png&quot; alt=&quot;è¨ˆç®—ã‚³ã‚¹ãƒˆæ¯”è¼ƒè¡¨&quot; style=&quot;width: 700px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;https://arxiv.org/abs/1706.03762&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;complexity-per-layer&quot;&gt;Complexity per layer&lt;/h4&gt;
&lt;p&gt;1å±¤ã‚ãŸã‚Šã®è¨ˆç®—é‡ã‚’æ„å‘³ã™ã‚‹ï¼&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Self-Attentionã®å ´åˆ&lt;br /&gt;
Self-Attentionã®é‡ã¿ç®—å‡ºå¼ã¯ï¼Œ${\rm softmax}(QK^{T}) V$ ã§ã‚ã‚‹ï¼&lt;/p&gt;

    &lt;p&gt;åˆ†è§£ã—ã¦è€ƒãˆã¦ã„ãã¨ï¼Œã¾ãšï¼Œ$QK^{T}$ ã¯ï¼Œ$(n \times d)$ ã¨ $(d \times n)$ ã®è¡Œåˆ—ã®ç©ã§ã‚ã‚‹ã‹ã‚‰ï¼Œ$O(n^2d)$ ã§ã‚ã‚‹ï¼ç¶šã„ã¦ï¼Œ${\rm softmax}$ ã®è¨ˆç®—é‡ã¯ï¼Œã²ã¨ã¤ã®è¦ç´ ã‚’è¨ˆç®—ã™ã‚‹ã®ã«ï¼Œ$O(n)$ ã‹ã‹ã‚‹ã®ã§ï¼Œ$n$ å€‹ã®è¦ç´ ã‚’è€ƒãˆã‚‹ã¨ $O(n) \times n$ ã§ï¼Œ$O(n^2)$ ã§ã‚ã‚‹ï¼æœ€å¾Œã«ï¼Œ${\rm softmax}(QK^{T})$ ã¨ï¼Œ$V$ ã®è¡Œåˆ—ã®ç©ã¯ï¼Œ$QK^{T}$ ã¨åŒã˜ã $O(n^2d)$ ã¨ãªã‚‹ï¼&lt;/p&gt;

    &lt;p&gt;ã—ãŸãŒã£ã¦ï¼Œã“ã‚Œã‚‰ã‚’åˆè¨ˆã™ã‚‹ã¨ï¼Œ$O(n^2d) + O(n^2) + O(n^2d)$ ã§ã‚ã‚Šï¼Œ$O(n^2d)$ ã¨ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ã‚†ãˆã«ï¼ŒSelf-Attentionã®å±¤ã‚ãŸã‚Šã®è¨ˆç®—é‡ã¯ï¼Œ$O(n^2d)$ ã¨ãªã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Recurrentã®å ´åˆ&lt;br /&gt;
Recurrentã®æ™‚åˆ» $t$ ã«ãŠã‘ã‚‹éš ã‚Œå±¤ã®é‡ã¿ç®—å‡ºå¼ã¯ï¼Œ$\mathbf{h_t} = \tanh \left(\mathbf{h_{t-1}} W + \mathbf{x_t} U + \mathbf{b} \right)$ ã¨è¡¨ã›ã‚‹ï¼ãªãŠï¼Œæ´»æ€§åŒ–é–¢æ•°ã¯ $\tanh$ ã«é™ã‚‰ãšï¼Œã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã®ã¨ãã‚‚ã‚ã‚‹ï¼ã„ãšã‚Œã«ã›ã‚ˆï¼Œã©ã¡ã‚‰ã®æ‰‹æ³•ã‚‚å®šæ•°æ™‚é–“ã§å‡¦ç†ã§ãã‚‹ã®ã§ï¼Œã“ã“ã§ã¯ $\tanh$ ã‚’æ´»æ€§åŒ–é–¢æ•°ã¨ã—ã¦ä½¿ã†ï¼&lt;/p&gt;

    &lt;p&gt;Self-Attentionã¨åŒæ§˜ã«ï¼Œåˆ†è§£ã—ã¦è€ƒãˆã¦ã„ãã¨ï¼Œã¾ãšï¼Œ$\mathbf{h_{t-1}} W$ ã¯ï¼Œ$(1 \times d)$ ã¨ $(d \times d)$ ã®è¡Œåˆ—ç©ã§ã‚ã‚‹ã‹ã‚‰ï¼Œ$O(d^2)$ ã§ã‚ã‚‹ï¼ç¶šã„ã¦ï¼Œ$\mathbf{x_t} U$ ã¯ï¼Œ$(1 \times d)$ ã¨ $(d \times d)$ ã®è¡Œåˆ—ç©ã§ã‚ã‚‹ã®ã§ï¼Œ$O(d^2)$ ã§ã‚ã‚‹ï¼ã¾ãŸï¼Œè¡Œåˆ—å’Œã«ã¤ã„ã¦ã¯ï¼Œã‚µã‚¤ã‚ºãŒ $(1 \times d)$ åŒå£«ã®å’Œã§ã‚ã‚‹ã®ã§ï¼Œ$O(d)$ ã§ã‚ã‚‹ï¼æœ€å¾Œã«ï¼Œ$\tanh (x) = \frac{\exp(x) - \exp(-x)}{\exp(x) + \exp(-x)}$ ã®è¨ˆç®—é‡ã¯ï¼Œ$d$ å€‹ã®è¦ç´ ã«å¯¾ã—ã¦é©ç”¨ã™ã‚‹ã®ã§ï¼Œ$O(d)$ã§ã‚ã‚‹ï¼&lt;/p&gt;

    &lt;p&gt;ã—ãŸãŒã£ã¦ï¼Œæ™‚åˆ» $t$ã«ãŠã‘ã‚‹è¨ˆç®—é‡ã¯ï¼Œ$O(d^2) + O(d^2) + O(d) + O(d)$ ã§ï¼Œ$O(d^2)$ ã¨ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ï¼å…¥åŠ›ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®é•·ã•ã¯ï¼Œ$n$ ã§ã‚ã‚‹ã‹ã‚‰ï¼Œå±¤ã‚ãŸã‚Šã®è¨ˆç®—é‡ã¯ $O(d^2) \times n$ ã§ï¼Œ $O(nd^2)$ ã¨ãªã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;Convolutionã«ã¤ã„ã¦ã¯ã©ã†ã‚„ã£ã¦ç®—å‡ºã—ãŸã®ã‹ä¸æ˜ï¼ä½•ã‹æƒ…å ±ãŒã‚ã‚Œã°ã”æ•™ç¤ºãã ã•ã„ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;sequential-operations&quot;&gt;Sequential Operations&lt;/h4&gt;
&lt;p&gt;é€æ¬¡å‡¦ç†ã‚’æœ€å°é™ã«ã™ã‚‹ä¸¦åˆ—å‡¦ç†å¯èƒ½ãªè¨ˆç®—é‡ã®ã“ã¨ï¼Recurrentå±¤ã¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®é•·ã•ã ã‘ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ã®ã¯ç›´æ„Ÿçš„ã§ã‚ã‚‹ï¼&lt;/p&gt;

&lt;h4 id=&quot;maximum-path-length&quot;&gt;Maximum Path Length&lt;/h4&gt;
&lt;p&gt;ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®é•·è·é›¢ä¾å­˜é–¢ä¿‚é–“ã®çµŒè·¯é•·ã®ã“ã¨ï¼
Self-Attentionã¯å®šæ•°ã®ã‚³ã‚¹ãƒˆã§ï¼Œå…¥å‡ºåŠ›é–“ã®ä»»æ„ã®çµ„ã¿åˆã‚ã›ã®çµŒè·¯ã‚’ç¹‹ã’ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ä¸€æ–¹ã§ï¼Œå†å¸°ãŒ$O(n)$ã§ã‚ã‚Šï¼Œç•³ã¿è¾¼ã¿ãŒ$O(\log n)$ã§ã‚ã‚‹ã“ã¨ã¯ï¼Œç°¡å˜ã«Backgroundã§è§¦ã‚Œã‚‰ã‚Œã¦ã„ãŸæ°—ãŒã™ã‚‹ï¼&lt;/p&gt;

&lt;h3 id=&quot;ç¿»è¨³æ€§èƒ½æ¯”è¼ƒ&quot;&gt;ç¿»è¨³æ€§èƒ½æ¯”è¼ƒ&lt;/h3&gt;
&lt;p&gt;è¡¨ã‹ã‚‰ï¼ŒTransformerã¯é«˜ã„ç¿»è¨³ç²¾åº¦ã‚’å‡ºã—ã¤ã¤ï¼Œã‹ã¤è¨ˆç®—ã‚³ã‚¹ãƒˆã‚’å‰Šæ¸›ã§ãã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ï¼&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-23/table2.png&quot; alt=&quot;ç¿»è¨³ç²¾åº¦æ¯”è¼ƒè¡¨&quot; style=&quot;width: 700px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-image&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt; å›³å¼•ç”¨: &lt;a href=&quot;https://arxiv.org/abs/1706.03762&quot;&gt;https://arxiv.org/abs/1706.03762&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚ã‚¹ãƒ©ã‚¤ãƒ‰&quot;&gt;ã¾ã¨ã‚ã‚¹ãƒ©ã‚¤ãƒ‰&lt;/h2&gt;
&lt;div style=&quot;text-align: center&quot;&gt;&lt;iframe src=&quot;//www.slideshare.net/slideshow/embed_code/key/3zlzCmoC9icWLd&quot; width=&quot;510&quot; height=&quot;420&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&quot; allowfullscreen=&quot;&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;
&lt;div style=&quot;margin-bottom:5px&quot;&gt;&lt;/div&gt;

&lt;h2 id=&quot;å®Ÿè£…&quot;&gt;å®Ÿè£…&lt;/h2&gt;
&lt;p&gt;æ™‚ç³»åˆ—ã‚’è€ƒæ…®ã™ã‚‹ãŸã‚ã«ææ¡ˆã•ã‚ŒãŸæ‰‹æ³•ï¼šPositional Encodingï¼ˆä½ç½®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã‚’å¯è¦–åŒ–ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãã¾ã—ãŸï¼&lt;br /&gt;
&lt;a href=&quot;https://github.com/gucci-j/pe-visualization&quot;&gt;GitHub&lt;/a&gt; ã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ï¼ã”è‡ªç”±ã«ã”åˆ©ç”¨ãã ã•ã„ï¼&lt;/p&gt;</content><author><name></name></author><category term="è«–æ–‡ãƒ¡ãƒ¢" /><summary type="html">GoogleãŒæ˜¨å¹´ç™ºè¡¨ã—ãŸï¼ŒBERTï¼šBidirectional Encoder Representation for Transformersã¯ï¼Œæ§˜ã€…ãªNLPã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦å½“æ™‚ã®æœ€é«˜ã‚¹ã‚³ã‚¢ã‚’è¨˜éŒ²ã—ï¼Œä¸–ç•Œä¸­ã§ç¬ãé–“ã«æ³¨ç›®ã‚’æµ´ã³ã‚‹ã“ã¨ã¨ãªã‚Šã¾ã—ãŸï¼çµæœã¨ã—ã¦ï¼ŒBERTã¯NAACL 2019ã®Best Long Paper Awardã«ã‚‚è¼ã„ã¦ã„ã¾ã™ï¼</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/resources/2019-05-23/pe.png" /></entry><entry xml:lang="ja_JP"><title type="html">ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨ï¼‰</title><link href="http://localhost:4000/DL-Intro-5/" rel="alternate" type="text/html" title="ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨ï¼‰" /><published>2019-05-10T00:00:00+09:00</published><updated>2019-05-10T00:00:00+09:00</updated><id>http://localhost:4000/DL-Intro-5</id><content type="html" xml:base="http://localhost:4000/DL-Intro-5/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;
&lt;p&gt;ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã€æ·±å±¤å­¦ç¿’ã®å…¥é–€æ›¸ã¨ã—ã¦æœ‰åãªã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã¨åŒæ™‚ä¸¦è¡Œã§ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã—ã€ãã®å®šç€ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å‰å›ã¯ã€å­¦ç¿’ã«é–¢ã™ã‚‹æ§˜ã€…ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸã€‚ä»Šå›ã¯ã“ã‚Œã¾ã§ã®è©±é¡Œã¨ã¯å¤§ããå¤‰ã‚ã£ã¦ã€ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆCNNï¼‰ã«ã‚ˆã‚‹ç”»åƒåˆ†é¡ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚ã¾ãŸã€CNNã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®é‡ã¿å¯è¦–åŒ–ã‚„ã€å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®è»¢ç§»å­¦ç¿’ãƒ»æœ€è¿‘ã®CNNãƒ¢ãƒ‡ãƒ«ã§ä½¿ã‚ã‚Œã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã®ä¸€ç«¯ã«ã¤ã„ã¦ã‚‚ç´¹ä»‹ã—ã¾ã™ã€‚ãªãŠã€æœ¬ç¨¿ã¯ã‚¼ãƒ­ã‹ã‚‰ã€œã®ç¬¬7ç« ã«å¯¾å¿œã™ã‚‹å†…å®¹ã¨ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®ç¬¬7ç« : P205ã€œP238&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;link_box&quot;&gt;
    &lt;span class=&quot;box-title&quot;&gt;ã‚·ãƒªãƒ¼ã‚ºãƒªãƒ³ã‚¯&lt;/span&gt;
    &lt;p&gt;ç¬¬ä¸€å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äºŒå¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-2/&quot;&gt;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &amp;amp; æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨&lt;/a&gt;&lt;/p&gt;  
    &lt;p&gt;ç¬¬ä¸‰å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-3/&quot;&gt;ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬å››å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-4/&quot;&gt;å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äº”å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-5/&quot;&gt;ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;1-cifar10-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&quot;&gt;1. CIFAR10 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&lt;/h2&gt;
&lt;p&gt;ä»Šå›å–ã‚Šçµ„ã‚€ã‚¿ã‚¹ã‚¯ã¯ã€CIFAR10ã¨å‘¼ã°ã‚Œã‚‹ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’CNNã§åˆ†é¡ã™ã‚‹ã“ã¨ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;CIFAR10ã¯ã€10å€‹ã®ã‚¯ãƒ©ã‚¹ã‚’æŒã¤ã‚«ãƒ©ãƒ¼ç”»åƒã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ãªã£ã¦ã„ã¦ã€MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨åŒæ§˜ã«Kerasã§ç°¡å˜ã«å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚CIFAR10ã®ç”»åƒã®ä¸€éƒ¨ã‚’è©¦ã—ã«è¡¨ç¤ºã•ã›ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.misc&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;toimage&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;toimage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'off'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-10/cifar10_example.png&quot; alt=&quot;CIFAR10ã®ç”»åƒä¸€ä¾‹&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;p&gt;å‡ºåŠ›çµæœã‹ã‚‰ã€å¤§å‹è‡ªå‹•è»Šã®ç”»åƒã‚„ã€å‹•ç‰©ã®ã‚ˆã†ãªç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/datasets/#cifar10&quot;&gt;ï¼ˆKerasã®CIFAR10ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;2-ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&quot;&gt;2. ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&lt;/h2&gt;
&lt;p&gt;ãã‚Œã§ã¯ã€CIFAR10ã‚’åˆ†é¡ã™ã‚‹ãŸã‚ã®CNNãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…ã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›å®Ÿè£…ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P229ã§æ‰±ã‚ã‚Œã¦ã„ã‚‹SimpleConvNetã«ä¼¼ãŸæ§‹æˆã¨ã—ã¾ã™ã€‚ã¾ãŸã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰åã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;cnn.py&lt;/code&gt;ã¨ã—ã¦é€²ã‚ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä¾‹ã«ã‚ˆã£ã¦ãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦å›³ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚å®Ÿè£…ã®éš›ã®å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚ãªãŠã€ã“ã®å›³ã¯è‡ªä½œã§ã¯ãªãã€GitHubã®@yu4uã•ã‚“ã‚‰ã«ã‚ˆã‚‹ã€Œ&lt;a href=&quot;https://github.com/yu4u/convnet-drawer&quot;&gt;convnet-drawer&lt;/a&gt;ã€ã«ã‚ˆã‚Šæç”»ã—ã¦ã„ã¾ã™ã€‚CNNã§ã‚ã‚Œã°ç°¡å˜ã«ä½œå›³ã§ãã‚‹ã®ã§ã€ãœã²ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-10/model_diagram.png&quot; alt=&quot;1å±¤CNNãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦å›³&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://github.com/oreilly-japan/deep-learning-from-scratch/blob/master/ch07/simple_convnet.py&quot;&gt;ï¼ˆSimpleConvNetã®å…¬å¼ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://github.com/yu4u/convnet-drawer&quot;&gt;ï¼ˆGitHub: convnet-drawerï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;21-ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®šç¾©&quot;&gt;2.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®šç¾©&lt;/h3&gt;
&lt;p&gt;ä»Šå›ä½¿ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æ–°ãŸã«ç™»å ´ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Conv2D&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;MaxPooling2D&lt;/code&gt;ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Flatten&lt;/code&gt;ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã§ãã‚Œãã‚Œè§£èª¬ã—ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;22-ç•³ã¿è¾¼ã¿å‡¦ç†&quot;&gt;2.2 ç•³ã¿è¾¼ã¿å‡¦ç†&lt;/h3&gt;
&lt;p&gt;ç•³ã¿è¾¼ã¿å‡¦ç†éƒ¨ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ãã®èª¬æ˜ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å…¥åŠ›éƒ¨&lt;br /&gt;
  CIFAR10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€32*32ã®ã‚«ãƒ©ãƒ¼ç”»åƒ: RGBã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚&lt;br /&gt;
  ã—ãŸãŒã£ã¦ã€å…¥åŠ›ã‚µã‚¤ã‚ºã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;(32, 32, 3)&lt;/code&gt;ã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ç•³ã¿è¾¼ã¿éƒ¨&lt;br /&gt;
  ç”»åƒã®ç•³ã¿è¾¼ã¿å‡¦ç†ã«ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Conv2D&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æ´»ç”¨ã—ã¾ã™ã€‚&lt;br /&gt;
  &lt;code class=&quot;highlighter-rouge&quot;&gt;Conv2D&lt;/code&gt;ã®ä¸»ãªå¼•æ•°ã®èª¬æ˜ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th style=&quot;text-align: center&quot;&gt;&lt;strong&gt;å¼•æ•°&lt;/strong&gt;&lt;/th&gt;
          &lt;th style=&quot;text-align: left&quot;&gt;&lt;strong&gt;èª¬æ˜&lt;/strong&gt;&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;filters&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&quot;text-align: left&quot;&gt;ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®å€‹æ•°ã‚’æŒ‡å®šã™ã‚‹ã€‚&lt;br /&gt;ã“ã“ã§æŒ‡å®šã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ãã‚Œãã‚Œç•°ãªã‚‹é‡ã¿ã‚„ãƒã‚¤ã‚¢ã‚¹ã‚’æŒã¤ã‚‚ã®ã§ã‚ã‚‹ã€‚&lt;br /&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;filter_num&lt;/code&gt;ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kernel_size&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&quot;text-align: left&quot;&gt;ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã™ã‚‹ã€‚&lt;br /&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;filter_size&lt;/code&gt;ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;strides&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&quot;text-align: left&quot;&gt;ã‚¹ãƒˆãƒ©ã‚¤ãƒ‰å¹…ã‚’æŒ‡å®šã™ã‚‹ã€‚&lt;br /&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;stride&lt;/code&gt;ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;padding&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&quot;text-align: left&quot;&gt;ã‚¼ãƒ­ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã®æœ‰ç„¡ã‚’æŒ‡å®šã™ã‚‹ã€‚&lt;br /&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'same'&lt;/code&gt;ã®ã¨ãã«ã¯ã€ã‚¼ãƒ­ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ãŒé©ç”¨ã•ã‚Œã€å…¥åŠ›ã‚µã‚¤ã‚ºã¨å‡ºåŠ›ã‚µã‚¤ã‚ºã¯åŒã˜ã«ãªã‚‹ã€‚&lt;code class=&quot;highlighter-rouge&quot;&gt;'valid'&lt;/code&gt;ã®ã¨ãã«ã¯ã€å‡ºåŠ›ã‚µã‚¤ã‚ºã¯å…¥åŠ›ã‚µã‚¤ã‚ºã‚ˆã‚Šã‚‚å°ã•ããªã‚‹ã€‚&lt;br /&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;pad&lt;/code&gt;ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã€‚&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;

    &lt;p&gt;ä»Šå›å®Ÿè£…ã™ã‚‹ç•³ã¿è¾¼ã¿å±¤ã¯ã€ã»ã¼ã‚¼ãƒ­ã‹ã‚‰ã€œã®è¨­å®šå€¤ã«åŸºã¥ãã®ã§ã€å„å€¤ã®è©³ç´°ãªèª¬æ˜ã¯çœãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ—ãƒ¼ãƒªãƒ³ã‚°éƒ¨&lt;br /&gt;
  Kerasã«ãŠã„ã¦ç”»åƒã®æœ€å¤§å€¤ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã®å‡¦ç†ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;MaxPooling2D&lt;/code&gt;ã§å®Ÿè£…ã§ãã¾ã™ã€‚&lt;code class=&quot;highlighter-rouge&quot;&gt;MaxPooling2D&lt;/code&gt;ã®ä¸»ãªå¼•æ•°ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;pool_size&lt;/code&gt;ã®ã¿ã§ã™ã€‚ä¾‹ãˆã°ã€2*2ã®ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã‚’è¡Œã„ãŸã„å ´åˆã«ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;pool_size&lt;/code&gt;ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;2&lt;/code&gt;ã‹&lt;code class=&quot;highlighter-rouge&quot;&gt;(2,2)&lt;/code&gt;ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# å…¥åŠ›éƒ¨
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ç•³ã¿è¾¼ã¿éƒ¨
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ãƒ—ãƒ¼ãƒªãƒ³ã‚°éƒ¨
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/convolutional/#conv2d&quot;&gt;ï¼ˆKeras: Conv2Dã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/pooling/&quot;&gt;ï¼ˆKeras: MaxPooling2Dã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;23-å‡ºåŠ›å‡¦ç†&quot;&gt;2.3 å‡ºåŠ›å‡¦ç†&lt;/h3&gt;
&lt;p&gt;ãƒ—ãƒ¼ãƒªãƒ³ã‚°ãŒçµ‚ã‚ã£ãŸã‚‰ã€æ®‹ã‚‹ã¯å…¨çµåˆå±¤ã«é€šã—ã¦ã€Softmaxã§åˆ†é¡ã™ã‚‹ã ã‘ã§ã™ã€‚ç°¡å˜ãªæ°—ãŒã—ã¾ã™ãŒä¸€ã¤ã ã‘è½ã¨ã—ç©´ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;MaxPooling2D&lt;/code&gt;ã®å‡ºåŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚µã‚¤ã‚ºã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚æœ€å¤§å€¤ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã¾ã§ã®ãƒ¢ãƒ‡ãƒ«ã‚’åˆ‡ã‚Šå‡ºã—ã¦ç¢ºèªã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 32, 32, 3)         0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 28, 28, 30)        2280
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 30)        0
=================================================================
Total params: 2,280
Trainable params: 2,280
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MaxPooling2D&lt;/code&gt;ã®å‡ºåŠ›ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(None, 14, 14, 30)&lt;/code&gt;ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã®çŠ¶æ…‹ã§ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Dense&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã“ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚’æ¸¡ã™ã¨ã©ã†ãªã‚‹ã‹ã€ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 32, 32, 3)         0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 28, 28, 30)        2280
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 30)        0
_________________________________________________________________
dense_1 (Dense)              (None, 14, 14, 100)       3100
=================================================================
Total params: 5,380
Trainable params: 5,380
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ãªã‚“ã¨ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(None, 14, 14, 100)&lt;/code&gt;ã¨ã„ã†å‡ºåŠ›ãŒå‡ºã¦ãã¦ã—ã¾ã„ã¾ã—ãŸã€‚æœ¬æ¥ãªã‚‰ã°ã€ã“ã“ã§ã¯å‡ºåŠ›ã¨ã—ã¦&lt;code class=&quot;highlighter-rouge&quot;&gt;(None, 100)&lt;/code&gt;ãŒæ¬²ã—ã„å ´é¢ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®åŸå› ã¯ã€Kerasã®&lt;code class=&quot;highlighter-rouge&quot;&gt;Dense&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å‡ºåŠ›ã®å®šç¾©ãŒã€&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;nD tensor with shape: (batch_size, â€¦, units)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ã¨ãªã£ã¦ã„ã‚‹ãŸã‚ã§ã€å…ƒã®å…¥åŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã®æ¬¡å…ƒã‚’å¤‰ãˆãªã„ä»•æ§˜ã«ãªã£ã¦ã„ã‚‹ã®ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã—ãŸãŒã£ã¦ã€Kerasã§3æ¬¡å…ƒä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’2æ¬¡å…ƒã«è½ã¨ã—è¾¼ã¿ãŸã„ã¨ãã«ã¯ã€äº‹å‰ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;Reshape&lt;/code&gt;ã‹&lt;code class=&quot;highlighter-rouge&quot;&gt;Flatten&lt;/code&gt;ãªã©ã‚’ç”¨ã„ã¦ãƒ†ãƒ³ã‚½ãƒ«ã®å½¢çŠ¶ã‚’å¤‰æ›´ï¼ˆå¹³æ»‘åŒ–ï¼‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã®å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚Œã°æœ›ã¿ã®å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'softmax'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 32, 32, 3)         0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 28, 28, 30)        2280
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 30)        0
_________________________________________________________________
flatten_1 (Flatten)          (None, 5880)              0
_________________________________________________________________
dense_1 (Dense)              (None, 100)               588100
_________________________________________________________________
dense_2 (Dense)              (None, 10)                1010
=================================================================
Total params: 591,390
Trainable params: 591,390
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ãªãŠã€&lt;code class=&quot;highlighter-rouge&quot;&gt;Flatten&lt;/code&gt;ã¯ãã®åã®é€šã‚Šã€å…¥åŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚’å¹³ã‚‰ã«ã™ã‚‹ï¼ˆå¹³æ»‘åŒ–ã™ã‚‹ï¼‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/core/#flatten&quot;&gt;ï¼ˆKeras: Flattenã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/core/#dense&quot;&gt;ï¼ˆKeras: Denseã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;24-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿ã¨å­¦ç¿’è¨­å®š&quot;&gt;2.4 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿ã¨å­¦ç¿’è¨­å®š&lt;/h3&gt;

&lt;p&gt;ã“ã®éƒ¨åˆ†ã¯å‰å›ã¾ã§ã¨ã»ã¼åŒä¸€ãªã®ã§ã€èª¬æ˜ã¯çœãã¾ã™ã€‚ä»¥ä¸‹ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã™ã®ã§ã€ä¸Šã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨åˆã‚ã›ã¦å‹•ã‹ã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;(&lt;strong&gt;æ³¨æ„&lt;/strong&gt;) ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã®å­¦ç¿’ã¯ã€æ™®é€šã®ãƒ‘ã‚½ã‚³ãƒ³ã§å›ã™ã¨ãã‚Œãªã‚Šã®æ™‚é–“ã‚’è¦ã—ã¾ã™ã€‚ï¼ˆæ‰‹æŒã¡ã®ãƒãƒ¼ãƒˆPCã§ã¯ã€ã‚¨ãƒãƒƒã‚¯ã‚ãŸã‚Š30ç§’ç¨‹åº¦ã‹ã‹ã‚Šã¾ã—ãŸã€‚ï¼‰ã¾ãŸã€åˆã‚ã¦å‹•ã‹ã™ã¨ãã«ã¯ã€CIFAR10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†ã«æ•°åˆ†ã‚’è¦ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# å­¦ç¿’è¨­å®š
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'adam'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'accuracy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;inner_ads&quot;&gt;
    &lt;div class=&quot;left_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022749.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt; 
    &lt;div class=&quot;right_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022750.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;3-å®Ÿé¨“&quot;&gt;3. å®Ÿé¨“&lt;/h2&gt;
&lt;h3 id=&quot;31-ï¼‘å±¤ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã®å­¦ç¿’çµæœ&quot;&gt;3.1 ï¼‘å±¤ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã®å­¦ç¿’çµæœ&lt;/h3&gt;
&lt;p&gt;ä¸Šè¨˜ã§å®Ÿè£…ã—ãŸ&lt;code class=&quot;highlighter-rouge&quot;&gt;cnn.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®ã‚ˆã†ãªåˆ†é¡ç²¾åº¦ã®æ¨ç§»ã¨ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-10/acc.png&quot; alt=&quot;ï¼‘å±¤CNNã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;&lt;br /&gt;
&lt;/div&gt;

&lt;p&gt;5ã‚¨ãƒãƒƒã‚¯ç›®ã‚ãŸã‚Šã‹ã‚‰éå­¦ç¿’ã®å‚¾å‘ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ã¾ãŸã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®æœ€é«˜ç²¾åº¦ã¯65%ç¨‹åº¦ã§ã‚ã‚‹ã“ã¨ãŒèª­ã¿å–ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;10ã‚¯ãƒ©ã‚¹ã®åˆ†é¡ã§65%ã®ç²¾åº¦ãªã®ã§ã€ãƒ‡ã‚¿ãƒ©ãƒ¡ã«åˆ†é¡ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã•ãã†ã§ã™ã€‚ãã“ã§ã€æ¬¡ç¯€ã§ã¯ã‚¼ãƒ­ã‹ã‚‰ã€œã®P234ã¨åŒæ§˜ã«ã€CNNã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®é‡ã¿ã‚’å¯è¦–åŒ–ã™ã‚‹ã“ã¨ã§ã€è¦å‰‡æ€§ã®ã‚ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å­¦ç¿’ã§ãã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter7&quot;&gt;ï¼ˆGitHub: cnn.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;32-é‡ã¿ã®å¯è¦–åŒ–&quot;&gt;3.2 é‡ã¿ã®å¯è¦–åŒ–&lt;/h3&gt;
&lt;h4 id=&quot;321-é‡ã¿ç”»åƒã®ç”Ÿæˆ&quot;&gt;3.2.1 é‡ã¿ç”»åƒã®ç”Ÿæˆ&lt;/h4&gt;
&lt;p&gt;CNNã®é‡ã¿ã‚’å¯è¦–åŒ–ã™ã‚‹ã«ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;model.get_weights()&lt;/code&gt;ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¦ã€ãã®ãƒªã‚¹ãƒˆã«å°‘ã—æ‰‹ã‚’åŠ ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬ã‚·ãƒªãƒ¼ã‚ºã®ç¬¬2å¼¾ã§ç¢ºèªã—ãŸã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒªã‚¹ãƒˆã¯ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›å´ã‹ã‚‰é †ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ä»Šå›ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€ç•³ã¿è¾¼ã¿å±¤ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®é‡ã¿ã¯å…ˆé ­ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã®ç‚¹ã‚’è¸ã¾ãˆã¦ã€æ¬¡ã®CNNã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®é‡ã¿ã‚’å¯è¦–åŒ–ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆæŠœç²‹ã‚’ã¿ã¦ãã ã•ã„ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;weight_image&lt;/code&gt;ã¨ã„ã†ãƒªã‚¹ãƒˆã«å„ãƒ•ã‚£ãƒ«ã‚¿ã®é‡ã¿ã®NumPyé…åˆ—ã‚’è¿½åŠ ã—ã¦ã„ãã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array_to_img&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ç•³ã¿è¾¼ã¿å±¤ã®é‡ã¿ã‚’å–ã£ã¦ãã‚‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# å„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«åˆ†å‰²ã™ã‚‹
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;weight_image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array_to_img&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;weight_image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ç°¡å˜ã«å„éƒ¨ã‚’èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚ã¾ãšã€&lt;code class=&quot;highlighter-rouge&quot;&gt;np.split()&lt;/code&gt;ã«ã‚ˆã‚Šã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(5, 5, 3, 30)&lt;/code&gt;ã¨ãªã£ã¦ã„ã‚‹é‡ã¿ã®ãƒªã‚¹ãƒˆã‚’ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(5, 5, 3, 1)&lt;/code&gt;ã®å½¢ã‚’æŒã¤30å€‹ã®ãƒªã‚¹ãƒˆã«åˆ†å‰²ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã®å¾Œã€&lt;code class=&quot;highlighter-rouge&quot;&gt;np.squeeze()&lt;/code&gt;ã«ã‚ˆã‚Šã€ç„¡é§„ãªæ¬¡å…ƒ: 3æ¬¡å…ƒç›®ã‚’ãªãã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(5, 5, 3)&lt;/code&gt;ã®å½¢çŠ¶ã‚’æŒã¤ãƒªã‚¹ãƒˆãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æœ€å¾Œã«&lt;code class=&quot;highlighter-rouge&quot;&gt;array_to_image()&lt;/code&gt;ã‚’ç”¨ã„ã¦ãƒªã‚¹ãƒˆã‚’PILå½¢å¼ã®ç”»åƒã«å¤‰æ›ã—ã€ã‚¿ã‚¤ãƒ«çŠ¶ã«ç”»åƒã‚’ä¸¦ã¹ã‚‹ãŸã‚ã«å†ã³NumPyå½¢å¼ã«å¤‰æ›ã—ç›´ã—ã¦ã€ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¦ãŠãã¾ã™ã€‚&lt;/p&gt;

&lt;h4 id=&quot;322-ã‚¿ã‚¤ãƒ«çŠ¶ã«ç”»åƒã‚’è¡¨ç¤º&quot;&gt;3.2.2 ã‚¿ã‚¤ãƒ«çŠ¶ã«ç”»åƒã‚’è¡¨ç¤º&lt;/h4&gt;
&lt;p&gt;æ®‹ã‚‹ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;weight_image&lt;/code&gt;ã‚’ç”»åƒåŒ–ã™ã‚Œã°è‰¯ã„ã ã‘ã§ã™ãŒã€ã©ã†ã›ãªã‚‰ã‚¿ã‚¤ãƒ«çŠ¶ã«ä¸¦ã¹ã¦è¡¨ç¤ºã—ãŸã„ã¨ã“ã‚ã§ã™ã€‚ã—ã‹ã—ã€ã‚¿ã‚¤ãƒ«çŠ¶ã«è¤‡æ•°ç”»åƒã‚’å‡ºåŠ›ã™ã‚‹ã®ã¯è‹¥å¹²æ‰‹é–“ãŒã‹ã‹ã‚Šã¾ã™â€¦&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹ã«ã€ã‚¿ã‚¤ãƒ«çŠ¶ã«ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¤ºã—ã¾ã™ã€‚å„éƒ¨ã®è©³ã—ã„èª¬æ˜ã¯çœãã¾ã™ãŒã€å¤§ã¾ã‹ã«ã¯ç©ºã®ç”Ÿæˆç”»åƒã‚µã‚¤ã‚ºã®ãƒªã‚¹ãƒˆã‚’ç”¨æ„ã—ã¦ã€ãã“ã«å…ƒã®ãƒ”ãƒ¼ã‚¹ã¨ãªã‚‹ç”»åƒã‚’å…¥ã‚Œã¦ã„ãæµã‚Œã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PIL&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;combine_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# é‡ã¿ç”»åƒã®åˆä½“
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromarray&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'weight.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;combine_images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ceil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;height&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;img&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§é‡ã¿ç”»åƒã‚’å¯è¦–åŒ–ã—ãŸçµæœãŒä»¥ä¸‹ã®å›³ã§ã™ã€‚&lt;/p&gt;
&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-10/param.png&quot; alt=&quot;CNNã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é‡ã¿å¯è¦–åŒ–çµæœ&quot; style=&quot;width: 300px;&quot; /&gt;&lt;br /&gt;
    ï¼œé‡ã¿ã®å¯è¦–åŒ–çµæœï¼
&lt;/div&gt;

&lt;p&gt;é‡ã¿ã®å¯è¦–åŒ–çµæœã®å›³ã‹ã‚‰ã€å­¦ç¿’å‰ã¯å®Œå…¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªé‡ã¿ã¨ãªã£ã¦ã„ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãŒã€å­¦ç¿’å¾Œã«ã¯ã‚ã‚‹ç‰¹å®šã®æ–¹å‘ã«åå¿œã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ã¨ã—ã¦å¤‰åŒ–ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€æœ¬æ¥ã®ç›®çš„ã§ã‚ã‚‹ã€è¦å‰‡æ€§ã®ã‚ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å­¦ç¿’ã§ãã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;ãªãŠã€ä¸€é€£ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;visualize_weights.py&lt;/code&gt;ã¨ã—ã¦GitHubã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter7&quot;&gt;ï¼ˆGitHub: visualize_weights.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;4-å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®æ´»ç”¨&quot;&gt;4. å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®æ´»ç”¨&lt;/h2&gt;
&lt;p&gt;ä»Šå›å®Ÿè£…ã—ã¦ããŸ1å±¤ã®CNNã§ã¯ã€CIFAR10ã§65%ç¨‹åº¦ã®åˆ†é¡ç²¾åº¦ã—ã‹å‡ºã›ã¾ã›ã‚“ã§ã—ãŸã€‚æº€è¶³ã«å†™çœŸã®åˆ†é¡ã‚’ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã«ã¯ç¨‹é ã„ã§ã™ã­ã€‚&lt;/p&gt;

&lt;p&gt;åˆ†é¡ç²¾åº¦ã‚’ã‚ˆã‚Šå‘ä¸Šã•ã›ã‚‹ã«ã¯ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ã‚’æ”¹è‰¯ã™ã‚‹ã“ã¨ã‚‚è€ƒãˆã‚‰ã‚Œã¾ã™ãŒã€æ‰‹ã£å–ã‚Šæ—©ã„ã®ã¯ã€å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã—ã¦è»¢ç§»å­¦ç¿’ã‚’è¡Œã†ã“ã¨ã§ã™ã€‚ã“ã“ã§ã¯ä¸€ä¾‹ã¨ã—ã¦ã€KerasãŒå­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦æä¾›ã—ã¦ã„ã‚‹&lt;code class=&quot;highlighter-rouge&quot;&gt;MobileNet&lt;/code&gt;ã‚’ç”¨ã„ã¦ã€è»¢ç§»å­¦ç¿’ã«ã‚ˆã‚‹CIFAR10ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡å®Ÿé¨“ã‚’ã—ã¦ã€ã©ã‚Œã»ã©é«˜ã„åˆ†é¡æ€§èƒ½ãŒè¨˜éŒ²ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§ï¼š &lt;a href=&quot;https://keras.io/ja/applications/#mobilenet&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹MobileNetã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;41-mobilenetã®ç‰¹å¾´&quot;&gt;4.1 MobileNetã®ç‰¹å¾´&lt;/h3&gt;
&lt;p&gt;MobileNetã¯ãã®åã®é€šã‚Šã€å­¦ç¿’ãŒé€Ÿã„ï¼†è»½ã„ã¨ã„ã†ç‰¹å¾´ã‚’æŒã¡ã€ãã‚Œãªã‚Šã®åˆ†é¡ç²¾åº¦ã‚’èª‡ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚å­¦ç¿’ã¯ImageNetã¨ã„ã†ç”»åƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç”¨ã„ã¦è¡Œã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå›MobileNetã‚’æ‰±ã£ãŸç†ç”±ã¯ã€å„è‡ªã®ãƒ‘ã‚½ã‚³ãƒ³ä¸Šã§ã‚‚ç¾å®Ÿçš„ã«å‹•ä½œå¯èƒ½ãªå­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ãŸã‚ã§ã™ã€‚ãƒ¢ãƒ‡ãƒ«ã®è©³ç´°ã‚’çŸ¥ã‚ŠãŸã„æ–¹ã¯ã€ä¸‹è¨˜ã®ãƒªãƒ³ã‚¯ã‚ˆã‚Šè«–æ–‡ã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;http://www.image-net.org/&quot;&gt;ï¼ˆImageNetã®å…¬å¼ã‚µã‚¤ãƒˆï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://arxiv.org/abs/1704.04861&quot;&gt;ï¼ˆMobileNetã®è«–æ–‡ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;42-mobilenetã®èª­ã¿è¾¼ã¿&quot;&gt;4.2 MobileNetã®èª­ã¿è¾¼ã¿&lt;/h3&gt;
&lt;p&gt;ã§ã¯ã€Kerasã§å®Ÿéš›ã«MobileNetã‚’æ´»ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;MobileNetãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ã¯éå¸¸ã«ç°¡å˜ã§ã€ä¸‹è¨˜ã«ç¤ºã™ã‚ˆã†ã«1è¡Œã§èª­ã¿è¾¼ã‚ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;MobileNetã®å¼•æ•°ã«ã¤ã„ã¦ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;include_top&lt;/code&gt;ã¯å‡ºåŠ›å±¤ã‚‚å«ã‚ãŸãƒ¢ãƒ‡ãƒ«ã«ã™ã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã—ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;pooling&lt;/code&gt;ã«ã¤ã„ã¦ã¯å‡ºåŠ›å±¤ã‚’å«ã‚ãªã„ãƒ¢ãƒ‡ãƒ«ã®ã¨ãã«ã€ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã®æœ‰ç„¡ã‚„ãã®ç¨®é¡ã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»Šå›ã¯10ã‚¯ãƒ©ã‚¹åˆ†é¡ã®ãŸã‚ã€å‡ºåŠ›å±¤ã‚’å«ã‚ãªã„ãƒ¢ãƒ‡ãƒ«ã¨ã—ã€ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã«ã¯æ¬¡ç« ã§èª¬æ˜ã™ã‚‹ã€ŒGlobal Average Poolingã€ã‚’æŒ‡å®šã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.applications.mobilenet&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MobileNet&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MobileNet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include_top&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pooling&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'avg'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'softmax'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 32, 32, 3)         0
_________________________________________________________________
mobilenet_1.00_224 (Model)   (None, 1024)              3228864
_________________________________________________________________
dense_1 (Dense)              (None, 10)                10250
=================================================================
Total params: 3,239,114
Trainable params: 3,217,226
Non-trainable params: 21,888
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;43-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿&quot;&gt;4.3 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿&lt;/h3&gt;
&lt;p&gt;MobileNetã¯å…¥åŠ›ã‚µã‚¤ã‚ºã¨ã—ã¦ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(224, 224, 3)&lt;/code&gt;ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ãŒã€Kerasã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã‚‹ã¨ã€å¹…ã¨é«˜ã•ãŒ32ä»¥ä¸Šã§ã‚ã‚Œã°è‰¯ã„ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€ä»Šå›ã«é™ã£ã¦ã¯ç‰¹ã«ãƒªã‚µã‚¤ã‚ºã™ã‚‹ã“ã¨ãªãã€CIFAR10ã®ç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾ãƒ¢ãƒ‡ãƒ«ã«å…¥åŠ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cifar10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;44-è»¢ç§»å­¦ç¿’ã®å®Ÿè¡Œ&quot;&gt;4.4 è»¢ç§»å­¦ç¿’ã®å®Ÿè¡Œ&lt;/h3&gt;
&lt;p&gt;è»¢ç§»å­¦ç¿’ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;evaluate&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦å­¦ç¿’å‰ã®ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã‚’ç¢ºèªã—ã¦ãŠã“ã†ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# å­¦ç¿’è¨­å®š
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'adam'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'accuracy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# äº‹å‰å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆ
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;10000/10000 [==============================] - 2s 211us/step
[2.3138149349212647, 0.1194]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‡ºåŠ›ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ç²¾åº¦ã¯11.9%ã§ã—ãŸã€‚å‡ºåŠ›å±¤ã®å­¦ç¿’ãŒå…¨ãã§ãã¦ã„ãªã„çŠ¶æ…‹ãªã®ã§ã€ã“ã®ã‚ˆã†ãªçµæœã¨ãªã£ãŸã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã§ã¯ã€è»¢ç§»å­¦ç¿’ãªã®ã§æ•°ã‚¨ãƒãƒƒã‚¯å›ã™ã ã‘ã§äº‹è¶³ã‚Šã‚‹ãŸã‚ã€ä»Šå›ã¯3ã‚¨ãƒãƒƒã‚¯ã ã‘å›ã—ã¦ç²¾åº¦ã®æ¨ç§»ã‚’è¦‹ã¦ã„ãã“ã¨ã«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# è»¢ç§»å­¦ç¿’ã—ã¦ã¿ã‚‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Train on 50000 samples, validate on 10000 samples
Epoch 1/3
50000/50000 [==============================] - 17s 344us/step - loss: 1.0968 - acc: 0.6426 - val_loss: 0.9881 - val_acc: 0.7144
Epoch 2/3
50000/50000 [==============================] - 15s 307us/step - loss: 0.6443 - acc: 0.7826 - val_loss: 0.7400 - val_acc: 0.7499
Epoch 3/3
50000/50000 [==============================] - 16s 314us/step - loss: 0.5114 - acc: 0.8265 - val_loss: 0.7199 - val_acc: 0.7728
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2ã‚¨ãƒãƒƒã‚¯ç›®ã®æ™‚ç‚¹ã§ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;val_acc&lt;/code&gt;ãŒ74.99%ã¨ã»ã¼10%ç²¾åº¦ãŒå‘ä¸Šã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã‚„ã¯ã‚Šã€è»¢ç§»å­¦ç¿’ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€çœã‚³ã‚¹ãƒˆã§ãã‚Œãªã‚Šã®ç²¾åº¦ã‚’å‡ºã›ã‚‹åˆ†é¡å™¨ã‚’æ‰‹ã«å…¥ã‚Œã‚‰ã‚Œã‚‹ãƒ¡ãƒªãƒƒãƒˆã¯å¤§ãã„ã¨æ„Ÿã˜ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;transfer_learning.py&lt;/code&gt;ã¨ã—ã¦ã€GitHubã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter7&quot;&gt;ï¼ˆGitHub: transfer_learning.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;5-æœ€è¿‘ã®cnn&quot;&gt;5. æœ€è¿‘ã®CNN&lt;/h2&gt;
&lt;p&gt;æœ€å¾Œã«ç°¡å˜ã§ã™ãŒã€ã‚¼ãƒ­ã‹ã‚‰ã€œã«ã¯æ›¸ã‹ã‚Œã¦ã„ãªã„CNNé–¢é€£ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã«ã¤ã„ã¦è§¦ã‚Œã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;51-global-average-pooling&quot;&gt;5.1 Global Average Pooling&lt;/h3&gt;
&lt;p&gt;Global Average Poolingï¼ˆä»¥ä¸‹ã€GAPï¼‰ã¯å‡ºåŠ›å´ã®å…¨çµåˆå±¤ã‚’ç½®ãæ›ãˆã‚‹ã‚‚ã®ã¨ã—ã¦æ´»ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã¯ã€éå­¦ç¿’ã‚’é˜²ãã¤ã¤ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã‚‹ç‚¹ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;GAPã§ã¯ã€å„ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«ãã®ç‰¹å¾´ãƒãƒƒãƒ—ã®å€¤ã‚’å¹³å‡ã—ãŸå€¤ã‚’å‡ºåŠ›å€¤ã¨ã—ã¾ã™ã€‚ã¤ã¾ã‚Šã€ç•³ã¿è¾¼ã¿ï¼†ãƒ—ãƒ¼ãƒªãƒ³ã‚°å‡¦ç†å¾Œã®ãƒ†ãƒ³ã‚½ãƒ«ã®å½¢çŠ¶ãŒã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(None, 14, 14, 30)&lt;/code&gt;ã§ã‚ã£ãŸã¨ãã€GAPã‚’é©ç”¨ã™ã‚‹ã¨ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;(None, 30)&lt;/code&gt;ã¨ãªã‚Šã¾ã™ã€‚&lt;a href=&quot;https://arxiv.org/abs/1312.4400&quot;&gt;è«–æ–‡&lt;/a&gt;ã«ã‚ˆã‚‹ã¨ã€å„å‡ºåŠ›ã®ç‰¹å¾´ãƒãƒƒãƒ—ã¯ã€åˆ†é¡ã‚«ãƒ†ã‚´ãƒªã®â€confidence mapâ€ã¨ã—ã¦å®¹æ˜“ã«è§£é‡ˆã§ãã‚‹ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Kerasã§GAPã‚’é©ç”¨ã™ã‚‹ã®ã¯éå¸¸ã«ç°¡å˜ã§ã‚ã‚Šã€&lt;code class=&quot;highlighter-rouge&quot;&gt;keras.layers&lt;/code&gt;ã«ã‚ã‚‹ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;GlobalAveragePooling2D&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ä½¿ã†ã ã‘ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹ã«ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;cnn.py&lt;/code&gt;ã«GAPã‚’é©ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¤ºã—ã¾ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€æœ€å¤§å€¤ãƒ—ãƒ¼ãƒªãƒ³ã‚°ã¨å…¨çµåˆå±¤ã®é–“ã«GAPã‚’é…ç½®ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GlobalAveragePooling2D&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ãƒ¢ãƒ‡ãƒ«å®šç¾©
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Conv2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;strides&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'valid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MaxPooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pool_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GlobalAveragePooling2D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'softmax'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 32, 32, 3)         0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 28, 28, 30)        2280
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 30)        0
_________________________________________________________________
global_average_pooling2d_1 ( (None, 30)                0
_________________________________________________________________
dense_1 (Dense)              (None, 100)               3100
_________________________________________________________________
dense_2 (Dense)              (None, 10)                1010
=================================================================
Total params: 6,390
Trainable params: 6,390
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‡ºåŠ›çµæœã‚ˆã‚Šã€&lt;code class=&quot;highlighter-rouge&quot;&gt;cnn.py&lt;/code&gt;ã§ã¯ã€ç·ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ãŒ591,390ã§ã‚ã£ãŸã®ã«å¯¾ã—ã€GAPã‚’é©ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã§ã¯ã€6,390ã¨ã‹ãªã‚Šæ¸›å°‘ã—ã¦ã„ã‚‹ã“ã¨ãŒå®Ÿéš›ã«ç¢ºèªã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã¡ãªã¿ã«ã“ã®ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ãŸçµæœãŒä»¥ä¸‹ã®å›³ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-10/acc_gap.png&quot; alt=&quot;GAPé©ç”¨ãƒ¢ãƒ‡ãƒ«ã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;150ã‚¨ãƒãƒƒã‚¯å›ã—ã¦ã€åˆ†é¡ç²¾åº¦ã¯56%ç¨‹åº¦ã¨ãªã‚Šã¾ã—ãŸã€‚ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ç­‰ä¸€åˆ‡ã—ã¦ã„ãªã„ã®ã§ã€å…ƒã®ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚ã€10%ç¨‹åº¦ä¸‹ãŒã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã­â€¦ãªãŠã€ã“ã®ä¾‹ã®ã‚ˆã†ã«GAPã‚’é©ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã¯ä¸€èˆ¬ã«å­¦ç¿’ãŒé…ããªã‚‹ã¨ã„ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã”æ³¨æ„ãã ã•ã„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/layers/pooling/#globalaveragepooling2d&quot;&gt;ï¼ˆKerasã®Global Average Poolingã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://arxiv.org/abs/1312.4400&quot;&gt;ï¼ˆGAPã®åŸè‘—è«–æ–‡ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter7&quot;&gt;ï¼ˆGitHub: cnn_with_gap.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;52-cnnã®ã‚µãƒ¼ãƒ™ã‚¤è¨˜äº‹&quot;&gt;5.2 CNNã®ã‚µãƒ¼ãƒ™ã‚¤è¨˜äº‹&lt;/h3&gt;
&lt;p&gt;CNNã«é–¢ã™ã‚‹ç ”ç©¶ã®ã‚ˆã‚Šè©³ã—ã„æµã‚Œã«ã¤ã„ã¦ã¯ã€è‹¥å¹²å¤ããªã£ã¦ã„ã¾ã™ãŒã€ã‹ãªã‚Šå……å®Ÿã—ãŸã¾ã¨ã‚ãŒã‚ã‚‹ã®ã§ã€ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã™ã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://qiita.com/yu4u/items/7e93c454c9410c4b5427&quot;&gt;ï¼ˆç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æœ€æ–°ç ”ç©¶å‹•å‘ (ã€œ2017)ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;
&lt;p&gt;ä»Šå›ã¯ã€ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆCNNï¼‰ã«ã¤ã„ã¦è§¦ã‚Œã¦ã„ãã¾ã—ãŸã€‚Global Average Poolingã¯å˜ã«ä¸€èˆ¬ç‰©ä½“èªè­˜ã ã‘ã§ãªãã€æ·±å±¤ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã®åˆ†é‡ã§ã‚‚ä½¿ã‚ã‚Œã‚‹é‡è¦ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã§ã™ã€‚ã¾ãŸã€å‰å›ã¾ã§ã«ç™»å ´ã—ãŸãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã‚„ãƒãƒƒãƒæ­£è¦åŒ–ã‚‚ã‚ˆãCNNã§ä½¿ã‚ã‚Œã‚‹æ‰‹æ³•ã§ã‚ã‚‹ã“ã¨ã¯ã€é–“é•ã„ãªã„ã§ã™ã€‚ä»Šå¾Œã€GAPã¨åˆã‚ã›ã¦æ„è­˜ã—ã¦ãŠãã¨è‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã«ã¦ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã¨ã¨ã‚‚ã«å­¦ã¶Kerasã‚·ãƒªãƒ¼ã‚ºã¯å®Œçµã¨ãªã‚Šã¾ã™ãŒã€æœ¬ã‚·ãƒªãƒ¼ã‚ºã§å°‘ã—ã§ã‚‚æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«æ…£ã‚Œã‚‹ä¸€åŠ©ã¨ãªã£ã¦ã„ãŸã‚‰å¹¸ã„ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä»Šå¾Œã¯å°‘ã—æœŸé–“ã‚’ç½®ã„ã¦ã€è‡ªç„¶è¨€èªå‡¦ç†ã®å…¥é–€ã®ãŸã‚ã®è¨˜äº‹ãªã©ã‚’æŠ•ç¨¿ã§ããŸã‚‰ã¨æ€ã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;
&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/&quot;&gt;GitHub&lt;/a&gt;ã‚ˆã‚Šå…¥æ‰‹ã§ãã¾ã™ã€‚&lt;/p&gt;</content><author><name></name></author><category term="ã€Œã‚¼ãƒ­ã‹ã‚‰Kerasã€ã‚·ãƒªãƒ¼ã‚º" /><summary type="html">ã¯ã˜ã‚ã« ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã€æ·±å±¤å­¦ç¿’ã®å…¥é–€æ›¸ã¨ã—ã¦æœ‰åãªã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã¨åŒæ™‚ä¸¦è¡Œã§ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã—ã€ãã®å®šç€ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/resources/2019-05-10/model_diagram.png" /></entry><entry xml:lang="ja_JP"><title type="html">ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆå­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨ï¼‰</title><link href="http://localhost:4000/DL-Intro-4/" rel="alternate" type="text/html" title="ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆå­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨ï¼‰" /><published>2019-05-03T00:00:00+09:00</published><updated>2019-05-03T00:00:00+09:00</updated><id>http://localhost:4000/DL-Intro-4</id><content type="html" xml:base="http://localhost:4000/DL-Intro-4/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;

&lt;p&gt;ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã€æ·±å±¤å­¦ç¿’ã®å…¥é–€æ›¸ã¨ã—ã¦æœ‰åãªã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã¨åŒæ™‚ä¸¦è¡Œã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã—ã€ãã®å®šç€ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å‰å›ã¾ã§ã¯ã€Kerasã‚’æ´»ç”¨ã—ã¦å®Ÿéš›ã«ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã•ã›ã¦ã€ãã®ãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã—ã¦æ¨è«–ã¾ã§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ä»Šå›ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®6ç« ã«å¯¾å¿œã™ã‚‹ç¨®ã€…ã®å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã«ã¤ã„ã¦æ‰±ã„ã¾ã™ã€‚å¹…åºƒã„ãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã†ã®ã§ã€ç†è§£ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ã©ã‚Œã‚‚ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ã¨å®‰å®šæ€§ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«ã€é‡è¦ãªã‚‚ã®ã°ã‹ã‚Šã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ä¸€ã¤ä¸€ã¤ç†è§£ã§ãã‚‹ã¾ã§ã˜ã£ãã‚Šã¨å–ã‚Šçµ„ã‚€ã“ã¨ã‚’ã‚ªã‚¹ã‚¹ãƒ¡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯ã€ã¾ãšã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦ã®è©±é¡Œã‹ã‚‰å…¥ã£ã¦ã„ãã¾ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;div class=&quot;link_box&quot;&gt;
    &lt;span class=&quot;box-title&quot;&gt;ã‚·ãƒªãƒ¼ã‚ºãƒªãƒ³ã‚¯&lt;/span&gt;
    &lt;p&gt;ç¬¬ä¸€å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äºŒå¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-2/&quot;&gt;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &amp;amp; æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨&lt;/a&gt;&lt;/p&gt;  
    &lt;p&gt;ç¬¬ä¸‰å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-3/&quot;&gt;ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬å››å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-4/&quot;&gt;å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äº”å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-5/&quot;&gt;ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;1-æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ &quot;&gt;1. æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ &lt;/h2&gt;

&lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ç´¹ä»‹ãŒã‚ã£ãŸã‚ˆã†ã«ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«å¯¾ã—ã¦é©ç”¨ã•ã‚Œã‚‹æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ãŸãã•ã‚“å­˜åœ¨ã—ã€ãƒ¢ãƒ‡ãƒ«ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ãŒã€ãã®æ€§èƒ½ã‚’å¼•ãå‡ºã™ãŸã‚ã«éå¸¸ã«é‡è¦ã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P177ã«ç™»å ´ã—ãŸã€ã€ŒSGDã€AdaGradã€Adamã€ã«åŠ ãˆã€Adadeltaã€Nadamã€ã®5ã¤ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ã€Fashion-MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡å®Ÿé¨“ã‚’é€šã—ã¦ã€æ¯”è¼ƒã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;11-fashion-mnistãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&quot;&gt;1.1 Fashion-MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ&lt;/h3&gt;
&lt;p&gt;æœ¬ç¨¿ã§ç”¨ã„ã‚‹Fashion-MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨äº’æ›æ€§ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å†…å®¹ã¯æ‰‹æ›¸ãæ•°å­—ã§ã¯ãªãã€é´ã‚„ã‚ºãƒœãƒ³ã€ã‚«ãƒãƒ³ã€æœãªã©ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ã«é–¢ä¿‚ã®ã‚ã‚‹ã‚‚ã®ã¨ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Fashion-MNISTã¯ã€MNISTã®åˆ†é¡ã‚¿ã‚¹ã‚¯ãŒã€Œç°¡å˜éãã‚‹ã“ã¨ã€ãªã©ã‚’ç†ç”±ã«ã€ãã‚Œã‚’ç½®ãæ›ãˆã‚‹ç›®çš„ã§ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;è©¦ã—ã«1æšãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ç”»åƒã‚’è¡¨ç¤ºã•ã›ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä¸‹è¨˜ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å‹•ä½œã•ã›ã¦ã¿ã¦ãã ã•ã„ã€‚ç”»åƒã®è¡¨ç¤ºã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;imshow&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ãˆã°ç°¡å˜ã«ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fashion_mnist&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fashion_mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'gray'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/fm_example.png&quot; alt=&quot;Fashion-MNISTã®å†…å®¹ã®ä¸€ä¾‹&quot; style=&quot;width: 300px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;é´ã‚‰ã—ãç”»åƒãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã¾ã™ã­ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://github.com/zalandoresearch/fashion-mnist&quot;&gt;ï¼ˆFashion-MNISTã®GitHubãƒ¬ãƒã‚¸ãƒˆãƒª ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/datasets/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹Fashion-MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª¬æ˜ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;12-ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&quot;&gt;1.2 ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&lt;/h3&gt;
&lt;p&gt;æœ¬å®Ÿé¨“ã«ç”¨ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ã¨ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®å…¬å¼ãƒ¬ãƒã‚¸ãƒˆãƒªã«ã‚ã‚‹&lt;a href=&quot;https://github.com/oreilly-japan/deep-learning-from-scratch/blob/master/ch06/optimizer_compare_mnist.py&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/a&gt;ã«åŸºã¥ãã¾ã™ã€‚å®Ÿè£…è‡ªä½“ã¯å‰å›ã¾ã§ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã»ã¼æµç”¨ã—ã¦å®Ÿç¾ã§ãã‚‹ã®ã§ã€ã“ã“ã§ã¯èª¬æ˜ã‚’çœç•¥ã—ã¾ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è‡ªä½“ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;GitHub&lt;/a&gt;ã®&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_optimizer.py&lt;/code&gt;ã«ã¦å…¬é–‹ã—ã¦ã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãªãŠã€è‡ªåŠ›ã§å®Ÿè£…ã‚’ã—ã¦ã¿ãŸã„æ–¹ã¯ã€å…¬å¼ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’è¦‹ã¤ã¤ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/blob/master/chapter4%265/two_nn.py&quot;&gt;å‰å›ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/a&gt;ã‚’ãƒ™ãƒ¼ã‚¹ã«ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P176ã€œP178&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_optimizer.pyï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/optimizers/#keras&quot;&gt;ï¼ˆKerasã§åˆ©ç”¨å¯èƒ½ãªæœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;13-ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒ&quot;&gt;1.3 ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒ&lt;/h3&gt;
&lt;p&gt;1.2ã§å®Ÿè£…ã—ãŸ5å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®Ÿè¡Œã•ã›ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/loss.png&quot; alt=&quot;æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ åˆ¥ã®æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;å›³ã‹ã‚‰ã€SGDã¨Adadeltaã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€Adam/Nadam/Adagradã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚åæŸãŒé…ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€ã“ã®å®Ÿé¨“ã«ãŠã„ã¦ã¯ã€NadamãŒ5ã¤ã®æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä¸­ã§ã€æœ€ã‚‚åæŸã®é€Ÿã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;2-é‡ã¿ã®åˆæœŸåŒ–&quot;&gt;2. é‡ã¿ã®åˆæœŸåŒ–&lt;/h2&gt;

&lt;p&gt;Kerasã«ãŠã‘ã‚‹é‡ã¿ã®åˆæœŸåŒ–ã¯ç‰¹ã«æŒ‡å®šã—ãªã„é™ã‚Šã€ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒ¬ã‚¤ãƒ¤ãƒ¼å®šç¾©æ™‚ã«é‡ã¿ã®åˆæœŸåŒ–æ–¹æ³•ã‚’æŒ‡å®šã—ãªã‘ã‚Œã°ã€å„å±¤ã®æ‰€å®šã®åˆæœŸåŒ–æ–¹æ³•ãŒè‡ªå‹•çš„ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€é‡ã¿ã®åˆæœŸåŒ–ã‚’ã“ã¡ã‚‰ã‹ã‚‰äº‹å‰ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆKerasï¼‰ã‚’æ´»ç”¨ã—ãŸã¨ãã®ã€åˆæœŸåŒ–æ‰‹æ³•ã«ã‚ˆã‚‹åæŸé€Ÿåº¦ã®é•ã„ã‚’æ¤œè¨¼ã—ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;21-å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã¦ã¿ã‚‹&quot;&gt;2.1 å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ã¦ã¿ã‚‹&lt;/h3&gt;
&lt;p&gt;ã“ã“ã§ã€å…¨çµåˆå±¤: &lt;code class=&quot;highlighter-rouge&quot;&gt;Dense&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä¸‹è¨˜ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¸€éƒ¨æŠœç²‹ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keras.layers.Dense(units, activation=None, use_bias=True, kernel_initializer='glorot_uniform',
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;kernel_initializer&lt;/code&gt;ã‚’è¦‹ã‚‹ã¨ã€åˆæœŸåŒ–ã®æ‰‹æ³•ã¨ã—ã¦ã€Glorotã®ä¸€æ§˜åˆ†å¸ƒï¼ˆXavierã®ä¸€æ§˜åˆ†å¸ƒï¼‰ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;åˆæœŸåŒ–æ‰‹æ³•ã‚’å¤‰æ›´ã—ãŸã„å ´åˆã«ã¯ã€ã™ã§ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹æ‰‹æ³•ã‚’&lt;code class=&quot;highlighter-rouge&quot;&gt;kernel_initializer&lt;/code&gt;ã«å¼•æ•°ã¨ã—ã¦ä¸ãˆã‚‹ã‹ã€æ–°ãŸã«æ‰‹æ³•è‡ªä½“ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚æ–°ãŸã«å®šç¾©ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/core/#dense&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹Denseãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/initializers/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹åˆæœŸåŒ–æ‰‹æ³•ã«ã¤ã„ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;22-åˆæœŸåŒ–æ‰‹æ³•ã«ã‚ˆã‚‹åæŸé€Ÿåº¦ã®é•ã„&quot;&gt;2.2 åˆæœŸåŒ–æ‰‹æ³•ã«ã‚ˆã‚‹åæŸé€Ÿåº¦ã®é•ã„&lt;/h3&gt;
&lt;p&gt;ã§ã¯ã€å‰ç« ã§å®Ÿè£…ã—ãŸ5å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã—ã¦ã€åˆæœŸåŒ–æ‰‹æ³•ã«ã‚ˆã‚‹åæŸé€Ÿåº¦ã®é•ã„ã‚’Kerasã§ã‚‚æ¤œè¨¼ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;åˆæœŸåŒ–æ‰‹æ³•ã«ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®Xaiverã®åˆæœŸå€¤ã¨Heã®åˆæœŸå€¤ã€æ¨™æº–åå·®ãŒ0.01ã®æ­£è¦åˆ†å¸ƒã®3ã¤ã‚’ãã‚Œãã‚Œç”¨ã„ã¾ã™ã€‚ã¾ãŸã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P184ã€œP186ã®å®Ÿé¨“è¨­å®šã¨åˆã‚ã›ã‚‹ãŸã‚ã€ä¸­é–“å±¤ã®æ´»æ€§åŒ–é–¢æ•°ã‚’&lt;code class=&quot;highlighter-rouge&quot;&gt;sigmoid&lt;/code&gt;ã‹ã‚‰&lt;code class=&quot;highlighter-rouge&quot;&gt;relu&lt;/code&gt;ã«å¤‰æ›´ã—ã¾ã™ã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;GitHub&lt;/a&gt;ã®&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_initializer.py&lt;/code&gt;ã‚ˆã‚Šå…¥æ‰‹ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_initializer.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®å›³ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/loss_init.png&quot; alt=&quot;åˆæœŸåŒ–æ‰‹æ³•åˆ¥ã®æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;å›³ã‚ˆã‚Šã€ã‚„ã¯ã‚Šæ´»æ€§åŒ–é–¢æ•°ã«ReLUã‚’ç”¨ã„ã‚‹å ´åˆã«ã¯ã€Heã®ä¸€æ§˜åˆ†å¸ƒã«ã‚ˆã‚‹åˆæœŸåŒ–ãŒæœ€ã‚‚é©ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P184ã€œP186&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_initializer.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;3-æ­£è¦åŒ–æ­£å‰‡åŒ–&quot;&gt;3. æ­£è¦åŒ–ãƒ»æ­£å‰‡åŒ–&lt;/h2&gt;

&lt;p&gt;ä»¥ä¸‹ã€4ç« ã¨5ç« ã§ã¯ã€ãã‚Œãã‚Œæ­£è¦åŒ–ã¨æ­£å‰‡åŒ–ã«ã¤ã„ã¦æ‰±ã„ã¾ã™ã€‚ãã®å‰ã«ã€å··ã§èª¤ç”¨ã—ãŒã¡ãªã€æ©Ÿæ¢°å­¦ç¿’ã«ãŠã‘ã‚‹æ­£è¦åŒ–ã¨æ­£å‰‡åŒ–ã®æ„å‘³ã«ã¤ã„ã¦ç¢ºèªã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;31-æ­£è¦åŒ–&quot;&gt;3.1 æ­£è¦åŒ–&lt;/h3&gt;
&lt;p&gt;æ©Ÿæ¢°å­¦ç¿’ã«ãŠã‘ã‚‹æ­£è¦åŒ–ã¯ã€ã€Œ&lt;strong&gt;ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ã‚‹ç¯„å›²å†…ã«ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã“ã¨&lt;/strong&gt;ã€ã‚’æ„å‘³ã—ã¾ã™ã€‚æ¨™æº–åŒ–ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€æ¨™æº–åŒ–ã¨æ­£è¦åŒ–ã§ã¯å³å¯†ã«ã¯æ„å‘³åˆã„ãŒç•°ãªã‚Šã¾ã™ã€‚æ¨™æº–åŒ–: standardization ã¯ã€ã€Œå¹³å‡ãŒ0ã€åˆ†æ•£ãŒ1ã€ã«ãªã‚‹ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã‚’æŒ‡ã—ã¾ã™ã€‚ãªãŠã€ã“ã®ç”¨èªã¯çµ±è¨ˆå­¦ã§ç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã—ãŸãŒã£ã¦ã€æ­£è¦åŒ–ã¯æ¨™æº–åŒ–ã‚’æŠ½è±¡åŒ–ã—ãŸã‚ˆã†ãªæ„å‘³åˆã„ã‚’æŒã¡ã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;32-æ­£å‰‡åŒ–&quot;&gt;3.2 æ­£å‰‡åŒ–&lt;/h3&gt;
&lt;p&gt;æ­£å‰‡åŒ–ã¯éå­¦ç¿’ï¼ˆéé©å¿œï¼‰ã‚’é˜²ããŸã‚ã«ã‚ã‚‹ç¨®ã®ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’èª²ã™ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚Weight DecayãŒãã®ä¸€ä¾‹ã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/regularizers/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹æ­£å‰‡åŒ–ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;inner_ads&quot;&gt;
    &lt;div class=&quot;left_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022749.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt; 
    &lt;div class=&quot;right_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022750.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;4-ãƒãƒƒãƒæ­£è¦åŒ–&quot;&gt;4. ãƒãƒƒãƒæ­£è¦åŒ–&lt;/h2&gt;

&lt;p&gt;ãƒãƒƒãƒæ­£è¦åŒ–ã¯ã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’å¹³å‡å€¤ãŒ0ã§åˆ†æ•£ãŒ1ã¨ãªã‚‹åˆ†å¸ƒã«å¤‰æ›ã™ã‚‹æ‰‹æ³•ã®ã“ã¨ã‚’æŒ‡ã—ã¾ã™ã€‚ãƒãƒƒãƒæ­£è¦åŒ–ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ¢ãƒ‡ãƒ«ã®åæŸã‚’é«˜é€ŸåŒ–ã§ãã‚‹ã»ã‹ã€é‡ã¿ã®åˆæœŸåŒ–æ‰‹æ³•ã«å¯¾ã—ã¦ã‹ãªã‚Šé ‘å¥ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã§ã¯ã€Kerasã§ãƒãƒƒãƒæ­£è¦åŒ–ã®å®Ÿé¨“ã‚’ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;41-ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&quot;&gt;4.1 ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&lt;/h3&gt;
&lt;p&gt;Kerasã«ãŠã„ã¦ã€ãƒãƒƒãƒæ­£è¦åŒ–ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;BatchNormalization&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§å®Ÿè£…ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€2ç« ã®ãƒ¢ãƒ‡ãƒ«ã®ã€Œå…¨çµåˆå±¤ã¨æ´»æ€§åŒ–å±¤ã®é–“ã€ã«ãƒãƒƒãƒæ­£è¦åŒ–å±¤ã‚’è¿½åŠ ã™ã‚‹å½¢ã§å®Ÿè£…ã—ã¾ã™ã€‚ã¾ãŸã€é‡ã¿ã®åˆæœŸåŒ–ã¯ã€Œæ¨™æº–åå·®ãŒ0.01ã®æ­£è¦åˆ†å¸ƒã€ã«ã‚ˆã‚Šè¡Œã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãªãŠã€2ç« ã§ç¢ºèªã—ãŸã‚ˆã†ã«ã€ã“ã®é‡ã¿åˆæœŸåŒ–ã§ã¯é€šå¸¸å­¦ç¿’ã¯å…¨ãé€²è¡Œã—ã¾ã›ã‚“ã€‚ã¤ã¾ã‚Šã€ãƒãƒƒãƒæ­£è¦åŒ–ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã©ã®ç¨‹åº¦åˆæœŸåŒ–æ‰‹æ³•ã«å¯¾ã—ã¦é ‘å¥ã«ãªã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Kerasã«ãŠã‘ã‚‹ãƒãƒƒãƒæ­£è¦åŒ–ã®é©ç”¨ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BatchNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/&quot;&gt;GitHub&lt;/a&gt;ã‚ˆã‚Šå…¥æ‰‹ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/normalization/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹Batch Normalizationã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_batch_norm.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;42-ãƒãƒƒãƒæ­£è¦åŒ–ã®æœ‰ç„¡ã«ã‚ˆã‚‹åˆ†é¡ç²¾åº¦ã®æ¯”è¼ƒ&quot;&gt;4.2 ãƒãƒƒãƒæ­£è¦åŒ–ã®æœ‰ç„¡ã«ã‚ˆã‚‹åˆ†é¡ç²¾åº¦ã®æ¯”è¼ƒ&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_batch_norm.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®å›³ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_bn.png&quot; alt=&quot;ãƒãƒƒãƒæ­£è¦åŒ–ã®æœ‰ç„¡ã«ã‚ˆã‚‹åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;å›³ã‚ˆã‚Šã€ãƒãƒƒãƒæ­£è¦åŒ–ã‚’ãƒ¢ãƒ‡ãƒ«ã«é©ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‹ãªã‚Šé©å½“ãªé‡ã¿ã®åˆæœŸåŒ–ã‚’è¡Œã£ã¦ã‚‚ã€ãã¡ã‚“ã¨å­¦ç¿’ã—ã¦ãã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P186ã€œP189&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;5-éå­¦ç¿’ã‚’é˜²ããŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯&quot;&gt;5. éå­¦ç¿’ã‚’é˜²ããŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯&lt;/h2&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€éå­¦ç¿’ã‚’é˜²ããŸã‚ã®æ‰‹æ³•ã®ä¸€ä¾‹ã¨ã—ã¦ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã‚‚æ‰±ã‚ã‚Œã¦ã„ãŸã€Weight decayã¨ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã«åŠ ãˆã€Early Stoppingã¤ã„ã¦ã‚‚æ‰±ã„ã¾ã™ã€‚å‰ç« ã¾ã§ã¨åŒæ§˜ã«Kerasã§ãƒ†ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè£…ã—ã€ãã‚Œãã‚Œã®æ‰‹æ³•ã®åŠ¹æœã‚’æ¤œè¨¼ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;51-weight-decay&quot;&gt;5.1 Weight decay&lt;/h3&gt;
&lt;h4 id=&quot;511-kerasã«ãŠã‘ã‚‹weight-decayã®é©ç”¨æ–¹æ³•&quot;&gt;5.1.1 Kerasã«ãŠã‘ã‚‹Weight decayã®é©ç”¨æ–¹æ³•&lt;/h4&gt;

&lt;p&gt;Kerasã«ãŠã‘ã‚‹Weight decayã¯ã€å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å¼•æ•°ã«å­˜åœ¨ã™ã‚‹ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;kernel_regularizer&lt;/code&gt;ã«å¯¾ã—ã¦åˆ©ç”¨ã—ãŸã„æ­£å‰‡åŒ–æ‰‹æ³•ã‚’ä¸ãˆã‚‹ã“ã¨ã§åˆ©ç”¨ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€4ç« ã§å®Ÿè£…ã—ãŸãƒãƒƒãƒæ­£è¦åŒ–ã‚ã‚Šã®ãƒ¢ãƒ‡ãƒ«ã«weight decayã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ã€éå­¦ç¿’ãŒè»½æ¸›ã™ã‚‹ã‹æ¤œè¨¼ã—ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Weight decayã®ç°¡å˜ãªé©ç”¨ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regularizers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_wd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;regularizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_initializer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kernel_regularizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_wd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;GitHub&lt;/a&gt;ã«ã‚ã‚‹ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_weight_decay.py&lt;/code&gt;ã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/regularizers/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹æ­£å‰‡åŒ–ã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_weight_decay.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;512-weight-decayã®é©ç”¨çµæœ&quot;&gt;5.1.2 Weight decayã®é©ç”¨çµæœ&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_weight_decay.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®ã‚ˆã†ãªå›³ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center; margin: 0 0 10px 0;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_wd.png&quot; alt=&quot;Weight decayã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œWeight decayã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_wo_wd.png&quot; alt=&quot;Weight decayç„¡ã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œWeight decayãªã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;p&gt;å›³ã‚ˆã‚Šã€Weigth decayã®æœ‰ç„¡ã‚’å•ã‚ãšã€ãƒ†ã‚¹ãƒˆç²¾åº¦ã¯ã‹ãªã‚Šä¹±é«˜ä¸‹ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¸€æ–¹ã§ã€è¨“ç·´ç²¾åº¦ã«ã¤ã„ã¦ã¯ã€Weight decayã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€éå­¦ç¿’ãŒæŠ‘åˆ¶ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;52-ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆ&quot;&gt;5.2 ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆ&lt;/h3&gt;
&lt;h4 id=&quot;521-ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®å®Ÿè£…&quot;&gt;5.2.1 ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®å®Ÿè£…&lt;/h4&gt;

&lt;p&gt;Kerasã«ãŠã„ã¦ã€ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;Dropout&lt;/code&gt;ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§å®Ÿè£…ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®é©ç”¨ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;br /&gt;
ä¸‹è¨˜ã®ä¾‹ã§ã¯ã€ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆç‡ï¼ˆå…¥åŠ›ã®ãƒ¦ãƒ‹ãƒƒãƒˆã‚’æ¶ˆå»ã™ã‚‹å‰²åˆï¼‰ã‚’ã€å¼•æ•°: &lt;code class=&quot;highlighter-rouge&quot;&gt;rate&lt;/code&gt;ã«æ¸¡ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'relu'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dpout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®åŠ¹æœã‚’æ¤œè¨¼ã—ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_dropout.py&lt;/code&gt;ã¨ã—ã¦ã€GitHubã«ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚ã§ã¯ã€ã“ã®å®Ÿé¨“çµæœã«ã¤ã„ã¦æ¬¡é …ã§è¦‹ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/layers/core/#dropout&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹Dropoutã®èª¬æ˜ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_dropout.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;522-ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®é©ç”¨çµæœ&quot;&gt;5.2.2 ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã®é©ç”¨çµæœ&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_dropout.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®ã‚ˆã†ãªå›³ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center; margin: 0 0 10px 0;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_dpout.png&quot; alt=&quot;ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_wo_dpout.png&quot; alt=&quot;ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆç„¡ã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆãªã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;p&gt;å›³ã‹ã‚‰ã€ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã‚’é©ç”¨ã—ãŸãƒ¢ãƒ‡ãƒ«ã¯ã€ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¦ãƒˆã‚’é©ç”¨ã—ãªã„ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šã‚‚ã€éå­¦ç¿’ã‚’æŠ‘ãˆã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;53-early-stopping&quot;&gt;5.3 Early Stopping&lt;/h3&gt;
&lt;p&gt;Early Stoppingã¨ã¯ã€ãã®åã®é€šã‚Šå­¦ç¿’ã‚’æ—©æœŸã«çµ‚äº†ã•ã›ã¦ã—ã¾ã†ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚ã¤ã¾ã‚Šã€éå­¦ç¿’ãŒèµ·ãã‚‹å¯¸å‰ or ç™ºç”Ÿã—ãŸã‚‰ã™ãã«å­¦ç¿’ã‚’çµ‚äº†ã•ã›ã‚‹ã“ã¨ã§ã€ãƒ™ã‚¹ãƒˆãªãƒ¢ãƒ‡ãƒ«ã‚’æ‰‹ã«å…¥ã‚Œã‚ˆã†ã¨ã„ã†è©¦ã¿ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç„¡é§„ãªè¨ˆç®—æ©Ÿãƒªã‚½ãƒ¼ã‚¹ã®æ¶ˆè²»é˜²æ­¢ã«ã‚‚ç¹‹ãŒã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;h4 id=&quot;531-kerasã«ãŠã‘ã‚‹early-stoppingã®é©ç”¨æ–¹æ³•&quot;&gt;5.3.1 Kerasã«ãŠã‘ã‚‹Early Stoppingã®é©ç”¨æ–¹æ³•&lt;/h4&gt;

&lt;p&gt;Kerasã«ãŠã„ã¦Early Stoppingã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;keras.callbacks.EarlyStopping&lt;/code&gt;ã«ã‚ˆã‚Šå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚ä½¿ã„æ–¹ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;fit&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã€å¼•æ•°: &lt;code class=&quot;highlighter-rouge&quot;&gt;callbacks&lt;/code&gt;ã«ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;EarlyStopping&lt;/code&gt;ã‚’æ¸¡ã›ã°ã‚ˆã„ã§ã™ã€‚&lt;code class=&quot;highlighter-rouge&quot;&gt;EarlyStopping&lt;/code&gt;é–¢æ•°ã®ä¸»ãªå¼•æ•°ã®èª¬æ˜ã¯ä»¥ä¸‹ã®è¡¨ã®é€šã‚Šã§ã™ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;strong&gt;å¼•æ•°&lt;/strong&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;&lt;strong&gt;èª¬æ˜&lt;/strong&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;monitor&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ä½•ã‚’åŸºæº–ã«å­¦ç¿’ã‚’æ—©æœŸçµ‚äº†ã•ã›ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;br /&gt;ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;val_loss&lt;/code&gt;ã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;patience&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;ä½•ã‚¨ãƒãƒƒã‚¯ã®é–“ã€ç›£è¦–å€¤: &lt;code class=&quot;highlighter-rouge&quot;&gt;monitor&lt;/code&gt;ã«å¤‰åŒ–ãŒãªã„ã“ã¨ã‚’è¨±å®¹ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;verbose&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;å­¦ç¿’ä¸­ã«EarlyStoppingãŒé©ç”¨ã•ã‚ŒãŸã“ã¨ã‚’æ˜ç¤ºçš„ã«è¡¨ç¤ºã™ã‚‹ã‹ã—ãªã„ã‹ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;br /&gt;ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯0ï¼ˆè¡¨ç¤ºã—ãªã„ï¼‰ã§ã™ã€‚&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Early Stoppingã®ç°¡å˜ãªé©ç”¨ä¾‹ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€2ã‚¨ãƒãƒƒã‚¯ã®é–“ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹æå¤±é–¢æ•°ã®å€¤ã«æ”¹å–„ãŒè¦‹ã‚‰ã‚Œãªã„ã¨ã€å­¦ç¿’ãŒåœæ­¢ã™ã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;early_stopping&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EarlyStopping&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;patience&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callbacks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;early_stopping&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/callbacks/#earlystopping&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹Early Stoppingã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;532-early-stoppingã®é©ç”¨çµæœ&quot;&gt;5.3.2 Early Stoppingã®é©ç”¨çµæœ&lt;/h4&gt;

&lt;p&gt;5å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§Early Stoppingã®åŠ¹æœã‚’æ¤œè¨¼ã—ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€GitHubã«&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_early_stopping.py&lt;/code&gt;ã¨ã—ã¦ç½®ã„ã¦ã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;compare_early_stopping.py&lt;/code&gt;ã‚’å‹•ä½œã•ã›ãŸçµæœã€ä»¥ä¸‹ã®ã‚ˆã†ãªå›³ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center; margin: 0 0 10px 0;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_es.png&quot; alt=&quot;Early Stoppingã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œEarly Stoppingã‚ã‚Šã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-05-03/acc_wo_es.png&quot; alt=&quot;Early Stoppingç„¡ã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 400px;&quot; /&gt;&lt;br /&gt;
    ï¼œEarly Stoppingç„¡ã—ã®ã¨ãã®åˆ†é¡ç²¾åº¦ã®æ¨ç§»ï¼
&lt;/div&gt;

&lt;p&gt;å›³ã‚ˆã‚Šã€Early Stoppingã‚’é©ç”¨ã—ãŸã¨ãã«ã¯ã€40ã‚¨ãƒãƒƒã‚¯ã§å­¦ç¿’ãŒåœæ­¢ã—ã€éå­¦ç¿’ã—ã¦ã„ã‚‹æ§˜å­ã¯èª­ã¿å–ã‚Œã¾ã›ã‚“ã€‚ä¸€æ–¹ã§ã€Early Stoppingã‚’é©ç”¨ã—ãªã‹ã£ãŸã¨ãã«ã¯ã€60ã‚¨ãƒãƒƒã‚¯ã‚ãŸã‚Šã‹ã‚‰éå­¦ç¿’ã®å‚¾å‘ãŒèª­ã¿å–ã‚Œã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/tree/master/chapter6&quot;&gt;ï¼ˆGitHub: compare_early_stopping.pyï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;

&lt;p&gt;ä»Šå›ã¯æ§˜ã€…ãªå­¦ç¿’ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã«ã¤ã„ã¦ã€å®Ÿéš›ã«Kerasã§ãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè£…ã—ã€ãã®åŠ¹æœã‚’æ¤œè¨¼ã—ã¦ãã¾ã—ãŸã€‚æ¬¡å›ã¯ã€ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã¤ã„ã¦æ‰±ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãªãŠã€ã“ã®ã‚·ãƒªãƒ¼ã‚ºã¯æ¬¡å›ã§å®Œçµäºˆå®šã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬ç¨¿ã§æ‰±ã‚ãªã‹ã£ãŸã‚‚ã®ã®ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã€ã€Œãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼ã€ã«ã¤ã„ã¦ã¯ã€ä»Šå¾Œã€Œãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€é©åŒ– &amp;amp; äº¤å·®åˆ†å‰²æ¤œè¨¼ã€ã‚’ãƒ†ãƒ¼ãƒã«åˆ¥ã®æŠ•ç¨¿ã§è©³ã—ãç´¹ä»‹ã™ã‚‹äºˆå®šã§ã™ï¼&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras/&quot;&gt;GitHub&lt;/a&gt;ã‚ˆã‚Šå…¥æ‰‹ã§ãã¾ã™ã€‚&lt;/p&gt;</content><author><name></name></author><category term="ã€Œã‚¼ãƒ­ã‹ã‚‰Kerasã€ã‚·ãƒªãƒ¼ã‚º" /><summary type="html">ã¯ã˜ã‚ã«</summary></entry><entry xml:lang="ja_JP"><title type="html">ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨ï¼‰</title><link href="http://localhost:4000/DL-Intro-3/" rel="alternate" type="text/html" title="ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨ï¼‰" /><published>2019-04-26T00:00:00+09:00</published><updated>2019-04-26T00:00:00+09:00</updated><id>http://localhost:4000/DL-Intro-3</id><content type="html" xml:base="http://localhost:4000/DL-Intro-3/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;

&lt;p&gt;ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã€æ·±å±¤å­¦ç¿’ã®å…¥é–€æ›¸ã¨ã—ã¦æœ‰åãªã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã¨åŒæ™‚ä¸¦è¡Œã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã—ã€ãã®å®šç€ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å‰å›ã¾ã§ã¯ã€3å±¤ã®ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’Kerasã§å®Ÿè£…ã—ã€æ¨è«–å‡¦ç†ã®ã¿ã‚’æ‰±ã£ã¦ãã¾ã—ãŸã€‚ä»Šå›ã‹ã‚‰ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®4ç« ã¨5ç« ã«å¯¾å¿œã™ã‚‹ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ã«ã¨ã‚Šã‹ã‹ã‚Šã¾ã™ã€‚ã¾ãŸã€åŒæ™‚ã«å®Ÿé¨“çµæœã®ç°¡å˜ãªå¯è¦–åŒ–æ–¹æ³•ã«ã¤ã„ã¦ã‚‚è§¦ã‚Œã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã§ã¯ã€ï¼’å±¤ã®ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é¡Œæã«MNISTã®åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã‚’Kerasã§å®Ÿè£…ã—ã€å­¦ç¿’ã•ã›ã¦ã¿ã¾ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;div class=&quot;link_box&quot;&gt;
    &lt;span class=&quot;box-title&quot;&gt;ã‚·ãƒªãƒ¼ã‚ºãƒªãƒ³ã‚¯&lt;/span&gt;
    &lt;p&gt;ç¬¬ä¸€å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äºŒå¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-2/&quot;&gt;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &amp;amp; æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨&lt;/a&gt;&lt;/p&gt;  
    &lt;p&gt;ç¬¬ä¸‰å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-3/&quot;&gt;ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬å››å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-4/&quot;&gt;å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äº”å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-5/&quot;&gt;ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&quot;&gt;1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&lt;/h2&gt;

&lt;p&gt;ã¯ã˜ã‚ã«ã€ï¼’å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç”¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸‹ã€æœ¬æŠ•ç¨¿ã§ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;two_nn.py&lt;/code&gt;ã‚’ä½œæˆã™ã‚‹ã‚‚ã®ã¨ã—ã¦é€²ã‚ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;2-å®Ÿè£…&quot;&gt;2. å®Ÿè£…&lt;/h2&gt;

&lt;h3 id=&quot;21-ãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦&quot;&gt;2.1 ãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ä»Šå›å®Ÿè£…ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦å›³ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚å®Ÿè£…ã®å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡ã‚’è¡Œã†ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ã®ã§ã€å‡ºåŠ›ã¯ã‚¯ãƒ©ã‚¹ã®æ•°ã«åˆã‚ã›ã¦10æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã¨ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-04-26/two_layer_nn.png&quot; alt=&quot;2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚å¿µå›³&quot; style=&quot;width: 450px;&quot; /&gt;
&lt;/div&gt;

&lt;h3 id=&quot;22-ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&quot;&gt;2.2 ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã®ç¬¬4ç« ã«å¯¾å¿œã™ã‚‹2å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’Kerasã§å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…ã¯å‰å›ã¨ã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªã„ã®ã§ã€ä»¥ä¸‹ã«ä¸€æ°—ã«é€²ã‚ã¦ã—ã¾ã„ã¾ã™ã€‚&lt;br /&gt;
å¾©ç¿’ã¨ã—ã¦ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ç†è§£ã§ãã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç­‰ã¯å…¨ã¦ã‚¼ãƒ­ã‹ã‚‰ã€œã®P117ã€œ122ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;img_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'softmax'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 784)               0
_________________________________________________________________
dense_1 (Dense)              (None, 100)               78500
_________________________________________________________________
dense_2 (Dense)              (None, 10)                1010
=================================================================
Total params: 79,510
Trainable params: 79,510
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;23-ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿&quot;&gt;2.3 ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å‰å›ã¨åŒæ§˜ã«MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã€å‰å‡¦ç†ï¼ˆæ­£è¦åŒ–ã€ãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢ï¼‰ã‚’è¡Œã„ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å‰å›ã¨ã®ç›¸é•ç‚¹ã¨ã—ã¦ã¯ã€ãƒ©ãƒ™ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å­¦ç¿’ã®ãŸã‚ã«one-hotãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã•ã›ã‚‹ç‚¹ã§ã™ã€‚&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;one-hotãƒ™ã‚¯ãƒˆãƒ«åŒ–ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;to_categorical&lt;/code&gt;ã‚’ç”¨ã„ã‚‹ã“ã¨ã§è¡Œãˆã¾ã™ã€‚ &lt;br /&gt;
  å¼•æ•°ã¯å¤‰æ›å…ƒãƒªã‚¹ãƒˆã¨ã‚¯ãƒ©ã‚¹æ•°ã§ã™ã€‚æˆ»ã‚Šå€¤ã¯å¤‰æ›å¾Œã®ãƒªã‚¹ãƒˆã§ã™ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Before: {y_train.shape}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'After: {y_train.shape}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'y_train[0]: {y_train[0]}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to_categorical&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Before: (60000,)
y_train[0]: 5
After: (60000, 10)
y_train[0]: [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã—ã£ã‹ã‚Šã¨ã€ãƒ©ãƒ™ãƒ«ãŒone-hotãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;24-å­¦ç¿’ã®è¨­å®š&quot;&gt;2.4 å­¦ç¿’ã®è¨­å®š&lt;/h3&gt;
&lt;p&gt;ã“ã“ã‹ã‚‰ãŒæœ¬æ ¼çš„ã«æ–°ã—ã„éƒ¨åˆ†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;è¨­è¨ˆã—ãŸãƒ¢ãƒ‡ãƒ«ã§å­¦ç¿’ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€ã€Œ&lt;strong&gt;æå¤±é–¢æ•°&lt;/strong&gt;ã€ã¨ã€Œ&lt;strong&gt;æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ &lt;/strong&gt;ã€ã‚’è¨­å®šã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;æå¤±é–¢æ•°ã¨æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨­å®šã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;compile&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œãˆã¾ã™ã€‚
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã®4ç« ã®å®Ÿè£…ã§ã¯ã€æå¤±é–¢æ•°ã«ã‚¯ãƒ­ã‚¹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã€æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ç¢ºç‡çš„å‹¾é…é™ä¸‹æ³•ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚&lt;br /&gt;
ã—ãŸãŒã£ã¦ã€æœ¬å®Ÿè£…ã§ã‚‚&lt;code class=&quot;highlighter-rouge&quot;&gt;loss&lt;/code&gt;ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;'categorical_crossentropy'&lt;/code&gt;ã‚’æŒ‡å®šã—ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;optimizer&lt;/code&gt;ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;SGD(lr=learning_rate)&lt;/code&gt;ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ä½¿ã‚ã‚Œã¦ã„ã‚‹å­¦ç¿’ç‡ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;0.1&lt;/code&gt;ã§ã‚ã‚‹ãŸã‚ã€Kerasã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤0.01ã¨ç•°ãªã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;SGD&lt;/code&gt;ã«å­¦ç¿’ç‡ã‚’æ¸¡ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;è©•ä¾¡é–¢æ•°&lt;/strong&gt;ã®è¨­å®šã‚‚è¡Œã„ã¾ã™ã€‚&lt;br /&gt;
ã‚¼ãƒ­ã‹ã‚‰ã€œã®P121ã§ã¯ã€èªè­˜ç²¾åº¦ã‚’è©•ä¾¡é–¢æ•°ã¨ã—ã¦ã„ã‚‹ã®ã§ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;compile&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°: &lt;code class=&quot;highlighter-rouge&quot;&gt;metrics&lt;/code&gt;ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;['accuracy']&lt;/code&gt;ã‚’æŒ‡å®šã—ã¾ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.optimizers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SGD&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'categorical_crossentropy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'accuracy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/losses/&quot;&gt;ï¼ˆKerasã§åˆ©ç”¨å¯èƒ½ãªæå¤±é–¢æ•°ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/optimizers/&quot;&gt;ï¼ˆKerasã§åˆ©ç”¨å¯èƒ½ãªæœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;br /&gt;
&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/metrics/&quot;&gt;ï¼ˆKerasã«ãŠã‘ã‚‹è©•ä¾¡é–¢æ•°ã«ã¤ã„ã¦ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;(&lt;strong&gt;æ³¨æ„&lt;/strong&gt;) Kerasã‚’ã¯ã˜ã‚ã¨ã™ã‚‹æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãŒé †ä¼æ’­ã®è¨ˆç®—ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰ã™ã‚‹ã¨ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒè‡ªå‹•çš„ã«é€†ä¼æ’­ç”¨ã®å‡¦ç†ã‚’ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹çš„ã«è¡Œã£ã¦ãã‚Œã¾ã™ã€‚
ã—ãŸãŒã£ã¦ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®5ç« ã®éƒ¨åˆ†ã¯ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ä½¿ç”¨æ™‚ã«ã¯å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ï¼ˆè‡ªåˆ†ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¨­è¨ˆã™ã‚‹ã“ã¨ãŒãªã„é™ã‚Šã€‚ï¼‰&lt;/p&gt;

&lt;div class=&quot;inner_ads&quot;&gt;
    &lt;div class=&quot;left_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022749.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt; 
    &lt;div class=&quot;right_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022750.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;3-ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’&quot;&gt;3. ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’&lt;/h2&gt;

&lt;p&gt;ãã‚Œã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã‚’é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;fit&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œã„ã¾ã™ã€‚&lt;br /&gt;
ä»¥ä¸‹ã«å„å¼•æ•°ã«ã¤ã„ã¦ç°¡å˜ã«å¯¾å¿œè¡¨ã‚’ç¤ºã—ã¾ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;strong&gt;å¼•æ•°&lt;/strong&gt;&lt;/th&gt;
      &lt;th style=&quot;text-align: center&quot;&gt;&lt;strong&gt;èª¬æ˜&lt;/strong&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œã™ã‚‹ãƒ©ãƒ™ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆæ­£è§£ãƒ©ãƒ™ãƒ«ï¼‰ã‚’æŒ‡å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;batch_size&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ãƒŸãƒ‹ãƒãƒƒãƒã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;epochs&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ã‚¨ãƒãƒƒã‚¯æ•°ï¼ˆå­¦ç¿’å›æ•°ï¼‰ã‚’æŒ‡å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;verbose&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;å­¦ç¿’é€²æ—ã‚’ã©ã®ã‚ˆã†ã«è¡¨ç¤ºã™ã‚‹ã‹è¨­å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;validation_data&lt;/code&gt;&lt;/td&gt;
      &lt;td style=&quot;text-align: center&quot;&gt;ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fit&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;History&lt;/code&gt;ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;br /&gt;
ã“ã®æˆ»ã‚Šå€¤ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€æå¤±é–¢æ•°ã‚„èªè­˜ç²¾åº¦ã®ãƒ—ãƒ­ãƒƒãƒˆãŒã§ãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;validation_data&lt;/code&gt;ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ã‚¨ãƒãƒƒã‚¯ã”ã¨ã«ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆç²¾åº¦ã‚’æ¸¬ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/models/model/#fit&quot;&gt;ï¼ˆKerasã®fitãƒ¡ã‚½ãƒƒãƒ‰ã«ãŠã‘ã‚‹å¼•æ•°ã¨æˆ»ã‚Šå€¤ã®èª¬æ˜ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;validation_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Epoch 1/17
60000/60000 [==============================] - 2s 31us/step - loss: 0.8805 - acc: 0.7994
Epoch 2/17
60000/60000 [==============================] - 2s 27us/step - loss: 0.4102 - acc: 0.8907
~~~
~~~
Epoch 17/17
60000/60000 [==============================] - 2s 27us/step - loss: 0.1771 - acc: 0.9497
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;4-å­¦ç¿’çµæœã®è¡¨ç¤º&quot;&gt;4. å­¦ç¿’çµæœã®è¡¨ç¤º&lt;/h2&gt;

&lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã®P119ã¨P121ã§ã¯ã€ãã‚Œãã‚Œæå¤±é–¢æ•°ã®å€¤ã¨èªè­˜ç²¾åº¦ã®æ¨ç§»ã‚’å›³ã«ã—ã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã‚‚å®Ÿéš›ã«å›³ã«ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;h3 id=&quot;41-æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»&quot;&gt;4.1 æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»&lt;/h3&gt;
&lt;p&gt;Pythonã®å›³è¡¨æç”»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ã€Matplotlibã‚’æ´»ç”¨ã—ã¦ã€æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»ã‚’å›³ã«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h4 id=&quot;411-matplotlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&quot;&gt;4.1.1 Matplotlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h4&gt;

&lt;p&gt;Matplotlibã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„æ–¹ã¯ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install matplotlib
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ï¼ˆ&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼‰macOSã§Matplotlibã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã¨ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å•é¡Œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã¯ã€ä¸‹è¨˜ã‚’å‚ç…§ã—ã¦ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’æ›¸ãæ›ãˆã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://qiita.com/Gen6/items/78d83d117ef67e0d53c2&quot;&gt;ï¼ˆMatplotlibã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã¨ãã®å¯¾å‡¦æ³•ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;412-historyã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­èº«&quot;&gt;4.1.2 Historyã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­èº«&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;fit&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;History&lt;/code&gt;ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã¨å‰ç« ã§ç´¹ä»‹ã—ã¾ã—ãŸã€‚&lt;br /&gt;
å®Ÿé¨“çµæœã‚’å¯è¦–åŒ–ã™ã‚‹ãŸã‚ã«ã‚‚ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;History&lt;/code&gt;ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­èº«ã‚’ç¢ºèªã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Keys: {_results.history.keys()}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Keys: dict_keys(['val_loss', 'val_acc', 'loss', 'acc'])
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã®ã‚ˆã†ã«ã€æå¤±é–¢æ•°ã®å€¤ã¨èªè­˜ç²¾åº¦ã®çµæœãŒè¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¨ã‚‚ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;h4 id=&quot;413-ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã‚‹&quot;&gt;4.1.3 ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã¿ã‚‹&lt;/h4&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;History&lt;/code&gt;ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰è¨“ç·´æ™‚ã¨ãƒ†ã‚¹ãƒˆæ™‚ã®æå¤±é–¢æ•°ã®å€¤ã®ãƒªã‚¹ãƒˆå—ã‘å–ã‚Šã€ãã‚Œã‚‰ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€é€£ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¸‹è¨˜ã«ç¤ºã—ã¾ã™ã€‚&lt;br /&gt;
ãªãŠã€Matplotlibã®è©³ã—ã„ä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã€&lt;a href=&quot;https://matplotlib.org/tutorials/index.html&quot;&gt;å…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«&lt;/a&gt;ã‚’ã”è¦§ãã ã•ã„ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'loss'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'val_loss'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'train'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'best'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Epochs'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Loss'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'loss.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-04-26/loss.png&quot; alt=&quot;æå¤±é–¢æ•°ã®å€¤ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;ãã¡ã‚“ã¨æå¤±é–¢æ•°ãŒãƒ—ãƒ­ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸï¼&lt;/p&gt;

&lt;h3 id=&quot;42-èªè­˜ç²¾åº¦ã®æ¨ç§»&quot;&gt;4.2 èªè­˜ç²¾åº¦ã®æ¨ç§»&lt;/h3&gt;
&lt;p&gt;ãƒ¢ãƒ‡ãƒ«ãŒ&lt;strong&gt;éå­¦ç¿’&lt;/strong&gt;ã—ã¦ã„ãªã„ã‹ã‚’èªè­˜ç²¾åº¦ã®æ¨ç§»ã‚’å›³ã«ã—ã¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†!&lt;/p&gt;

&lt;p&gt;ãƒ—ãƒ­ãƒƒãƒˆã®æµã‚Œã¯ã€æå¤±é–¢æ•°ã®æ™‚ã¨ã»ã¨ã‚“ã©åŒä¸€ã®ãŸã‚ã€èª¬æ˜ã¯å‰²æ„›ã—ã¾ã™ã€‚&lt;br /&gt;
ä»¥ä¸‹ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚‹ã®ã§ã€å„è‡ªè©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'acc'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;history&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'val_acc'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'train'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_acc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'.'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'test'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'best'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Epochs'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Accuracy'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'acc.png'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-04-26/acc.png&quot; alt=&quot;èªè­˜ç²¾åº¦ã®æ¨ç§»&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;p&gt;å›³ã‹ã‚‰ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®èªè­˜ç²¾åº¦ã‚’è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®èªè­˜ç²¾åº¦ãŒå¤§å¹…ã«ä¸Šå›ã‚‹ç¾è±¡ã¯ç¢ºèªã§ããªã„ã®ã§ã€ãƒ¢ãƒ‡ãƒ«ã®éå­¦ç¿’ã¯èµ·ãã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://codeday.me/jp/qa/20181207/13787.html&quot;&gt;ï¼ˆMatplotlibã§ãƒ—ãƒ­ãƒƒãƒˆã‚’ä¸€æ—¦ã‚¯ãƒªã‚¢ã™ã‚‹ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;

&lt;p&gt;ä»Šå›ã¯ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ã«ã¤ã„ã¦æ‰±ã„ã¾ã—ãŸã€‚&lt;br /&gt;
ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€èª¤å·®é€†ä¼æ’­ãŒè‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€é †ä¼æ’­ã®å‡¦ç†ã ã‘è¨˜è¿°ã™ã‚Œã°ã‚ˆã„ã¨ã„ã†å¤§ããªãƒ¡ãƒªãƒƒãƒˆã‚’ä½“æ„Ÿã§ããŸã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡å›ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®ç¬¬6ç« ã«å¯¾å¿œã™ã‚‹ã€ã€Œå­¦ç¿’ã«é–¢ã™ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã€ã‚’Kerasã‚’ç”¨ã„ã¦å®Ÿè¨¼ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;</content><author><name></name></author><category term="ã€Œã‚¼ãƒ­ã‹ã‚‰Kerasã€ã‚·ãƒªãƒ¼ã‚º" /><summary type="html">ã¯ã˜ã‚ã«</summary></entry><entry xml:lang="ja_JP"><title type="html">ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆ3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ï¼† æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨ï¼‰</title><link href="http://localhost:4000/DL-Intro-2/" rel="alternate" type="text/html" title="ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆ3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ï¼† æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨ï¼‰" /><published>2019-04-19T00:00:00+09:00</published><updated>2019-04-19T00:00:00+09:00</updated><id>http://localhost:4000/DL-Intro-2</id><content type="html" xml:base="http://localhost:4000/DL-Intro-2/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;

&lt;p&gt;ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã€æ·±å±¤å­¦ç¿’ã®å…¥é–€æ›¸ã¨ã—ã¦æœ‰åãªã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã¨åŒæ™‚ä¸¦è¡Œã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å­¦ç¿’ã—ã€ãã®å®šç€ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å‰å›ã®&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ç¬¬ä¸€å¼¾: ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;ã«ç›®ã‚’é€šã—ã¦ã„ãªã„æ–¹ã¯ã€å…ˆã«ç›®ã‚’é€šã—ã¦ãŠãã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯ã€ä»Šå›ã¯3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’Kerasã§å®Ÿè£…ã—ã€å®Ÿéš›ã«æ‰‹æ›¸ãæ•°å­—èªè­˜ï¼ˆMNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡ï¼‰ã‚’ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ï¼ˆ3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P58ã€œ65&lt;br /&gt;
ï¼ˆMNISTï¼‰&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P72ã€œ81&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;link_box&quot;&gt;
    &lt;span class=&quot;box-title&quot;&gt;ã‚·ãƒªãƒ¼ã‚ºãƒªãƒ³ã‚¯&lt;/span&gt;
    &lt;p&gt;ç¬¬ä¸€å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äºŒå¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-2/&quot;&gt;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &amp;amp; æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨&lt;/a&gt;&lt;/p&gt;  
    &lt;p&gt;ç¬¬ä¸‰å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-3/&quot;&gt;ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬å››å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-4/&quot;&gt;å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äº”å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-5/&quot;&gt;ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;1-3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å®Ÿè£…&quot;&gt;1. 3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å®Ÿè£…&lt;/h2&gt;

&lt;h3 id=&quot;11-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&quot;&gt;1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&lt;/h3&gt;
&lt;p&gt;ã¾ãšã€3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å®Ÿè£…ç”¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚&lt;br /&gt;
ä»¥ä¸‹æœ¬ç« ã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;three_nn.py&lt;/code&gt;ã‚’ä½œæˆã™ã‚‹ã‚‚ã®ã¨ã—ã¦é€²ã‚ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;12-ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆ&quot;&gt;1.2 ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆ&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ä»Šå›ã®å®Ÿè£…ã‹ã‚‰ã¯å…¨ã¦Functional APIã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«å®Ÿè£…ã‚’è¡Œã„ã¾ã™ã€‚&lt;br /&gt;
Sequentialãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹å®Ÿè£…ã¯è¡Œã„ã¾ã›ã‚“ã®ã§ã€ã‚ã‚‰ã‹ã˜ã‚ã”äº†æ‰¿ãã ã•ã„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ã“ã‚Œã‹ã‚‰å®Ÿè£…ã™ã‚‹3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚å¿µå›³ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚&lt;br /&gt;
å®Ÿè£…ã®éš›ã®å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-04-19/three_layer_nn.png&quot; alt=&quot;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ¦‚å¿µå›³&quot; style=&quot;width: 500px;&quot; /&gt;
&lt;/div&gt;

&lt;h4 id=&quot;121-ãƒ¬ã‚¤ãƒ¤ãƒ¼--numpyã‚’èª­ã¿è¾¼ã‚€&quot;&gt;1.2.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼ &amp;amp; NumPyã‚’èª­ã¿è¾¼ã‚€&lt;/h4&gt;

&lt;p&gt;ã¾ãšã€å‰å›ã¨åŒã˜ã‚ˆã†ã«ã€å®Ÿè£…ã«å¿…è¦ãªãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨NumPyã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;122-å„ç¨®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©ã™ã‚‹&quot;&gt;1.2.2 å„ç¨®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©ã™ã‚‹&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;3å±¤ã®ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã®ã§ã€ãã‚Œã¨åŒæ•°ã®3ã¤ã®Denseãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;units&lt;/code&gt;ã¯å„å±¤ã«ãŠã‘ã‚‹ãƒ‹ãƒ¥ãƒ¼ãƒ­ãƒ³ã®æ•°ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ´»æ€§åŒ–é–¢æ•°ã«ã¤ã„ã¦ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;sigmoid&lt;/code&gt;é–¢æ•°ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã‚‚&lt;code class=&quot;highlighter-rouge&quot;&gt;sigmoid&lt;/code&gt;ã‚’æ´»ç”¨ã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ä¸‹ã®ä¾‹ã§ã¯ã€ç°¡å˜ã®ãŸã‚å…¥ã‚Œå­å¼ã«æ´»æ€§åŒ–é–¢æ•°ã‚’å®šç¾©ã—ã¾ã—ãŸãŒã€æ´»æ€§åŒ–é–¢æ•°ã‚’ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: center&quot;&gt;ï¼œæ´»æ€§åŒ–é–¢æ•°ã‚’å…¥ã‚Œå­å¼ã«å®šç¾©ã™ã‚‹ä¾‹ï¼&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_layer1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_layer2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_layer1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_layer2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div style=&quot;text-align: center&quot;&gt;ï¼œæ´»æ€§åŒ–é–¢æ•°ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦å®šç¾©ã™ã‚‹ä¾‹ï¼&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_layer1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_activ1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_layer1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_layer2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_activ1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_activ2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_layer2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_activ2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/activations/&quot;&gt;https://keras.io/ja/activations/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;123-ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&quot;&gt;1.2.3 ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;å‰å›ã¨åŒæ§˜ã«ã€å…¥åŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã¨å‡ºåŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚’&lt;code class=&quot;highlighter-rouge&quot;&gt;Model&lt;/code&gt;ã«æ¸¡ã™ã“ã¨ã§ã€ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;model.summary()&lt;/code&gt;ã§ãƒ¢ãƒ‡ãƒ«ã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ãƒ¢ãƒ‡ãƒ«ã®çŠ¶æ…‹ã‚’ã¿ã‚‹
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 2)                 0
_________________________________________________________________
dense_1 (Dense)              (None, 3)                 9
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 8
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 6
=================================================================
Total params: 23
Trainable params: 23
Non-trainable params: 0
_________________________________________________________________
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;124-é‡ã¿ã‚’è¨­å®šã™ã‚‹&quot;&gt;1.2.4 é‡ã¿ã‚’è¨­å®šã™ã‚‹&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã§ã¯é‡ã¿ã®åˆæœŸåŒ–ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã®ã§ã€æœ¬å®Ÿè£…ã§ã‚‚äº‹å‰ã«é‡ã¿ã‚’è¨­å®šã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Kerasã§ã¯ã€é‡ã¿ã¯å…¥åŠ›å±¤ã‹ã‚‰é †ã«NumPyã®é…åˆ—ã§ä¿æŒã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;br /&gt;
ã—ãŸãŒã£ã¦ã€é‡ã¿ã‚’è¨­å®šã™ã‚‹éš›ã«ã¯ã€é †å½“ã«é‡ã¿ã®é…åˆ—ã‚’NumPyé…åˆ—ã§å®šç¾©ã—ã¦ã€ãã®ãƒªã‚¹ãƒˆã‚’æ¸¡ã›ã°ã‚ˆã„ã§ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é‡ã¿ã®è¨­å®šã«ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;model.set_weights()&lt;/code&gt;ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚&lt;br /&gt;
å¼•æ•°ã¯é‡ã¿ã®å…¥ã£ãŸãƒªã‚¹ãƒˆã§ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;w2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;w3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;weight_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: ã‚¼ãƒ­ã‹ã‚‰ã€œ P65&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[array([[0.1, 0.3, 0.5], [0.2, 0.4, 0.6]], dtype=float32), 
    array([0.1, 0.2, 0.3], dtype=float32), 
    array([[0.1, 0.4], [0.2, 0.5], [0.3, 0.6]], dtype=float32), 
    array([0.1, 0.2], dtype=float32), 
    array([[0.1, 0.3], [0.2, 0.4]], dtype=float32), 
    array([0.1, 0.2], dtype=float32)]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;13-ãƒ†ã‚¹ãƒˆã™ã‚‹&quot;&gt;1.3 ãƒ†ã‚¹ãƒˆã™ã‚‹&lt;/h3&gt;
&lt;p&gt;ãã‚Œã§ã¯ã€ä½œæˆã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚&lt;br /&gt;
ä½œæˆã—ãŸãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆã«ã¯ã€å‰å›ã¨åŒæ§˜ã«ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;model.predict()&lt;/code&gt;ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œ P65ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¨åŒä¸€ã®ã‚‚ã®ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[[0.3168271 0.6962791]]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è¦‹äº‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œ P65ã«ç¤ºã•ã‚Œã¦ã„ã‚‹å‡ºåŠ›å€¤ã¨åŒä¸€ã®å€¤ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼&lt;/p&gt;

&lt;div class=&quot;inner_ads&quot;&gt;
    &lt;div class=&quot;left_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022749.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22749&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt; 
    &lt;div class=&quot;right_ad_in&quot;&gt;
        &lt;a href=&quot;//af.moshimo.com/af/c/click?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&amp;amp;guid=ON&quot; target=&quot;_blank&quot; rel=&quot;nofollow&quot;&gt;&lt;img src=&quot;//image.moshimo.com/af-img/0866/000000022750.jpg&quot; width=&quot;300&quot; height=&quot;250&quot; style=&quot;border:none;&quot; /&gt;&lt;/a&gt;&lt;img src=&quot;//i.moshimo.com/af/i/impression?a_id=1502939&amp;amp;p_id=1555&amp;amp;pc_id=2816&amp;amp;pl_id=22750&quot; width=&quot;1&quot; height=&quot;1&quot; style=&quot;border:none;&quot; /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&quot;2-æ‰‹æ›¸ãæ•°å­—èªè­˜mnist&quot;&gt;2. æ‰‹æ›¸ãæ•°å­—èªè­˜ï¼ˆMNISTï¼‰&lt;/h2&gt;

&lt;p&gt;ã“ã“ã‹ã‚‰ã¯ã€ä»Šå®Ÿè£…ã—ãŸ3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã—ã¦ã€æ‰‹æ›¸ãæ•°å­—ã‚’å®Ÿéš›ã«åˆ†é¡ã—ã¦ã„ãã¾ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P72ã€œ81&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;21-mnistãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿&quot;&gt;2.1 MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿&lt;/h2&gt;
&lt;p&gt;Kerasã§ã¯ã€MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ç°¡å˜ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰&amp;amp;å‘¼ã³å‡ºã—ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mnist_nn.py&lt;/code&gt;ã‚’ä½œæˆã—ã¦ã€ä»¥ä¸‹ã‚’å…¥åŠ›ã—å‹•ä½œã•ã›ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: &lt;a href=&quot;https://keras.io/ja/datasets/#mnist&quot;&gt;https://keras.io/ja/datasets/#mnist&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(60000, 28, 28)
(60000,)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;strong&gt;æ³¨æ„&lt;/strong&gt;) Kerasã®&lt;code class=&quot;highlighter-rouge&quot;&gt;mnist.load_data()&lt;/code&gt;ã¯ã€ã€Œæ­£è¦åŒ–ã•ã‚Œã¦ã„ãªã„ &amp;amp; 2æ¬¡å…ƒé…åˆ—ã€ã®çŠ¶æ…‹ã®ãƒªã‚¹ãƒˆãŒè¿”ã£ã¦ãã¾ã™ã€‚ã‚¼ãƒ­ã‹ã‚‰ã€œã®P73ã®æŒ™å‹•ã¨ã¯ç•°ãªã‚‹ã®ã§ã€æ³¨æ„ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒ&lt;code class=&quot;highlighter-rouge&quot;&gt;train&lt;/code&gt;ã¨&lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt;ã®äºŒã¤ã«åˆ†å‰²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ°—ãŒã¤ãã¨æ€ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€æ©Ÿæ¢°å­¦ç¿’ã«ãŠã„ã¦ã¯ãƒ¢ãƒ‡ãƒ«ã®æ±åŒ–æ€§èƒ½ã‚’æ¸¬å®šã™ã‚‹ãŸã‚ã«ã€é€šå¸¸ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®äºŒã¤ï¼ˆã‚‚ã—ãã¯ãã‚Œä»¥ä¸Šï¼‰ã«åˆ†å‰²ã™ã‚‹ãŸã‚ã§ã™ã€‚è©³ã—ãã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®ç¬¬4ç« ã‚’è¦‹ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;h3 id=&quot;22-ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å‰å‡¦ç†&quot;&gt;2.2 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å‰å‡¦ç†&lt;/h3&gt;
&lt;p&gt;ãƒ¢ãƒ‡ãƒ«ã®æ¨è«–å‡¦ç†ã«ãŠã„ã¦MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ´»ç”¨ã™ã‚‹ã®ã§ã€ã€Œæ­£è¦åŒ– &amp;amp; ä¸€æ¬¡å…ƒé…åˆ—åŒ–ã€ã®å‡¦ç†ã‚’è¡Œã£ã¦ãŠãã¾ã™ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;é…åˆ—ã®å½¢çŠ¶å¤‰æ›ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;.reshape&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œãˆã¾ã™ã€‚&lt;br /&gt;
å¼•æ•°ã¯å¤‰æ›å¾Œã®é…åˆ—å½¢çŠ¶ã§ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;æ­£è¦åŒ–å‡¦ç†ã®ãŸã‚ã«ã€ãƒªã‚¹ãƒˆã‚’floatå‹ã«å¤‰æ›ã—ã¾ã™ã€‚&lt;br /&gt;
å‹å¤‰æ›ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;.astype&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œãˆã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# ä¸€æ¬¡å…ƒé…åˆ—ã«ã™ã‚‹
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# æ­£è¦åŒ–å‡¦ç†
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'float'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;255.&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;(60000, 784)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;ãã¡ã‚“ã¨ä¸€æ¬¡å…ƒé…åˆ—ã«å¤‰æ›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚&lt;br /&gt;
æ­£è¦åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã¯ã€é…åˆ—ã®è¦ç´ ã®ã†ã¡ä¸€ã¤ã‚’è¡¨ç¤ºã•ã›ã¦ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;h3 id=&quot;22-ãƒ¢ãƒ‡ãƒ«ã®æ”¹è‰¯&quot;&gt;2.2 ãƒ¢ãƒ‡ãƒ«ã®æ”¹è‰¯&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;three_nn.py&lt;/code&gt;ã§MNISTã‚’åˆ†é¡ã§ãã‚‹ã‚ˆã†ã«ã€ä»¥ä¸‹ã®2ç‚¹ã‚’æ”¹è‰¯ã—ã¾ã™ã€‚ &lt;br /&gt;
æ”¹è‰¯ã—ãŸã‚‚ã®ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;mnist_nn.py&lt;/code&gt;ã«è¿½è¨˜ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã®P76ã¨åˆã‚ã›ã¦ã€ä¸€å±¤ç›®ã®å…¨çµåˆå±¤ã®unitæ•°ã‚’50ã€äºŒå±¤ç›®ã‚’100ã¨ã—ã€å‡ºåŠ›å±¤ã¯10ã¨ã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡ã¯ã€Œ&lt;strong&gt;åˆ†é¡å•é¡Œ&lt;/strong&gt;ã€ã§ã‚ã‚‹ãŸã‚ã€å‡ºåŠ›å±¤ã«softmaxå±¤ã‚’è¿½åŠ ã—ã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;784&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sigmoid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Activation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'softmax'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ãƒ¢ãƒ‡ãƒ«ã®çŠ¶æ…‹ã‚’ã¿ã‚‹
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 784)               0
_________________________________________________________________
dense_1 (Dense)              (None, 50)                39250
_________________________________________________________________
dense_2 (Dense)              (None, 100)               5100
_________________________________________________________________
dense_3 (Dense)              (None, 10)                1010
_________________________________________________________________
activation_1 (Activation)    (None, 10)                0
=================================================================
Total params: 45,360
Trainable params: 45,360
Non-trainable params: 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ãã¡ã‚“ã¨æœ›ã¿ã®ãƒ¢ãƒ‡ãƒ«ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ã“ã“ã§ã€ä¸­é–“å±¤ã®å®šç¾©æ–¹æ³•ã«ã¤ã„ã¦ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;three_nn.py&lt;/code&gt;ã¨æ›¸ãæ–¹ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã¨æ°—ã¥ã„ãŸæ–¹ã‚‚ã„ã‚‹ã§ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;p&gt;Functional APIã‚’ç”¨ã„ãŸãƒ¢ãƒ‡ãƒ«å®šç¾©ã§ã¯ã€å‰å›ç´¹ä»‹ã—ãŸã‚ˆã†ã«ã€å…¥åŠ›ã¨å‡ºåŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚’å€‹åˆ¥ã«ä¿æŒã—ã¦ãŠã‘ã°è‰¯ã„ãƒ«ãƒ¼ãƒ«ã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã—ãŸãŒã£ã¦ã€ä¸­é–“ã®ãƒ™ã‚¯ãƒˆãƒ«ã«é–¢ã—ã¦ã¯ç‰¹æ®µåˆ©ç”¨ã—ãŸã„ã‚±ãƒ¼ã‚¹ãŒãªã„é™ã‚Šã¯ã€åŒä¸€ã®å¤‰æ•°ã‚’åˆ©ç”¨ã—ãŸæ–¹ãŒã€ã‚³ãƒ¼ãƒ‰ãŒç…©é›‘ã«ãªã‚‰ãªã„ã®ã§ãŠã™ã™ã‚ã§ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;23-é‡ã¿ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿&quot;&gt;2.3 é‡ã¿ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿&lt;/h3&gt;
&lt;p&gt;é‡ã¿ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®ã‚‚ã®ã¨åŒä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/oreilly-japan/deep-learning-from-scratch/tree/master/ch03&quot;&gt;å…¬å¼ãƒ¬ãƒã‚¸ãƒˆãƒª&lt;/a&gt;ã‹ã‚‰ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;sample_weight.pkl&lt;/code&gt;ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mnist_nn.py&lt;/code&gt;ã¨åŒä¸€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«&lt;code class=&quot;highlighter-rouge&quot;&gt;sample_weight.pkl&lt;/code&gt;ã‚’é…ç½®ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ä»¥ä¸‹ãŒã€é‡ã¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ãªã‚Šã¾ã™ã€‚&lt;br /&gt;
ãªãŠã€ä»Šå›ã¯ã€Œæ¨è«–å‡¦ç†ã®ã¿è¡Œã† &amp;amp; ã§ãã‚‹é™ã‚Šã‚¼ãƒ­ã‹ã‚‰ã€œã«å³ã—ãŸã‚‚ã®ã«ã™ã‚‹ã€ãŸã‚ã«ã€ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ãŒã€ã“ã®ã‚ˆã†ãªæ‰‹é–“ã®ã‹ã‹ã‚‹åˆæœŸåŒ–å‡¦ç†ã¯é€šå¸¸è¡Œã„ã¾ã›ã‚“ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'sample_weight.pkl'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weight_array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'W1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'b1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
                        &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'W2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'b2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'W3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'b3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight_array&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_weight&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/getting-started/faq/#keras-model&quot;&gt;Kerasã§ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜/ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã†&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;24-ãƒ†ã‚¹ãƒˆã™ã‚‹&quot;&gt;2.4 ãƒ†ã‚¹ãƒˆã™ã‚‹&lt;/h3&gt;
&lt;p&gt;ãã‚Œã§ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P77ã¨åŒæ§˜ã«å®Ÿè£…ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;np.argmax&lt;/code&gt;ã§è»¸(axis)æŒ‡å®šã‚’ã—ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã¯ãƒªã‚¹ãƒˆãŒ2æ¬¡å…ƒé…åˆ—ä»¥ä¸Šã®ã¨ãã«ã€ã€Œã©ã®è»¸æ–¹å‘ã«å¯¾ã—ã¦æ¼”ç®—ã‚’è¡Œã†ã‹ã€ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã«æ´»ç”¨ã—ã¾ã™ã€‚&lt;br /&gt;
è»¸æŒ‡å®šã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€&lt;a href=&quot;https://deepage.net/features/numpy-axis.html&quot;&gt;ã“ã®ãƒšãƒ¼ã‚¸&lt;/a&gt;ã‚’å‚ç…§ã™ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;_y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Accuracy: {np.sum(y_test == _y_test) / len(y_test)}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Output:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Accuracy: 0.9352
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã‚ã§ãŸãã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P77ã«ç¤ºã•ã‚Œã¦ã„ã‚‹åˆ†é¡ç²¾åº¦: 0.9352ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;

&lt;p&gt;ä»Šå›ã¯ã‚¼ãƒ­ã‹ã‚‰ã€œã®3ç« ã«å¯¾å¿œã™ã‚‹éƒ¨åˆ†ã§ã‚ã‚‹ã€3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆã¨MNISTãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ†é¡ã‚’Kerasã§å®Ÿè£…ã—ã¾ã—ãŸã€‚ 
æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ãŸã£ãŸæ•°è¡Œã§ã‚¼ãƒ­ã‹ã‚‰ã€œã«ã‚ã‚‹ã‚‚ã®ã¨åŒä¸€ã®ãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè£…ã§ãã‚‹ã“ã¨ã‚’å®Ÿæ„Ÿã—ãŸã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡å›ã‹ã‚‰ã¯ã‚¼ãƒ­ã‹ã‚‰ã€œã®4ç« ä»¥é™ã«å¯¾å¿œã™ã‚‹ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ã«å…¥ã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;</content><author><name></name></author><category term="ã€Œã‚¼ãƒ­ã‹ã‚‰Kerasã€ã‚·ãƒªãƒ¼ã‚º" /><summary type="html">ã¯ã˜ã‚ã«</summary></entry><entry xml:lang="ja_JP"><title type="html">ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨ï¼‰</title><link href="http://localhost:4000/DL-Intro-1/" rel="alternate" type="text/html" title="ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã¨ã¨ã‚‚ã«å­¦ã¶ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨ï¼‰" /><published>2019-04-13T00:00:00+09:00</published><updated>2019-04-13T00:00:00+09:00</updated><id>http://localhost:4000/DL-Intro-1</id><content type="html" xml:base="http://localhost:4000/DL-Intro-1/">&lt;h2 id=&quot;ã¯ã˜ã‚ã«&quot;&gt;ã¯ã˜ã‚ã«&lt;/h2&gt;

&lt;p&gt;ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã€ã¯æ·±å±¤å­¦ç¿’ã‚’å­¦ã¶å…¥é–€æ›¸ã¨ã—ã¦éå¸¸ã«äººæ°—ãŒã‚ã‚Šã€æ§˜ã€…ãªå ´æ‰€ã§ç”¨ã„ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã—ã‹ã—ãªãŒã‚‰ã€ã€Œãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ãªã„ã§æ·±å±¤å­¦ç¿’ã®åŸºç¤ã‚’å­¦ã¶ã€ã¨ã„ã†æœ¬ã®ç›®çš„ã«ã‚ˆã‚Šã€æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«é–¢ã™ã‚‹å†…å®¹ã¯è§¦ã‚Œã‚‰ã‚Œã¦ã„ã¾ã›ã‚“ã€‚&lt;/p&gt;

&lt;p&gt;ãã®ãŸã‚ã€èª­è€…ã®ä¸­ã«ã¯å®Ÿéš›ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ãŸæ©Ÿæ¢°å­¦ç¿’ã®å‹‰å¼·ã¸ã¨ç¹‹ã’ã‚‹æ©Ÿä¼šã‚„æ°—åŠ›ã‚’å¤±ã£ã¦ã—ã¾ã£ãŸäººã‚‚å°‘ãªã‹ã‚‰ãšã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã€Œã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learningã€ï¼ˆä»¥ä¸‹ã€ã‚¼ãƒ­ã‹ã‚‰ã€œï¼‰ã‚’å­¦ç¿’ã—ã¤ã¤ã€æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ä¸€ã¤ã§ã‚ã‚‹ã€Kerasã«ã¤ã„ã¦å­¦ã‚“ã§ã„ãã¾ã™ã€‚&lt;br /&gt;
ã“ã‚Œã«ã‚ˆã‚Šã€æ·±å±¤å­¦ç¿’ã®åŸºç¤ã‚’ç†è§£ã—ã¤ã¤ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ´»ç”¨ã—ãŸå®Ÿè£…æ–¹æ³•ã«ã¤ã„ã¦å­¦ã¶ã“ã¨ãŒã§ãã¾ã™ï¼&lt;/p&gt;

&lt;p&gt;ãã‚Œã§ã¯ã€ã¾ãšã¯Kerasã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰å§‹ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;div class=&quot;link_box&quot;&gt;
    &lt;span class=&quot;box-title&quot;&gt;ã‚·ãƒªãƒ¼ã‚ºãƒªãƒ³ã‚¯&lt;/span&gt;
    &lt;p&gt;ç¬¬ä¸€å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-1/&quot;&gt;ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äºŒå¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-2/&quot;&gt;3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ &amp;amp; æ‰‹æ›¸ãæ•°å­—èªè­˜ç·¨&lt;/a&gt;&lt;/p&gt;  
    &lt;p&gt;ç¬¬ä¸‰å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-3/&quot;&gt;ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å­¦ç¿’ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬å››å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-4/&quot;&gt;å­¦ç¿’ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
    &lt;p&gt;ç¬¬äº”å¼¾ï¼š&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;&lt;a href=&quot;https://gucci-j.github.io/DL-Intro-5/&quot;&gt;ç•³ã¿è¾¼ã¿ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç·¨&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;!-- START MoshimoAffiliateEasyLink --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
(function(b,c,f,g,a,d,e){b.MoshimoAffiliateObject=a;
b[a]=b[a]||function(){arguments.currentScript=c.currentScript
||c.scripts[c.scripts.length-2];(b[a].q=b[a].q||[]).push(arguments)};
c.getElementById(a)||(d=c.createElement(f),d.src=g,
d.id=a,e=c.getElementsByTagName(&quot;body&quot;)[0],e.appendChild(d))})
(window,document,&quot;script&quot;,&quot;//dn.msmstatic.com/site/cardlink/bundle.js&quot;,&quot;msmaflink&quot;);
msmaflink({&quot;n&quot;:&quot;ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Deep Learning â€•Pythonã§å­¦ã¶ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®ç†è«–ã¨å®Ÿè£…&quot;,&quot;b&quot;:&quot;&quot;,&quot;t&quot;:&quot;&quot;,&quot;d&quot;:&quot;https:\/\/images-fe.ssl-images-amazon.com&quot;,&quot;c_p&quot;:&quot;\/images\/I&quot;,&quot;p&quot;:[&quot;\/512ru2i5gyL.jpg&quot;,&quot;\/51Z7TzDuljL.jpg&quot;,&quot;\/51Dzt-P86rL.jpg&quot;,&quot;\/51VfxOvKEwL.jpg&quot;,&quot;\/51dNlTr6a7L.jpg&quot;,&quot;\/51RfBXWcDAL.jpg&quot;,&quot;\/415IXnDy3IL.jpg&quot;,&quot;\/415VCPaFk1L.jpg&quot;,&quot;\/410OtMHeqkL.jpg&quot;,&quot;\/41F7PYraodL.jpg&quot;,&quot;\/41TFOjFQtaL.jpg&quot;,&quot;\/51SRdr-iBHL.jpg&quot;,&quot;\/51yxT9nEC4L.jpg&quot;,&quot;\/51q0zWV9NnL.jpg&quot;,&quot;\/51MDmgZZ2cL.jpg&quot;,&quot;\/51n9f4IpDZL.jpg&quot;,&quot;\/51erDZNc9tL.jpg&quot;,&quot;\/41qOS5gPctL.jpg&quot;,&quot;\/51wDA5ZuAeL.jpg&quot;,&quot;\/51Fg67TMeCL.jpg&quot;,&quot;\/51KCmWaOqFL.jpg&quot;,&quot;\/51e5o3xlSTL.jpg&quot;,&quot;\/51RF7CQIW1L.jpg&quot;,&quot;\/514m0GkYReL.jpg&quot;,&quot;\/516bqTekHoL.jpg&quot;,&quot;\/41colcboiNL.jpg&quot;,&quot;\/51IRqvCxzAL.jpg&quot;,&quot;\/51mFjvDorhL.jpg&quot;,&quot;\/51BQcHSo5QL.jpg&quot;,&quot;\/51THHJTIaTL.jpg&quot;,&quot;\/51PzJ4B%2BhtL.jpg&quot;,&quot;\/51CRA6FoSLL.jpg&quot;,&quot;\/41M5Qzg1yXL.jpg&quot;,&quot;\/51iMy2fgPkL.jpg&quot;,&quot;\/41xe6JIHELL.jpg&quot;,&quot;\/41HYfr%2Bv%2BKL.jpg&quot;,&quot;\/41gRFTsmr%2BL.jpg&quot;,&quot;\/51fD5k24M8L.jpg&quot;,&quot;\/518%2B8E-OZeL.jpg&quot;,&quot;\/41iyTyjjgdL.jpg&quot;,&quot;\/51L6s8Uo8aL.jpg&quot;,&quot;\/41xHQHIOQ2L.jpg&quot;,&quot;\/51ZWyzq1L3L.jpg&quot;,&quot;\/51oDwhT1gcL.jpg&quot;,&quot;\/51Zu5NuGq2L.jpg&quot;,&quot;\/512VUPnG69L.jpg&quot;,&quot;\/41Ufnm15s9L.jpg&quot;,&quot;\/41nALw08xcL.jpg&quot;,&quot;\/51uZB7hP-xL.jpg&quot;,&quot;\/41Qi%2BzskZHL.jpg&quot;,&quot;\/51p3s1TTn4L.jpg&quot;,&quot;\/413xgCPJnzL.jpg&quot;,&quot;\/51mc1fX%2B7xL.jpg&quot;,&quot;\/51GLiuSVtbL.jpg&quot;,&quot;\/419bmxhHV9L.jpg&quot;,&quot;\/5100WGZVi6L.jpg&quot;],&quot;u&quot;:{&quot;u&quot;:&quot;https:\/\/www.amazon.co.jp\/%E3%82%BC%E3%83%AD%E3%81%8B%E3%82%89%E4%BD%9C%E3%82%8BDeep-Learning-%E2%80%95Python%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%82%A3%E3%83%BC%E3%83%97%E3%83%A9%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%AE%E7%90%86%E8%AB%96%E3%81%A8%E5%AE%9F%E8%A3%85-%E6%96%8E%E8%97%A4-%E5%BA%B7%E6%AF%85\/dp\/4873117585&quot;,&quot;t&quot;:&quot;amazon&quot;,&quot;r_v&quot;:&quot;&quot;},&quot;aid&quot;:{&quot;amazon&quot;:&quot;1430714&quot;,&quot;rakuten&quot;:&quot;1430719&quot;,&quot;yahoo&quot;:&quot;1430721&quot;}});
&lt;/script&gt;

&lt;!-- MoshimoAffiliateEasyLink END --&gt;

&lt;h2 id=&quot;1-kerasã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&quot;&gt;1. Kerasã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h2&gt;
&lt;p&gt;(&lt;strong&gt;æ³¨æ„&lt;/strong&gt;) æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã™ã§ã«Pythonã‚„NumPyç­‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯çµ‚ãˆã¦ã„ã‚‹ã‚‚ã®ã¨ã—ã¦ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™ã€‚&lt;br /&gt;
ç’°å¢ƒæ•´å‚™ãŒãŠæ¸ˆã¿ã§ãªã„æ–¹ã¯ã€å…ˆã«ã‚¼ãƒ­ã‹ã‚‰ã€œã®ä¸€ç« ã‚’å‚è€ƒã«æ¸ˆã¾ã›ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ãƒ»ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ä¸Šã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦Kerasã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install keras
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/&quot;&gt;https://keras.io/ja/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;2-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&quot;&gt;2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ&lt;/h2&gt;

&lt;p&gt;ãŠå¥½ããªç’°å¢ƒã§ã‚¼ãƒ­ã‹ã‚‰ã€œäºŒç« ç”¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;p&gt;ãŸã ã—ã€ã“ã“ã§ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;sequential.py&lt;/code&gt;ã¨&lt;code class=&quot;highlighter-rouge&quot;&gt;functional.py&lt;/code&gt;ã®äºŒã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã¨ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;3-ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆ--ãƒ†ã‚¹ãƒˆ&quot;&gt;3. ãƒ¢ãƒ‡ãƒ«ã®ä½œæˆ &amp;amp; ãƒ†ã‚¹ãƒˆ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Kerasã«ã¯Sepuentialãƒ¢ãƒ‡ãƒ«ã¨Functional APIã®2ç¨®é¡ã®ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚
    &lt;ul&gt;
      &lt;li&gt;Sepuentialãƒ¢ãƒ‡ãƒ«ï¼šæ§˜ã€…ãªå±¤ã‚’ç©ã¿æœ¨ã®ã‚ˆã†ã«ç©ã¿é‡ã­ã¦ã„ãã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚ç·šå½¢ã‚¹ã‚¿ãƒƒã‚¯ã€‚&lt;/li&gt;
      &lt;li&gt;Functionalãƒ¢ãƒ‡ãƒ«ï¼šå±¤ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦æ‰±ã†ã€‚è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹ã¨ãã«ä¾¿åˆ©ã€‚&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ãã‚Œãã‚Œã®ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©æ–¹æ³•ã®é•ã„ã‚’ä»¥ä¸‹ã§è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;31-sequential-ãƒ¢ãƒ‡ãƒ«&quot;&gt;3.1 Sequential ãƒ¢ãƒ‡ãƒ«&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Sequentialãƒ¢ãƒ‡ãƒ«ã§ANDã‚²ãƒ¼ãƒˆã®ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;sequential.py&lt;/code&gt;ã«ä»¥ä¸‹ã®ã‚½ãƒ¼ã‚¹ã‚’é †ã«æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;311-ãƒ¬ã‚¤ãƒ¤ãƒ¼--numpyã‚’èª­ã¿è¾¼ã‚€&quot;&gt;3.1.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼ + NumPyã‚’èª­ã¿è¾¼ã‚€&lt;/h4&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;312-modelã«sepuentialãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&quot;&gt;3.1.2 &lt;code class=&quot;highlighter-rouge&quot;&gt;model&lt;/code&gt;ã«Sepuentialãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&lt;/h4&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Sequential&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;313-modelã«denseå±¤å…¨çµåˆå±¤ã‚’è¿½åŠ ã™ã‚‹&quot;&gt;3.1.3 &lt;code class=&quot;highlighter-rouge&quot;&gt;model&lt;/code&gt;ã«Denseå±¤ï¼ˆå…¨çµåˆå±¤ï¼‰ã‚’è¿½åŠ ã™ã‚‹&lt;/h4&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;å…¨çµåˆå±¤ã¨ã„ã†ç”¨èªã¯ã‚¼ãƒ­ã‹ã‚‰ã€œã®äºŒç« ã«ã¯ç™»å ´ã—ã¦ã„ã¾ã›ã‚“ãŒã€ã“ã“ã§ã¯å˜ç´”ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã¨åŒã˜ã¨æ€ã£ã¦ãã ã•ã„ã€‚&lt;br /&gt;
å‚è€ƒç¨‹åº¦ã«ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;input_dim=2, units=1&lt;/code&gt;ã®ã¨ãã®Denseå±¤ã®æ§˜å­ã‚’æ¦‚å¿µå›³ã«ã—ãŸã‚‚ã®ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div style=&quot;text-align: center;&quot;&gt;
    &lt;img src=&quot;/resources/2019-04-13/example_dense.png&quot; alt=&quot;Denseå±¤ã®æ§˜å­ã®æ¦‚å¿µå›³&quot; style=&quot;width: 450px;&quot; /&gt;
&lt;/div&gt;

&lt;h4 id=&quot;314-modelã«é‡ã¿ã‚’ä¸ãˆã‚‹&quot;&gt;3.1.4 &lt;code class=&quot;highlighter-rouge&quot;&gt;model&lt;/code&gt;ã«é‡ã¿ã‚’ä¸ãˆã‚‹&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ã‚¼ãƒ­ã‹ã‚‰ã€œã®äºŒç« ã§ã¯äºˆã‚é‡ã¿ã¨ãƒã‚¤ã‚¢ã‚¹ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€ã“ã®å®Ÿè£…ã§ã‚‚ä¸ãˆã¾ã™ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é‡ã¿ã¨ãƒã‚¤ã‚¢ã‚¹ã®åˆæœŸè¨­å®šã«ã¯ã€&lt;code class=&quot;highlighter-rouge&quot;&gt;model.set_weights()&lt;/code&gt;ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚&lt;br /&gt;
å¼•æ•°ã¯é‡ã¿ã®å…¥ã£ãŸãƒªã‚¹ãƒˆã§ã™ã€‚&lt;/p&gt;
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;blockquote&gt;
      &lt;p&gt;&lt;i class=&quot;fas fa-book-open&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚ç…§: ã‚¼ãƒ­ã‹ã‚‰ã€œã®P27&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;315-ãƒ†ã‚¹ãƒˆã™ã‚‹&quot;&gt;3.1.5 ãƒ†ã‚¹ãƒˆã™ã‚‹&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;ãƒ¢ãƒ‡ãƒ«ã®ãƒ†ã‚¹ãƒˆã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;predict&lt;/code&gt;ãƒ¡ã‚½ãƒƒãƒ‰ã§è¡Œãˆã¾ã™ã€‚&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;predict&lt;/code&gt;ã®è¿”ã‚Šå€¤ã¯ã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®äºˆæ¸¬çµæœã®ãƒªã‚¹ãƒˆã«ãªã£ã¦ã„ã¾ã™ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ã“ã®çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã¯ãšã§ã™ã€‚&lt;br /&gt;
Output:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[[-0.7       ]
 [-0.19999999]
 [-0.19999999]
 [ 0.3       ]]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;ã“ã‚Œã§ã¯ã‚ã‹ã‚Šã«ãã„ã®ã§ã€ãƒã‚¤ãƒŠã‚¹ã®ã‚‚ã®ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;False&lt;/code&gt;ã§ã€ãƒ—ãƒ©ã‚¹ã®ã‚‚ã®ã¯&lt;code class=&quot;highlighter-rouge&quot;&gt;True&lt;/code&gt;ã«ç½®ãæ›ãˆã¾ã™ã€‚
    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;False&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Results: {Y == Y_}'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;ä»¥ä¸‹ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚ŒãŸã¨æ€ã„ã¾ã™ã€‚&lt;br /&gt;
è¦‹äº‹ANDã‚²ãƒ¼ãƒˆãŒå®Ÿè£…ã§ãã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã­ã€‚&lt;br /&gt;
Output:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[[0.]
 [0.]
 [0.]
 [1.]]
Results: [[ True]
 [ True]
 [ True]
 [ True]]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;32-fucntional-api&quot;&gt;3.2 Fucntional API&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Functional APIã§ANDã‚²ãƒ¼ãƒˆã®ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;functional.py&lt;/code&gt;ã«ä»¥ä¸‹ã®ã‚½ãƒ¼ã‚¹ã‚’é †ã«æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;321-ãƒ¬ã‚¤ãƒ¤ãƒ¼--numpyã‚’èª­ã¿è¾¼ã‚€&quot;&gt;3.2.1 ãƒ¬ã‚¤ãƒ¤ãƒ¼ + NumPyã‚’èª­ã¿è¾¼ã‚€&lt;/h4&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.layers&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;322-å„ç¨®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©ã™ã‚‹&quot;&gt;3.2.2 å„ç¨®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å®šç¾©ã™ã‚‹&lt;/h4&gt;
&lt;p&gt;Functional APIã§ã¯ã€å…¥åŠ›å±¤ã‚’è¿½åŠ ã§å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Denseéƒ¨åˆ†ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã¯ã€Denseãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã€ãã®å…¥åŠ›ã¨ã—ã¦ã€ãƒ†ãƒ³ã‚½ãƒ«ï¼š_inputã‚’ä¸ãˆã‚‹ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚å‡ºåŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã¯_outputã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;323-ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&quot;&gt;3.2.3 ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹&lt;/h4&gt;
&lt;p&gt;ä»¥ä¸‹ã®ã‚ˆã†ã«ã€Functional APIã§ã¯ã€ãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹éš›ã«å…¥åŠ›ã¨å‡ºåŠ›ã®ãƒ†ãƒ³ã‚½ãƒ«ã‚’åˆ¥ã€…ã«ä¿æŒã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ï¼&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
  &lt;p&gt;&lt;i class=&quot;fas fa-link&quot; style=&quot;padding: 0 2px 0 0;&quot;&gt;&lt;/i&gt;å‚è€ƒ: &lt;a href=&quot;https://keras.io/ja/getting-started/functional-api-guide/&quot;&gt;https://keras.io/ja/getting-started/functional-api-guide/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&quot;324-é‡ã¿ã‚’ä¸ãˆã‚‹--ãƒ†ã‚¹ãƒˆã™ã‚‹&quot;&gt;3.2.4 é‡ã¿ã‚’ä¸ãˆã‚‹ &amp;amp; ãƒ†ã‚¹ãƒˆã™ã‚‹&lt;/h4&gt;
&lt;p&gt;Sequentialãƒ¢ãƒ‡ãƒ«ã¨åŒã˜ãªã®ã§å‰²æ„›ã—ã¾ã™ã€‚&lt;br /&gt;
çµæœãŒåŒä¸€ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã¨ã‚ˆã„ã§ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚&quot;&gt;ã¾ã¨ã‚&lt;/h2&gt;

&lt;p&gt;ä»Šå›ã¯ã€ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã«ã‚ˆã‚‹ANDã‚²ãƒ¼ãƒˆã®å®Ÿè£…ã‚’Kerasã«ã‚ˆã‚Šè¡Œã„ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Kerasã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šã€Œç°¡å˜ã«&amp;amp;æŠ½è±¡çš„ã«ã€ãƒ‘ãƒ¼ã‚»ãƒ—ãƒˆãƒ­ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒç¢ºèªã§ããŸã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;æ¬¡å›ã¯ã€3å±¤ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å®Ÿè£…ã‚’è¡Œã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç™ºå±•èª²é¡Œ&quot;&gt;ç™ºå±•èª²é¡Œ&lt;/h2&gt;

&lt;p&gt;NAND, ORã‚²ãƒ¼ãƒˆã‚‚å®Ÿè£…ã—ã¦ã¿ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚&lt;br /&gt;
é‡ã¿ã¨ãƒã‚¤ã‚¢ã‚¹ã¯ã€ã‚¼ãƒ­ã‹ã‚‰ã€œã®P27,28ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&quot;&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã€&lt;a href=&quot;https://github.com/gucci-j/intro-deep-learning-keras&quot;&gt;GitHub&lt;/a&gt;ã«ã¦å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;</content><author><name></name></author><category term="ã€Œã‚¼ãƒ­ã‹ã‚‰Kerasã€ã‚·ãƒªãƒ¼ã‚º" /><summary type="html">ã¯ã˜ã‚ã«</summary></entry><entry xml:lang="ja_JP"><title type="html">è«–æ–‡ãƒ¡ãƒ¢ï¼šDeep contextualized word representations</title><link href="http://localhost:4000/Note-ELMo/" rel="alternate" type="text/html" title="è«–æ–‡ãƒ¡ãƒ¢ï¼šDeep contextualized word representations" /><published>2019-04-06T00:00:00+09:00</published><updated>2019-04-06T00:00:00+09:00</updated><id>http://localhost:4000/Note-ELMo</id><content type="html" xml:base="http://localhost:4000/Note-ELMo/">&lt;h2 id=&quot;æ–‡çŒ®æƒ…å ±&quot;&gt;æ–‡çŒ®æƒ…å ±&lt;/h2&gt;
&lt;p&gt;è‘—è€…: M. Peters et al.&lt;br /&gt;
æ‰€å±: Allen Institute for Artificial Intelligence / Paul G. Allen School of Computer Science &amp;amp; Engineering, University of Washington&lt;br /&gt;
å‡ºå…¸: &lt;a href=&quot;https://aclweb.org/anthology/papers/N/N18/N18-1202/&quot;&gt;NAACL 2018&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ã©ã‚“ãªè«–æ–‡ã‹&quot;&gt;ã©ã‚“ãªè«–æ–‡ã‹ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ELMo = Embeddings from Language Modelsã®ç•¥ã§ã‚ã‚Šï¼Œè¨€èªãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã—ãŸæ–‡è„ˆã«å¿œã˜ãŸå˜èªåˆ†æ•£è¡¨ç¾: ELMoã‚’æå”±ã—ãŸè«–æ–‡ï¼&lt;/p&gt;

&lt;h2 id=&quot;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒå‡„ã„&quot;&gt;å…ˆè¡Œç ”ç©¶ã¨æ¯”ã¹ã¦ã©ã“ãŒå‡„ã„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æ—¢å­˜ã®NLPã‚¿ã‚¹ã‚¯ã®ãƒ¢ãƒ‡ãƒ«ã®åŸ‹ã‚è¾¼ã¿å±¤ã«ELMoã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ï¼Œæ§˜ã€…ãªã‚¿ã‚¹ã‚¯ã§å½“æ™‚ã®SoTAã‚’é”æˆã—ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“&quot;&gt;æŠ€è¡“ã‚„æ‰‹æ³•ã®ã‚­ãƒ¢ã¯ã©ã“ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã‚’æ´»ç”¨ã—ï¼Œéš ã‚Œå±¤ã®é‡ã¿ã‚’é‡ã¿ä»˜ãç·šå½¢å’Œã§åœ§ç¸®ã™ã‚‹ç‚¹ï¼&lt;br /&gt;
â†’ å¾“æ¥æ‰‹æ³•ã§ã¯ï¼Œå˜ã«åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã®å‡ºåŠ›å±¤ã ã‘ã‚’å–ã£ã¦ãã¦ã„ãŸï¼&lt;/p&gt;

&lt;h2 id=&quot;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸ&quot;&gt;ã©ã†ã‚„ã£ã¦æœ‰åŠ¹ã ã¨æ¤œè¨¼ã—ãŸï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;å„ç¨®NLPã‚¿ã‚¹ã‚¯ã«é©ç”¨ã—ã¦ï¼Œãã®ã‚¹ã‚³ã‚¢ã«ã‚ˆã‚Šè©•ä¾¡ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;è­°è«–ã¯ã‚ã‚‹&quot;&gt;è­°è«–ã¯ã‚ã‚‹ï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;ELMoã®ä¸­é–“å±¤ãŒæ‰ãˆã¦ã„ã‚‹ç‰¹å¾´ç´ ã«ã¤ã„ã¦&lt;br /&gt;
â†’ è‘—è€…ã‚‰ã«ã‚ˆã‚‹ã¨ï¼ŒELMoã®ä¸­é–“å±¤ã¯ä½å±¤ã§ã‚ã‚Œã°ã‚ã‚‹ã»ã©ï¼Œ&lt;strong&gt;æ–‡æ³•çš„(syntactic)&lt;/strong&gt;ãªæƒ…å ±ã‚’å«ã¿ï¼Œé«˜å±¤ã®æ–¹ãŒï¼Œ&lt;strong&gt;æ„å‘³çš„(semantic)&lt;/strong&gt;ãªæƒ…å ±ã‚’å«ã‚€ã¨ã®ã“ã¨ï¼&lt;br /&gt;
â†’ åŸºæœ¬çš„ã«ã©ã®ã‚¿ã‚¹ã‚¯ã‚‚syntacticãªæƒ…å ±ã‚’å¥½ã‚€å‚¾å‘ã«ã‚ã‚‹ã‚‰ã—ã„ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;è«–æ–‡ã®è©³ç´°ãƒ¡ãƒ¢&quot;&gt;è«–æ–‡ã®è©³ç´°ãƒ¡ãƒ¢&lt;/h2&gt;
&lt;h3 id=&quot;1-é †æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&quot;&gt;1. é †æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&lt;/h3&gt;
&lt;p&gt;ãƒˆãƒ¼ã‚¯ãƒ³æ•°: $N$ã®å˜èªåˆ—: $(t_1, t_2, \dots, t_N)$ãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãï¼Œé †æ–¹å‘ã®è¨€èªãƒ¢ãƒ‡ãƒ«ã¯ï¼Œå˜èª: $t_k$ã¨å˜èªåˆ—: $(t_1, \dots, t_{k-1})$ã®æ¡ä»¶ä»˜ãç¢ºç‡ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ï¼Œæ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹.é †æ–¹å‘ã®è¨€èªãƒ¢ãƒ‡ãƒ«ã§ã¯ï¼Œæ¬¡ã®å˜èª: $t_{k+1}$ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$p(t_1, t_2, ..., t_N) = \prod_{k=1}^N p(t_k | t_1, t_2, \dots, t_{k-1})$$
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;æœ€è¿‘ã®è¨€èªãƒ¢ãƒ‡ãƒ«ã§ã¯ï¼Œæ–‡è„ˆéä¾å­˜ãªå˜èªè¡¨ç¾: $\mathbf{x}_k^{LM}$ã‚’å˜èªåŸ‹ã‚è¾¼ã¿ã‚„character-based CNNã«ã‚ˆã‚Šç®—å‡ºã—ã¦ã‹ã‚‰ï¼ŒLå±¤ã®LSTMã«å…¥åŠ›ã™ã‚‹ã“ã¨ãŒå¤šã„ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;å˜èªåˆ—ã®ä½ç½®: $k$ã«ãŠã„ã¦ï¼Œå„LSTMå±¤ã¯ï¼Œæ–‡è„ˆä¾å­˜ãªå˜èªè¡¨ç¾: $\overrightarrow{\mathbf{h}}_{k, j}^{LM}$ï¼ˆãŸã ã—ï¼Œ$1 \leq j \leq L$ï¼‰ã‚’å‡ºåŠ›ã™ã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;script type=&quot;math/tex&quot;&gt;\overrightarrow{\mathbf{h}}_{k, L}^{LM}&lt;/script&gt;ã¯ï¼Œæ¬¡ã®å˜èª: $t_{k+1}$ã‚’softmaxå±¤ã§äºˆæ¸¬ã™ã‚‹ã®ã«ç”¨ã„ã‚‰ã‚Œã‚‹ï¼&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;2-é€†æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&quot;&gt;2. é€†æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&lt;/h3&gt;
&lt;p&gt;é€†æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã¯é †æ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã¨é¡ä¼¼ã—ã¦ã„ã‚‹ãŒï¼Œå˜èªåˆ—ã‚’é€†ã«å‡¦ç†ã—ã¦ã„ãç‚¹ã§ç•°ãªã‚‹ï¼ãªãŠï¼Œé€†æ–¹å‘ã®è¨€èªãƒ¢ãƒ‡ãƒ«ã§ã¯ï¼Œæœªæ¥ã®å˜èªåˆ—ã‹ã‚‰ä¸€ã¤å‰ã®å˜èª: $t_{k-1}$ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ï¼ã¤ã¾ã‚Šï¼Œé€†æ–¹å‘ã®è¨€èªãƒ¢ãƒ‡ãƒ«ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ï¼&lt;/p&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$p(t_1, t_2, ..., t_N) = \prod_{k=1}^N p(t_k | t_{k+1}, t_{k+2}, \dots, t_N)$$
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;æœ€çµ‚çš„ã«ã¯ï¼Œ&lt;script type=&quot;math/tex&quot;&gt;\overleftarrow{\mathbf{h}}_{k, L}^{LM}&lt;/script&gt; ã‚’æ±‚ã‚ã‚‹ã“ã¨ã§ï¼Œ$t_{k-1}$ ã‚’softmaxå±¤ã§äºˆæ¸¬ã™ã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;3-åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&quot;&gt;3. åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;é€šå¸¸è¨€èªãƒ¢ãƒ‡ãƒ«ã¯å¯¾æ•°å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã§æœ€é©åŒ–ã‚’è¡Œã†ï¼&lt;br /&gt;
â†’ æ–‡è„ˆä¸­ã§å‡ºç¾ã—ã¦ã»ã—ã„å˜èªã®ç¢ºç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹ãŸã‚ï¼&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ELMoã§ä½¿ã‚ã‚Œã‚‹åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã¯æ¬¡ã®å¼ã®å¯¾æ•°å°¤åº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ã§å­¦ç¿’ã™ã‚‹ï¼&lt;br /&gt;
â†’ æ–‡è„ˆéä¾å­˜ãªå˜èªè¡¨ç¾ã¨ã‚½ãƒ•ãƒˆãƒãƒƒã‚¯ã‚¹å±¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: $\Theta_{x}, \Theta_s$ã¯å…±æœ‰ï¼LSTMã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã®ã¿ç‹¬ç«‹ï¼&lt;br /&gt;
â†’ å¾“æ¥æ‰‹æ³•ã§ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã™ã¹ã¦ç‹¬ç«‹&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\sum_{k=1}^{N}(\log p(t_k | t_1, t_2, \dots, t_{k-1}; \Theta_x, \overrightarrow{\Theta}_{LSTM}, \Theta_s) \\+ \log p(t_k | t_{k+1}, t_{k+2}, \dots, t_N; \Theta_x, \overleftarrow{\Theta}_{LSTM}, \Theta_s))
$$
&lt;/div&gt;

&lt;h3 id=&quot;4-elmoã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®—å‡º&quot;&gt;4. ELMoã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®—å‡º&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;å…¨ã¦ã®ãƒˆãƒ¼ã‚¯ãƒ³: $t_k$ã¯Lå±¤ã®åŒæ–¹å‘è¨€èªãƒ¢ãƒ‡ãƒ«ã«å¯¾ã—ï¼Œ2L+1å€‹ã®ç‰¹å¾´é‡ã‚’æŒã¤ï¼&lt;br /&gt;
â†’ æ–‡è„ˆä¾å­˜ã—ãªã„å˜èªãƒ™ã‚¯ãƒˆãƒ«: 1å€‹&lt;br /&gt;
â†’ æ–‡è„ˆä¾å­˜ã®ã™ã‚‹é †æ–¹å‘ã¨é€†æ–¹å‘ã®LSTM: 2Lå€‹&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\begin{equation*}
\begin{split}
R_k &amp;amp;= \{x_k^{LM}, \overrightarrow{\mathbf{h}}_{k, j}^{LM}, \overleftarrow{\mathbf{h}}_{k, j}^{LM} | j = 1, \dots, L \}\\
    &amp;amp;= \{\mathbf{h}_{k, j}^{LM} | j=0, \dots, L \}
\end{split}
\end{equation*}
$$
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ELMoã‚’ä»–ã®ã‚¿ã‚¹ã‚¯ã«å¿œç”¨ã™ã‚‹ã«ã¯ï¼ŒRã®ã™ã¹ã¦ã®è¦ç´ ã‚’ä¸€ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«è¡¨ç¾ã«å¤‰æ›ã™ã‚‹ï¼&lt;br /&gt;
â†’ ç°¡å˜ãªä¾‹ã ã¨ï¼Œä¸€ç•ªä¸Šã®å±¤ã ã‘ã‚’å–ã£ã¦ãã‚‹ã‚‚ã®ãŒã‚ã‚‹ï¼CoVeã‚„TagLMã¯ã“ã‚Œã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\mathbf{ELMo}_k^{task} = E(R_k; \Theta_e) = \mathbf{h}_{k, L}^{LM}
$$
&lt;/div&gt;

&lt;div style=&quot;text-align: center&quot;&gt;ãŸã ã—ï¼Œ$\mathbf{h}_{k, L}^{LM} = \left[\overrightarrow{\mathbf{h}}_{k, j}^{LM}; \overleftarrow{\mathbf{h}}_{k, j}^{LM}\right]$&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ELMoã§ã¯ã‚ˆã‚Šä¾¿å®œã‚’ã¯ã‹ã‚Šï¼Œé‡ã¿ä»˜ãç·šå½¢å’Œã®å½¢ã§å¤‰æ›ã™ã‚‹ï¼&lt;br /&gt;
â†’ $s_j^{task}$ã¯softmaxã§æ­£è¦åŒ–ã•ã‚ŒãŸé‡ã¿&lt;br /&gt;
â†’ $\gamma^{task}$ã¯ELMoã®ãƒ™ã‚¯ãƒˆãƒ«å…¨ä½“ã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ï¼ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®æœ€é©åŒ–ã®è¦³ç‚¹ã‹ã‚‰å¿…è¦ï¼&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;mathjax-scroll&quot;&gt;
$$
\mathbf{ELMo}_k^{task} = \gamma^{task} \sum_{j=0}^L s_j^{task}\mathbf{h}_{k, j}^{LM}
$$
&lt;/div&gt;

&lt;h3 id=&quot;5-elmoãƒ¢ãƒ‡ãƒ«ã®nlpã‚¿ã‚¹ã‚¯ã¸ã®é©ç”¨&quot;&gt;5. ELMoãƒ¢ãƒ‡ãƒ«ã®NLPã‚¿ã‚¹ã‚¯ã¸ã®é©ç”¨&lt;/h3&gt;
&lt;p&gt;å˜ã«$\mathbf{ELMo}_k^{task}$ã‚’å…¥åŠ›ã®åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ã¨concatã™ã‚Œã°è‰¯ã„ï¼&lt;/p&gt;

&lt;h2 id=&quot;ã¾ã¨ã‚ã‚¹ãƒ©ã‚¤ãƒ‰&quot;&gt;ã¾ã¨ã‚ã‚¹ãƒ©ã‚¤ãƒ‰&lt;/h2&gt;
&lt;div style=&quot;text-align: center&quot;&gt;&lt;iframe src=&quot;//www.slideshare.net/slideshow/embed_code/key/hvw0gfJhsc8aWL&quot; width=&quot;510&quot; height=&quot;420&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; style=&quot;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&quot; allowfullscreen=&quot;&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;
&lt;div style=&quot;margin-bottom:5px&quot;&gt;&lt;/div&gt;

&lt;h2 id=&quot;å®Ÿè£…&quot;&gt;å®Ÿè£…&lt;/h2&gt;
&lt;p&gt;è©¦ã—ã«Kerasã§ELMo + BiLSTMã‚’ä½¿ã£ã¦IMDBã®åˆ†é¡ã‚’è¡Œã£ãŸã®ã§ï¼ŒGitHubã«ã‚ã’ã¾ã—ãŸï¼&lt;br /&gt;
â†’ &lt;a href=&quot;https://github.com/gucci-j/elmo-imdb&quot;&gt;GitHub-ELMo&lt;/a&gt;&lt;/p&gt;</content><author><name></name></author><category term="è«–æ–‡ãƒ¡ãƒ¢" /><summary type="html">æ–‡çŒ®æƒ…å ± è‘—è€…: M. Peters et al. æ‰€å±: Allen Institute for Artificial Intelligence / Paul G. Allen School of Computer Science &amp;amp; Engineering, University of Washington å‡ºå…¸: NAACL 2018</summary></entry></feed>